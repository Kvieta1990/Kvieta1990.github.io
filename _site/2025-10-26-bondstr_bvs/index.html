<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
<link rel="manifest" href="/assets/img/site.webmanifest">
<link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Bond Valence Energy Landscape Calculation with the BondStr Program in Fullprof Suite</title>

  
  <meta name="author" content="Yuanpeng Zhang">
  

  <meta name="description" content="Understanding ion diffusion is essential in battery materials research and characterizing diffusion pathways is critical for rational materials design and optimization. While using the diffraction technique for the characterization of battery materials, we could obtain the refined structure configuration via fitting the diffraction data, with the small-box or big-box approach,...">

  

  

  <link rel="alternate" type="application/rss+xml" title="Yuanpeng's Blog" href="http://localhost:4000/feed.xml">

  

  

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-44PBCNZ80G"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-44PBCNZ80G');
</script>

  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Yuanpeng's Blog">
  <meta property="og:title" content="Bond Valence Energy Landscape Calculation with the BondStr Program in Fullprof Suite">
  <meta property="og:description" content="Understanding ion diffusion is essential in battery materials research and characterizing diffusion pathways is critical for rational materials design and optimization. While using the diffraction technique for the characterization of battery materials, we could obtain the refined structure configuration via fitting the diffraction data, with the small-box or big-box approach,...">

  
  <meta property="og:image" content="http://localhost:4000/assets/img/mountain.png">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Yuanpeng Zhang">
  <meta property="og:article:published_time" content="2025-10-26T00:00:00-05:00">
  <meta property="og:url" content="http://localhost:4000/2025-10-26-bondstr_bvs/">
  <link rel="canonical" href="http://localhost:4000/2025-10-26-bondstr_bvs/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="Bond Valence Energy Landscape Calculation with the BondStr Program in Fullprof Suite">
  <meta property="twitter:description" content="Understanding ion diffusion is essential in battery materials research and characterizing diffusion pathways is critical for rational materials design and optimization. While using the diffraction technique for the characterization of battery materials, we could obtain the refined structure configuration via fitting the diffraction data, with the small-box or big-box approach,...">

  
  <meta name="twitter:image" content="http://localhost:4000/assets/img/mountain.png">
  

  


  

  

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script async='async' src='https://www.gstatic.com/external_hosted/clipboardjs/clipboard.min.js'></script>
<script src='https://unpkg.com/sweetalert@2.1.2/dist/sweetalert.min.js'></script>
<script language='JavaScript'>
  function copytoclipboard(containerid){
    if (document.selection) {
      var range = document.body.createTextRange();
      range.moveToElementText(document.getElementById(containerid));
      range.select().createTextRange();
      document.execCommand("copy");
    } else if (window.getSelection) {
      var range = document.createRange();
      range.selectNode(document.getElementById(containerid));
      var selection = window.getSelection() // get Selection object from currently user selected text
      selection.removeAllRanges() // unselect any user selected text (if any)
      selection.addRange(range) // add range to Selection object to select it
      document.execCommand("copy");
      //alert("Codes snippet copied to clipboard!")
      swal({
      title: "",
      text: "Codes snippet copied to clipboard!",
      icon: "success",
      });
    }
  }
</script>
<script defer src="https://umm.iris-home.net/script.js" data-website-id="f40cd621-831a-49d1-b675-c998d596eb96"></script>
</head>


<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand navbar-brand-logo" href="http://localhost:4000/"><img alt="Yuanpeng's Blog Logo" src="/assets/img/home.png"/></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
              <a class="nav-link" href="/search">üîçSearch</a></li>
          <li class="nav-item">
              <a class="nav-link" href="/about">About</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Posts</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/all_posts">All posts</a>
                    <a class="dropdown-item" href="/archive">Archive</a>
                    <a class="dropdown-item" href="/tags">Tags</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Academic</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/nav_pages/publications">Publications</a>
                    <a class="dropdown-item" href="/nav_pages/lnotes">Learning Notes</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More Links</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown"><a target="_blank" class="dropdown-item" href="https://www.ornl.gov/staff-profile/yuanpeng-zhang">ORNL Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://me.iris-home.net">My Homepage</a>
								  <a target="_blank" class="dropdown-item" href="https://scholar.google.com/citations?user=NgqIgO0AAAAJ&hl=en">Google Scholar</a>
								  <a target="_blank" class="dropdown-item" href="https://orcid.org/0000-0003-4224-3361">ORCID</a>
								  <a target="_blank" class="dropdown-item" href="https://rmcprofile.ornl.gov/">RMCProfile</a>
								  <a target="_blank" class="dropdown-item" href="https://dh.iris-home.net">My Dashboard</a>
								  
                    <a class="dropdown-item" href="https://page.iris-2020.net">My Collection</a><a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990">GitHub Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Kvieta1990.github.io">Blog Repo</a>
								  <a target="_blank" class="dropdown-item" href="https://mybinder.org/v2/gh/Kvieta1990/Jup_Notes/master">Jupyter Binder</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Iris">More Notes</a>
								  
            </div>
          </li>
        
          <li class="nav-item">
              <a class="nav-link" href="/updates">Updates</a></li>
          <li class="nav-item"><a target="_blank" class="nav-link" href="https://flarum.iris-home.net">Forum</a>
					  </li>
          <li class="nav-item">
              <a class="nav-link" href="/contact">Contact</a></li></ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border" id="others">
      </div>
    </div>
    <div class="avatar-container">
      <div class="avatar-img-border">
					<div class="avatar-adjust" id="safari">
				  </div>
      </div>
    </div>
  

<script>
function myFunction() {
		return '<a href="http://localhost:4000/"><img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/mountain.png" />';
}
let safariAgent = navigator.userAgent.indexOf("Safari") > -1;
let chromeAgent = navigator.userAgent.indexOf("Chrome") > -1;
if (chromeAgent) {
  document.getElementById("others").innerHTML = myFunction();
} else if (safariAgent) {
  document.getElementById("safari").innerHTML = myFunction();
} else {
  document.getElementById("others").innerHTML = myFunction();
}

</script>

</nav>


  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">
<script defer src="https://umm.iris-home.net/script.js" data-website-id="f40cd621-831a-49d1-b675-c998d596eb96"></script>

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-10 offset-xl-1 col-lg-12 offset-lg-1">
        <div class="post-heading">
						<h1>Bond Valence Energy Landscape Calculation with the BondStr Program in Fullprof Suite</h1>
          

          
					<span class="post-meta">Posted on October 26, 2025, by Yuanpeng Zhang</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-10 offset-xl-1 col-lg-12 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <p align="center">
<img src="/assets/img/posts/fullprof.svg" style="border:none;" width="300" alt="fullprof" title="fullprof" />
</p>

<p>Understanding ion diffusion is essential in battery materials research and characterizing diffusion pathways is critical for rational materials design and optimization. While using the diffraction technique for the characterization of battery materials, we could obtain the refined structure configuration via fitting the diffraction data, with the <code class="language-plaintext highlighter-rouge">small-box</code> or <code class="language-plaintext highlighter-rouge">big-box</code> approach, focusing on <code class="language-plaintext highlighter-rouge">local structure</code> or <code class="language-plaintext highlighter-rouge">average structure</code>. Accordingly, the ion diffusion behavior analysis could be conducted to yield the critical information about the ion diffusion pathway, based on experimental data, in contract to the similar information obtained via, e.g., molecular dynamics simulation.</p>

<p>Regarding the construction of the ion diffusion pathway from a structure configuration, a typical approach is based on the bond valence (BV) method. Details about the theory and formulation can be found in Refs. [1, 2]. In short, the backbone of the methodology can be summarized as follows,</p>

<ul>
  <li>
    <p>The actual contribution to the valence of a central atom from a surrounding atom depends on the distance between them.</p>
  </li>
  <li>
    <p>The overall valence of a central atom is the sum of contributions from all surrounding atoms, and in practice, a cutoff needs to be set to define the <code class="language-plaintext highlighter-rouge">surrounding</code> atoms.</p>
  </li>
  <li>
    <p>Positions of ions are allow to vary in reality and the diffusion pathway can be considered as the connection of those points yielding the same bond valence for ions.</p>
  </li>
  <li>
    <p>Such an idea can be expanded to define an energy term that considers both the BV-determined energy and a Coulomb interaction term.</p>
  </li>
  <li>
    <p>The ion diffusion pathway is then just the isosurface corresponding to a pre-defined energy value.</p>
  </li>
</ul>

<p>Such a theoretical framework based on the BV method for ion diffusion pathway construction is implemented in the <code class="language-plaintext highlighter-rouge">BondStr</code> program in the <code class="language-plaintext highlighter-rouge">Fullprof Suite</code> [3, 4]. Using the program is straightforward, but still there are some technical details to pay attention to get it working. First, we need to install the <code class="language-plaintext highlighter-rouge">Fullprof Suite</code>, which can be downloaded from their website [6]. The program is available on all Windows, Linux and MacOS ‚Äì I am only using its Windows version and am not sure how robust it is working on Linux or MacOS. Once installed and launched, we should see the following interface of the program,</p>

<p align="center">
<img src="/assets/img/posts/fullprof_bondstr.png" style="border:none;" width="1200" alt="fullprof_bondstr" title="fullprof_bondstr" />
</p>

<p>Regarding the purpose here, we want to click on the button as indicated by the red arrow shown in the picture to launch the <code class="language-plaintext highlighter-rouge">Bond_Str</code> GUI interface. This will bring up the following interface,</p>

<p align="center">
<img src="/assets/img/posts/fullprof_bondstr_gui.png" style="border:none;" width="800" alt="fullprof_bondstr_gui" title="fullprof_bondstr_gui" />
</p>

<p>To use the program, there may be multiple workflow and here I am only putting down the one that I believe should be most common one. To start, we need a CIF file for the structure we want to analyze, and here I am using the example used in Ref. [4] and the CIF file can be downloaded <a href="../assets/files/LiFePO4.cif">here</a> [5]. In the GUI, we go to <code class="language-plaintext highlighter-rouge">File</code> \(\Rightarrow\) <code class="language-plaintext highlighter-rouge">Import CIF</code>, and select the CIF we want to analyze. With the example CIF file here, the interface will now look like,</p>

<p align="center">
<img src="/assets/img/posts/fullprof_bondstr_gui_loaded.png" style="border:none;" width="800" alt="fullprof_bondstr_gui_loaded" title="fullprof_bondstr_gui_loaded" />
</p>

<p>Looking at the atom lines in the red rectangle, we can see that the loaded atom lines are not following the expected format as given by the example atom string. Here we can manually edit those atom lines to make it look like the following,</p>

<p align="center">
<img src="/assets/img/posts/fullprof_bondstr_gui_corrected.png" style="border:none;" width="800" alt="fullprof_bondstr_gui_corrected" title="fullprof_bondstr_gui_corrected" />
</p>

<p>where we change the <code class="language-plaintext highlighter-rouge">Spec.</code> part in each atom line to something like <code class="language-plaintext highlighter-rouge">Li+1</code>, <code class="language-plaintext highlighter-rouge">FE+2</code>, <code class="language-plaintext highlighter-rouge">P+5</code> and <code class="language-plaintext highlighter-rouge">O-2</code> to specify the ideal charge for each element type. Without any further changes, we can click on <code class="language-plaintext highlighter-rouge">Run</code> in the menu to start the bond valence calculation, in which case we will not calculate the isosurface regarding the ion diffusion pathway. Instead, the bond valence sum (BVS) for each atomic site (Wyckoff position) will be calculated and results can be found in the output <code class="language-plaintext highlighter-rouge">.bvs</code> file under the <code class="language-plaintext highlighter-rouge">Working Directory</code> (see the GUI for the specification of the <code class="language-plaintext highlighter-rouge">Working Directory</code>).</p>

<blockquote>
  <p>Here, it should be noticed that in the GUI, we have the <code class="language-plaintext highlighter-rouge">Code of files:</code> entry which determines the stem name of output files. For example, if we follow the procedures above to calculate the BVS for the example CIF file provided, the <code class="language-plaintext highlighter-rouge">Code of files:</code> entry would be <code class="language-plaintext highlighter-rouge">LiFePO4_cfl</code> and accordingly the BVS output file would be <code class="language-plaintext highlighter-rouge">LiFePO4_cfl_sum.bvs</code> under the <code class="language-plaintext highlighter-rouge">Working Directory</code>.</p>
</blockquote>

<p>Next, to calculate the bond valence energy landscape (BVEL) map (see the #5 bullet point above), we want to put in some parameters in the <code class="language-plaintext highlighter-rouge">Number of Division along x,y,z,...</code> input box and click on the <code class="language-plaintext highlighter-rouge">BV-Energy-Landscape Map</code> option. The input box could be given a string like below,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>103 60 47 Li+1 8.0 3
</code></pre></div></div>

<p>where the first three numbers specify the number of grid points along the x, y and z direction ‚Äì in fact, I think it actually means the crystallographic a, b and c direction. The next part <code class="language-plaintext highlighter-rouge">Li+1</code> specifies the atomic species to calculate and for Li-ion batteries, for sure the Li ions diffusion is what we care about. The next part <code class="language-plaintext highlighter-rouge">8.0</code> specifies the distance cutoff for considering surrounding atoms as <code class="language-plaintext highlighter-rouge">neighbors</code>. The last part <code class="language-plaintext highlighter-rouge">3</code> specifies the delta value for the energy such that the grid volume yielding an energy value smaller than <code class="language-plaintext highlighter-rouge">Emin + delta</code> will be considered as the <code class="language-plaintext highlighter-rouge">mobile volume</code>, i.e., the fractional volume that can be potentially considered as being able to contribute to the ion diffusion. Given a certain delta value, for sure, the bigger the fractional volume is, the better the expected ion diffusion will be.</p>

<blockquote>
  <p>The calculated fractional volume will be presented in the output window to be presented once the calculation is finished.</p>
</blockquote>

<blockquote>
  <p>When the calculation is started, a terminal console will be brought up and once the calculation is finished, we can press the <code class="language-plaintext highlighter-rouge">[Enter]</code> key to kill the terminal and the output window will be brought up automatically. To continue the program running, we need to close the output window.</p>
</blockquote>

<blockquote>
  <p>The fraction volume mentioned here can be found in the output window following <code class="language-plaintext highlighter-rouge">Volume  fraction for ion mobility in the unit cell:</code></p>
</blockquote>

<p>Last, we may want to check <code class="language-plaintext highlighter-rouge">Percolation</code> box and input a value in the <code class="language-plaintext highlighter-rouge">Max. Energy</code> input box. The value here is also a delta value of energy. In this case, grid points yielding the energy lower than <code class="language-plaintext highlighter-rouge">Emin + delta</code> will be considered for establishing the percolation network of diffusion ions. For sure, a larger <code class="language-plaintext highlighter-rouge">Max. Energy</code> value would require longer computation time.</p>

<blockquote>
  <p>Here, <code class="language-plaintext highlighter-rouge">Emin</code> mentioned in the context refers to the ground state energy.</p>
</blockquote>

<p>A series of output will be generated along with the calculation and the most interesting output that we may want to check out is probably the <code class="language-plaintext highlighter-rouge">.vesta</code> file with which we can visualize the energy isosurface using <code class="language-plaintext highlighter-rouge">VESTA</code>. Opening the generated <code class="language-plaintext highlighter-rouge">.vesta</code> file in <code class="language-plaintext highlighter-rouge">VESTA</code>, we should be able to see the energy isosurface like shown below,</p>

<p align="center">
<img src="/assets/img/posts/bvel_isosurface.jpg" style="border:none;" width="800" alt="bvel_isosurface" title="bvel_isosurface" />
</p>

<p>In fact, while loading the <code class="language-plaintext highlighter-rouge">.vesta</code> file into <code class="language-plaintext highlighter-rouge">VESTA</code>, by default we won‚Äôt see the isosurface as presented above. We need to make some changes to the isosurface parameters in <code class="language-plaintext highlighter-rouge">VESTA</code>. In the menu, we go to <code class="language-plaintext highlighter-rouge">Objects</code> \(\Rightarrow\) <code class="language-plaintext highlighter-rouge">Properties</code> \(\Rightarrow\) <code class="language-plaintext highlighter-rouge">isosurfaces...</code> to bring up the window as shown below,</p>

<p align="center">
<img src="/assets/img/posts/vesta_isosurface_setup.png" style="border:none;" width="800" alt="vesta_isosurface_setup" title="vesta_isosurface_setup" />
</p>

<p>Highlighting the part shown in the red rectangle, we can change the parameters for both the dropdown selection (<code class="language-plaintext highlighter-rouge">Positive</code> as shown in the picture) and the <code class="language-plaintext highlighter-rouge">Isosurface level</code> (<code class="language-plaintext highlighter-rouge">-1</code>, and the unit should be <code class="language-plaintext highlighter-rouge">eV</code>). The displayed isosurface is then the one corresponding to the percolation energy of <code class="language-plaintext highlighter-rouge">-1 eV</code>.</p>

<p>A demonstration video covering the basic procedures discussed in current post can be found below (click on the image to go to the YouTube video),</p>

<div align="center">
  <p><a href="https://www.youtube.com/watch?v=SfQpLev9at0" target="_blank">
    <img src="https://img.youtube.com/vi/SfQpLev9at0/maxresdefault.jpg" alt="Demo video for using Bond_Str" width="800" />
  </a></p>
</div>

<p>As a technical note, here I also want to put down the problem and solution that I recently found with the <code class="language-plaintext highlighter-rouge">VESTA</code> program. With the most recent Windows 11 system, <code class="language-plaintext highlighter-rouge">VESTA</code> would not launch normally ‚Äì sometimes I had to launch the program multiple times before it can load in the CIF file or open the <code class="language-plaintext highlighter-rouge">.vesta</code> file without crashing. Not sure exactly from which version of Windows did the problem start to show up, but at least my current version of Windows 11 (Windows 11 Pro, Version 25H2, OS build 2600.6901) does show the issue with <code class="language-plaintext highlighter-rouge">VESTA</code>. In case the problem does happen, we can press <code class="language-plaintext highlighter-rouge">[Enter]</code> to bring up the start menu, search for <code class="language-plaintext highlighter-rouge">vesta</code> and right click on the icon to further click on <code class="language-plaintext highlighter-rouge">Open file location</code>. Then we should see the <code class="language-plaintext highlighter-rouge">VESTA</code> shortcut in the appearing folder. Right click on the shortcut, click on <code class="language-plaintext highlighter-rouge">Show more options</code> and then click on <code class="language-plaintext highlighter-rouge">Properties</code>. Then go to the <code class="language-plaintext highlighter-rouge">Compatibility</code> tab and check <code class="language-plaintext highlighter-rouge">Run this program in Compatibility mode for:</code>. In the dropdown selection, we can choose <code class="language-plaintext highlighter-rouge">Windows 8</code> (see the image below). This does solve the <code class="language-plaintext highlighter-rouge">VESTA</code> crashing issue for me.</p>

<p align="center">
<img src="/assets/img/posts/vesta_compatibility.png" style="border:none;" width="500" alt="vesta_compatibility" title="vesta_compatibility" />
</p>

<hr />

<p align="center">
Updates @ 11/03/2025 22:50:37 EST
</p>

<hr />

<p>The <code class="language-plaintext highlighter-rouge">Bond_Str</code> GUI sometimes would fail to handle CIF files. Even though, it is still hopeful that the backend executable can be used for the calculation. It is just that we need some more manual configurations. Initially, we can still try to import a CIF file following the instruction above. Ignoring whatever error message popping up, we can then go to the saving directory of the imported CIF file and there we will find a <code class="language-plaintext highlighter-rouge">.cfl</code> file with the same stem name as the import CIF file being generated in the same directory. Some of the contents in the generated <code class="language-plaintext highlighter-rouge">.cfl</code> file may be problematic blocking the BVS calculation. However, the atom lines can still be used. Next, we want to go back to the <code class="language-plaintext highlighter-rouge">Bond_Str</code> GUI, import a working CIF (e.g., the example CIF given above), follow the instructions above to make changes to atom labels, fill in necessary calculation parameters, perform the calculation, and then check out the accordingly generated <code class="language-plaintext highlighter-rouge">.cfl</code> file. Here, we want to save the working <code class="language-plaintext highlighter-rouge">.cfl</code> file to another file (to be used for our own sample configuration), go back to the previouly generated problematic <code class="language-plaintext highlighter-rouge">.cfl</code> file, copy the atom lines into the just saved new <code class="language-plaintext highlighter-rouge">.cfl</code> file to replace those atom lines originating from the working CIF. Then we also need to update the title, cell parameters, space group and those <code class="language-plaintext highlighter-rouge">BVEL</code> parameters to be consistent with our sample configuration. This way, we just manually make a working version of <code class="language-plaintext highlighter-rouge">.cfl</code> file which can be run with the <code class="language-plaintext highlighter-rouge">bond_str</code> executable from the command line. On Windows, if we right click on the <code class="language-plaintext highlighter-rouge">FullProf_Suite</code> shortcut from the start menu and trace all the way to the installation directory of the program by selecting <code class="language-plaintext highlighter-rouge">Open file location</code>, we should be able to find the <code class="language-plaintext highlighter-rouge">bond_str</code> executable. Not sure about MacOS or Linux but I guess it should not be super difficult to find the executable somewhere in the <code class="language-plaintext highlighter-rouge">FullProf_Suite</code> installation directory, e.g., on MacOS, if we choose to <code class="language-plaintext highlighter-rouge">Show Contents</code> by right clicking on the <code class="language-plaintext highlighter-rouge">FullProf_Suite</code> app inside the <code class="language-plaintext highlighter-rouge">/Applications</code> directory, we can launch the terminal app there in the directory and use the <code class="language-plaintext highlighter-rouge">find</code> command to look for <code class="language-plaintext highlighter-rouge">bond_str</code>, like <code class="language-plaintext highlighter-rouge">find . -name 'bond_str'</code>. Once we have the <code class="language-plaintext highlighter-rouge">bond_str</code> executable located, it can be executed from the terminal like,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/path/to/bond_str &lt;name&gt;.cfl
</code></pre></div></div>

<p>where <code class="language-plaintext highlighter-rouge">&lt;name&gt;.cfl</code> refers to the previously hand-crafted <code class="language-plaintext highlighter-rouge">.cfl</code> file. In fact, before running the program, for sure we need to manually add in charges of elements by editing the <code class="language-plaintext highlighter-rouge">Species</code> column in those atom lines (usually it is the 3rd column) to make it something like <code class="language-plaintext highlighter-rouge">Li+1</code>, <code class="language-plaintext highlighter-rouge">Fe+2</code>, <code class="language-plaintext highlighter-rouge">O-2</code>, etc.</p>

<p>Sometimes, we would still have issues with the calculation due to, e.g., potential parameters not defined in the database. For example, the <code class="language-plaintext highlighter-rouge">Fe+2-N-3</code> pair potential is not defined, in which case we need to manually put in the parameters for those missing parameters for certain pairs. The potential parameter line should be like this,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>BVELPAR FE+2 N-3 6 1.76 5 4.4621 1.96 1.59
</code></pre></div></div>

<p>The parameters come in the following order,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cation Anion CN R0 Cutoff D0 Rmin Alpha
</code></pre></div></div>

<p>where the <code class="language-plaintext highlighter-rouge">CN</code> (for coordination number) and <code class="language-plaintext highlighter-rouge">Cutoff</code> parameters are not used for the potential calculation ‚Äì they should still be provided for maintaining the format of the information provided in the output file [3]. The <code class="language-plaintext highlighter-rouge">R0</code> parameter is just the <code class="language-plaintext highlighter-rouge">R0</code> parameter in the BVS calculation [7]. The <code class="language-plaintext highlighter-rouge">D0</code>, <code class="language-plaintext highlighter-rouge">Rmin</code> and <code class="language-plaintext highlighter-rouge">Alpha</code> parameters are those in the Morse potential given in the following form,</p>

\[E = D_0 \big[[e^{Alpha \cdot (R_{min} - d)} - 1]^2 - 1\big]\]

<p><strong><em>N.B.</em></strong> We need to find the Morse potential parameters for a specific atom pair from the literature pool. Also, we need to pay attention to the unit of those parameters ‚Äì <code class="language-plaintext highlighter-rouge">bond_str</code> is expecting <code class="language-plaintext highlighter-rouge">D0</code> with the unit of <code class="language-plaintext highlighter-rouge">eV</code>, \(√Ö^{-1}\) for <code class="language-plaintext highlighter-rouge">Alpha</code>, and <code class="language-plaintext highlighter-rouge">√Ö</code> for <code class="language-plaintext highlighter-rouge">Rmin</code>. It should be noted that sometimes in the literature, the <code class="language-plaintext highlighter-rouge">D0</code> parameter would be given in the unit of <code class="language-plaintext highlighter-rouge">kcal/mol</code> ‚Äì refer to Ref. [8] for the conversion between energy units.</p>

<p>As the last step (hopefully), we also need to include potential parameters for those atom pairs of which the parameters already exist in the database (hard coded into the program) ‚Äì the thing is, it seems that the program is expect the manual input for all pairs once the <code class="language-plaintext highlighter-rouge">BVELPAR</code> line is given in the <code class="language-plaintext highlighter-rouge">.cfl</code> file. Here comes a little trick ‚Äì in the hand-crafted <code class="language-plaintext highlighter-rouge">.cfl</code> file, we can remove all those atoms involved in the pair for which the potential parameters are not defined, save the <code class="language-plaintext highlighter-rouge">.cfl</code> to a temporary version and run <code class="language-plaintext highlighter-rouge">bond_str</code> with the temporary <code class="language-plaintext highlighter-rouge">.cfl</code> file. Once the calculation is done, we will be brought up with an output window from which we can find the potential parameters for atom pairs, like shown below,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...

Bond-Valence Energy parameters (D0,Rmin,alpha) for Morse Potential:  D0*[{exp(alpha(Rmin-d))-1}^2-1]
   (data read from internal table, provided by the user or calculated from softBVS parameters)

 Morse parameters obtained from internal table

   Type  1: FE+2 with type  4: O-2 
    D0  =  1.69269       Rmin =  1.96005  Alpha =  2.08333
  Av. Coord.=  5.74300    R0  =  1.57911   R-cutoff =  5.50000   =&gt; Reference: S. Adams and R. Prasada Rao, (2011) Phys. Status Solidi A 208, No. 8, 1746-1753
   Cation (Eff. radius): FE+2( 1.260)      Anion  (Eff. radius): O-2 ( 1.330)

   Type  2: LI+1 with type  4: O-2 
    D0  =  0.98816       Rmin =  1.94001  Alpha =  1.93798
  Av. Coord.=  5.02100    R0  =  1.17096   R-cutoff =  5.50000   =&gt; Reference: S. Adams and R. Prasada Rao, (2011) Phys. Status Solidi A 208, No. 8, 1746-1753
   Cation (Eff. radius): LI+1( 1.310)      Anion  (Eff. radius): O-2 ( 1.330)

   Type  3: P+5  with type  4: O-2 
    D0  =  3.89635       Rmin =  1.44066  Alpha =  2.28833
  Av. Coord.=  4.00000    R0  =  1.62038   R-cutoff =  5.00000   =&gt; Reference: S. Adams and R. Prasada Rao, (2011) Phys. Status Solidi A 208, No. 8, 1746-1753
   Cation (Eff. radius): P+5 ( 1.100)      Anion  (Eff. radius): O-2 ( 1.330)

...
</code></pre></div></div>

<p>Grabbing the potential parameters from the output, we can then put in the <code class="language-plaintext highlighter-rouge">BVELPAR</code> line for all atom pairs. Then, <code class="language-plaintext highlighter-rouge">bond_str</code> should be able to run with the hand-crafted <code class="language-plaintext highlighter-rouge">.cfl</code> file.</p>

<h1 id="references">References</h1>

<p>[1] <a href="https://doi.org/10.1107/S0021889812032906">M. Sale and M. Avdeev, <em>J. Appl. Cryst.</em> (2012). <strong>45</strong>, 1054‚Äì1056.</a></p>

<p>[2] <a href="https://doi.org/10.1002/pssa.201001116">S. Adams and R. P. Rao, <em>Phys. Status Solidi A</em> (2011) <strong>208</strong> (8), 1746‚Äì1753.</a></p>

<p>[3] <a href="../assets/files/po5136sup2.pdf">BondStr documentation</a></p>

<p>[4] <a href="../assets/files/6-BVEL-BVS-BondStr.pdf">BondStr presentation</a></p>

<p>[5] <a href="https://code.ill.eu/scientific-software/crysfml/-/tree/Thierry/Program_Examples/BondStr/Examples">https://code.ill.eu/scientific-software/crysfml/-/tree/Thierry/Program_Examples/BondStr/Examples</a></p>

<p>[6] <a href="https://www.ill.eu/sites/fullprof/">https://www.ill.eu/sites/fullprof/</a></p>

<p>[7] <a href="https://www.iucr.org/resources/data/datasets/bond-valence-parameters">https://www.iucr.org/resources/data/datasets/bond-valence-parameters</a></p>

<p>[8] <a href="https://wild.life.nctu.edu.tw/class/common/energy-unit-conv-table.html">https://wild.life.nctu.edu.tw/class/common/energy-unit-conv-table.html</a></p>

      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#technical">technical</a>
          
            <a href="/tags#diffraction">diffraction</a>
          
            <a href="/tags#ion diffusion">ion diffusion</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a target="_blank" href="https://twitter.com/intent/tweet?text=Bond+Valence+Energy+Landscape+Calculation+with+the+BondStr+Program+in+Fullprof+Suite&url=http%3A%2F%2Flocalhost%3A4000%2F2025-10-26-bondstr_bvs%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2025-10-26-bondstr_bvs%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2F2025-10-26-bondstr_bvs%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2025-10-17-mantid_geometry/" data-toggle="tooltip" data-placement="top" title="Instrument Geometry in Mantid Framework">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2025-11-19-n8n_postgres_embed/" data-toggle="tooltip" data-placement="top" title="Set up workflows for bidirectional connection between NocoDB and Slack">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  <div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_shortname = &quot;rmcprofile&quot;;
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://rmcprofile.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row column_top">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
        <h3>External Links</h3>
        </div>
    </div>
    <div class="row" style="margin-bottom:10px">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Monte Carlo</h4>
				<a target="_blank" href="https://tproffen.github.io/DiffuseCode/">DISCUS</a>
				</br>
				<a target="_blank" href="https://www.szfki.hu/~nphys/rmc++/opening.html">RMC++</a>
				</br>
				<a target="_blank" href="https://research.csiro.au/mmm/hrmc/">HRMC</a>
				</br>
				<a target="_blank" href="https://bachiraoun.github.io/fullrmc/">fullrmc</a>
				</br>
        <a target="_blank" href="http://www.dragon.lv/exafs/rmc.htm">RMC for EXAFS</a>
        </br>
        <a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/Empirical-Potential-Structure-Refinement.aspx">EPSR</a>
				</br>
				<a target="_blank" href="https://rmcprofile.ornl.gov/">RMCProfile website</a>
				</br>
				<a target="_blank" href="http://www.rmcprofile.org/Main_Page">RMCProfile website - legacy</a>
				</br>
				<a target="_blank" href="https://en.wikipedia.org/wiki/Reverse_Monte_Carlo">Wikipedia for RMC</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Rietveld-like</h4>
        <a target="_blank" href="https://www.diffpy.org/products/pdfgui.html">PDFgui</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/diffpycmi/index.html">DIFFPy-CMI</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/mPDF.html">magnetic PDF</a>
        </br>
        <a target="_blank" href="https://topas.webspace.durham.ac.uk/tutorial_pdf_sno2/">Topas for PDF</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Tools</h4>
        <a target="_blank" href="http://addie.ornl.gov/">ADDIE</a>
        </br>
				<a target="_blank"
						href="http://li.mit.edu/Archive/Graphics/A/">Atomeye</a>
				</br>
				<a target="_blank"
						href="https://sourceforge.net/projects/xming/">Xming</a>
				</br>
				<a target="_blank"
						href="https://www.mantidproject.org/Main_Page">Mantid</a>
				</br>
				<a target="_blank" href="https://www.facebook.com/disord.matt">GUDRUN</a>
				</br>
				<a target="_blank"
						href="https://www.diffpy.org/products/pdfgetx.html">PDFGet..
						</a>
				</br>
				<a target="_blank" href="https://www.ncnr.nist.gov/resources/n-lengths/">Neutron scattering length</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/reference/Xray_scatfac.htm">X-ray form factor</a>
				</br>
				<a target="_blank" href="https://www.webelements.com/">Web elements</a>
				</br>
				<a target="_blank" href="https://ptable.com/#Properties">Dynamic
						periodic table</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/disordered/Manuals/ATLAS/atlas_values.htm">ISIS values</a>
				</br>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Facilities</h4>
				<a target="_blank" href="https://neutrons.ornl.gov/nomad">US - ORNL - NOMAD</a>
        </br>
				<a target="_blank" href="https://neutrons.ornl.gov/powgen">US - ORNL -
						POWGEN</a>
				</br>
				<a target="_blank" href="https://www.aps.anl.gov/Beamlines/Directory/Details?beamline_id=16">US - APS - 11-ID-B</a>
				</br>
				<a target="_blank" href="https://www.bnl.gov/ps/beamlines/beamline.php?r=28-ID-1">US - BNL - 28-ID-1</a>
				</br>
				<a target="_blank"
						href="https://www.isis.stfc.ac.uk/Pages/Gem.aspx">UK - ISIS - GEM</a>
				</br>
				<a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/polaris.aspx">UK - ISIS - Polaris</a>
				</br>
				<a target="_blank" href="https://www.diamond.ac.uk/Instruments/Crystallography/I15-1.html">UK - Diamond - I15-1</a>
				</br>
				<a target="_blank" href="https://mlfinfo.jp/en/bl21/">Japan - J-PARC - NOVA</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL14B1/instrument/lang-en/INS-0000000309/instrument_summary_view">Japan - SPRING8 - BL14B1</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL22XU/instrument/lang-en/INS-0000000327/instrument_summary_view">Japan - SPRING8 - BL22XU</a>
				</br>
				<a target="_blank" href="https://europeanspallationsource.se/instruments/heimdal">Europe - ESS - HEIMDAL</a>
      </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 footer_bottom">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a target="_blank" href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="mailto:zhangy3@ornl.gov" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="https://github.com/kvieta1990" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="https://reddit.com/u/apw247" title="Reddit">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-reddit fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Reddit</span>
   </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="https://linkedin.com/in/yuanpeng-zhang-11bb503a" title="LinkedIn">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">LinkedIn</span>
   </a>
  </li><li class="list-inline-item">
   <a target="_blank" href="https://orcid.org/0000-0003-4224-3361" title="ORCID">
     <span class="fa-stack fa-lg" aria-hidden="true">
       <i class="fas fa-circle fa-stack-2x"></i>
       <i class="fab fa-orcid fa-stack-1x fa-inverse"></i>
     </span>
     <span class="sr-only">ORCID</span>
   </a>
 </li><li class="list-inline-item">
    <a target="_blank" href="https://scholar.google.com/citations?user=NgqIgO0AAAAJ&hl=en" title="Google Scholar">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fa fa-graduation-cap fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Google Scholar</span>
    </a>
  </li></ul>

      
      <p class="copyright text-muted">

      
      </p>
      <p class="theme-by text-muted">
        Copyright 2025 ¬©
        <a>Yuanpeng Zhang</a>
      </p>
      </div>
    </div>
	<div class="row" id="vistor_map" style="position:absolute; left:-10px; bottom:20px;">
	  <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=000000&w=300&t=tt&d=mXrA2cjTFPms32CLvpbXJeN7mGr8Pp6J7WRX3Im-ZOw&co=eaeaea&ct=000000'></script>
	</div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
