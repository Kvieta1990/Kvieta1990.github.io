<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
<link rel="manifest" href="/assets/img/site.webmanifest">
<link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>When Fourier transform meets total scattering</title>

  
  <meta name="author" content="Yuanpeng Zhang">
  

  <meta name="description" content="In this article, I am going to note down my bits of understanding for the role that Fourier transform is playing in total scattering regime. Quite often we hear people talking about real space or reciprocal space representation of the total scattering signal. Also, it‚Äôs probably a common sense that...">

  

  

  <link rel="alternate" type="application/rss+xml" title="Yuanpeng's Blog" href="http://localhost:4001/feed.xml">

  

  

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163985757-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163985757-1');
</script>

  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Yuanpeng's Blog">
  <meta property="og:title" content="When Fourier transform meets total scattering">
  <meta property="og:description" content="In this article, I am going to note down my bits of understanding for the role that Fourier transform is playing in total scattering regime. Quite often we hear people talking about real space or reciprocal space representation of the total scattering signal. Also, it‚Äôs probably a common sense that...">

  
  <meta property="og:image" content="http://localhost:4001/assets/img/avatar-icon.png">
  

  
  <meta property="og:type" content="article">
  <meta property="og:article:author" content="Yuanpeng Zhang">
  <meta property="og:article:published_time" content="2020-06-28T00:00:00+00:00">
  <meta property="og:url" content="http://localhost:4001/2020-06-28-fourier_transform/">
  <link rel="canonical" href="http://localhost:4001/2020-06-28-fourier_transform/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="When Fourier transform meets total scattering">
  <meta property="twitter:description" content="In this article, I am going to note down my bits of understanding for the role that Fourier transform is playing in total scattering regime. Quite often we hear people talking about real space or reciprocal space representation of the total scattering signal. Also, it‚Äôs probably a common sense that...">

  
  <meta name="twitter:image" content="http://localhost:4001/assets/img/avatar-icon.png">
  

  


  

  

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script async='async' src='https://www.gstatic.com/external_hosted/clipboardjs/clipboard.min.js'></script>
<script src='https://unpkg.com/sweetalert@2.1.2/dist/sweetalert.min.js'></script>
<script language='JavaScript'>
  function copytoclipboard(containerid){
    if (document.selection) {
      var range = document.body.createTextRange();
      range.moveToElementText(document.getElementById(containerid));
      range.select().createTextRange();
      document.execCommand("copy");
    } else if (window.getSelection) {
      var range = document.createRange();
      range.selectNode(document.getElementById(containerid));
      var selection = window.getSelection() // get Selection object from currently user selected text
      selection.removeAllRanges() // unselect any user selected text (if any)
      selection.addRange(range) // add range to Selection object to select it
      document.execCommand("copy");
      //alert("Codes snippet copied to clipboard!")
      swal({
      title: "",
      text: "Codes snippet copied to clipboard!",
      icon: "success",
      });
    }
  }
</script>
</head>

<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand navbar-brand-logo" href="http://localhost:4001/"><img alt="Yuanpeng's Blog Logo" src="/assets/img/home.png"/></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
              <a class="nav-link" href="/search">üîçSearch</a></li>
          <li class="nav-item">
              <a class="nav-link" href="/about">About</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Posts</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/all_posts">All posts</a>
                    <a class="dropdown-item" href="/archive">Archive</a>
                    <a class="dropdown-item" href="/tags">Tags</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Research</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/nav_pages/publications">Publications</a>
                    <a class="dropdown-item" href="/nav_pages/lnotes">Learning Notes</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More Links</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown"><a target="_blank" class="dropdown-item" href="https://www.ornl.gov/staff-profile/yuanpeng-zhang">ORNL Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://scholar.google.com/citations?user=NgqIgO0AAAAJ&hl=en">Google Scholar</a>
								  <a target="_blank" class="dropdown-item" href="https://orcid.org/0000-0003-4224-3361">ORCID</a>
								  <a target="_blank" class="dropdown-item" href="https://rmcprofile.pages.ornl.gov/">RMCProfile</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990">GitHub Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://mybinder.org/v2/gh/Kvieta1990/Jup_Notes/master">Jupyter Binder</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Iris">More Notes</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Kvieta1990.github.io">Blog Repo</a>
								  
            </div>
          </li>
        </ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border" id="others">
      </div>
    </div>
    <div class="avatar-container">
      <div class="avatar-img-border">
					<div class="avatar-adjust" id="safari">
				  </div>
      </div>
    </div>
  

<script>
function myFunction() {
		return '<a href="http://localhost:4001/"><img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/avatar-icon.png" />';
}
let safariAgent = navigator.userAgent.indexOf("Safari") > -1;
let chromeAgent = navigator.userAgent.indexOf("Chrome") > -1;
if (chromeAgent) {
  document.getElementById("others").innerHTML = myFunction();
} else if (safariAgent) {
  document.getElementById("safari").innerHTML = myFunction();
} else {
  document.getElementById("others").innerHTML = myFunction();
}

</script>

</nav>


  <!-- TODO this file has become a mess, refactor it -->







<header class="header-section ">

<div class="intro-header no-img">
  <div class="container-md">
    <div class="row">
      <div class="col-xl-10 offset-xl-1 col-lg-12 offset-lg-1">
        <div class="post-heading">
						<h1>When Fourier transform meets total scattering</h1>
          

          
					<span class="post-meta">Posted on June 28, 2020, by Yuanpeng Zhang</span>
            
            
          
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class=" container-md ">
  <div class="row">
    <div class=" col-xl-10 offset-xl-1 col-lg-12 offset-lg-1 ">

      

      

      <article role="main" class="blog-post">
        <p align="center">
<img src="/assets/img/posts/fourier.png" style="border:none;" alt="fourier" title="fourier" />
<br />
</p>

<p style="text-align: justify">
In this article, I am going to note down my bits of understanding for the role that Fourier transform is playing in total scattering regime. Quite often we hear people talking about real space or reciprocal space representation of the total scattering signal. Also, it‚Äôs probably a common sense that the two spaces are coupled by Fourier transform. But if pulling ourselves out of those technical details for the moment and think about why Fourier transform comes into play in total scattering regime in the first place, sometimes we may find ourselves in a situation like ‚Äòum‚Ä¶but‚Ä¶why?‚Äô

<br />

Before diving into the specific total scattering topic, I will first mention a little bit background about Fourier transform. Here I will not try to reproduce details about it from head to toe, since obviously a simple Googling will guide us to tons of available resources about such a topic. Therefore, there is no need at all to reinvent the wheel. Instead, I will pick up a very interesting visualization of Fourier transform that I came across on YouTube and try to reproduce it here as an intro before going into my topic. Also, I will recover two little pieces of problems that I encountered during learning total scattering. They are not crucial for understanding the topic but I think it‚Äôs always good to stop and think why, instead of just accepting them as being granted.

<br />

So, first lets start with the visualization of Fourier transform mentioned above. As I said, I first came across this fantastic visualization in a YouTube video, which one can check out here: <a target="_blank" href="https://draft.blogger.com/blog/post/edit/713170236114697752/1007606233171498796#">Click Me!</a> The original post can be found in the blog titled <a target="_blank" href="https://draft.blogger.com/blog/post/edit/713170236114697752/1007606233171498796#">Purrier Series (Meow) and Making Images Speak</a>, in which Mathematica was used to generate those fabulous animations. Also, mathematical formulation can be found either in the post mentioned here or the link here: <a target="_blank" href="https://draft.blogger.com/blog/post/edit/713170236114697752/1007606233171498796#">Click Me!</a> Here, I took the same idea and make a simple reproduction of two simple animations with Python, just as a practice. What we are transforming here is a square function and only the first two components are considered here. The transformation involving only the first component is like this:
</p>

<p align="center">
<img src="/assets/img/posts/first_component.gif" style="border:none;" alt="1st" title="1st" />
<br />
</p>

<p style="text-align: justify">
Then the first and third components are involved:
</p>

<p align="center">
<img src="/assets/img/posts/third_component.gif" style="border:none;" alt="3rd" title="3rd" />
<br />
</p>

<p style="text-align: justify">
The Python script used to generate the two animations above is reproduced as follows (one needs numpy and matplotlib to run it):
</p>

<div align="right">
  <p><button onclick="javascript:copytoclipboard('csp1')" style="border: none">Copy snippet to clipboard!</button></p>
</div>
<div style="background: rgb(255, 255, 255); border: solid gray; height: 500px; overflow: auto; padding: 0.0em 0.0em; width: auto;">
  <table><tbody><tr><td><pre style="color: grey; line-height: 125%; margin-bottom: 0px; margin-right: 5px; margin-top: 0px;">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246</pre></td><td id="csp1"><pre style="line-height: 125%; margin: 0px;"><span style="color: #008800; font-weight: bold;">import</span> <span style="color: #0e84b5; font-weight: bold;">numpy</span> <span style="color: #008800; font-weight: bold;">as</span> <span style="color: #0e84b5; font-weight: bold;">np</span>
<span style="color: #008800; font-weight: bold;">import</span> <span style="color: #0e84b5; font-weight: bold;">matplotlib.pyplot</span> <span style="color: #008800; font-weight: bold;">as</span> <span style="color: #0e84b5; font-weight: bold;">plt</span>
<span style="color: #008800; font-weight: bold;">import</span> <span style="color: #0e84b5; font-weight: bold;">matplotlib.animation</span> <span style="color: #008800; font-weight: bold;">as</span> <span style="color: #0e84b5; font-weight: bold;">animation</span>


<span style="color: #888888;"># Function to be used as the updator for first Fourier component.</span>
<span style="color: #888888;"># Here we have,</span>
<span style="color: #888888;"># 'line'    for rotating bar</span>
<span style="color: #888888;"># 'line1'   for scanning bar moving up and down</span>
<span style="color: #888888;"># 'line2'   for plotting the first Fourier component.</span>
<span style="color: #888888;"># 'line3'   for plotting the original square function.</span>
<span style="color: #008800; font-weight: bold;">def</span> <span style="color: #0066bb; font-weight: bold;">update_line_1</span>(num, xy_plot, line, line1, line2, line3):
    line<span style="color: #333333;">.</span>set_data([<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>]], [<span style="color: #0000dd; font-weight: bold;">0</span>, xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])
    line1<span style="color: #333333;">.</span>set_data([xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>], <span style="color: #0000dd; font-weight: bold;">0</span>],
                   [xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>], xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])
    <span style="color: #888888;"># x2_temp = [item[0] for item in xy1_plot[:num]]</span>
    <span style="color: #888888;"># y2_temp = [item[1] for item in xy1_plot[:num]]</span>
    x2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy1_plot[num]]
    y2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy1_plot[num]]
    line2<span style="color: #333333;">.</span>set_data(x2_temp, y2_temp)

    x2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy_line_plot[num]]
    y2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy_line_plot[num]]
    line3<span style="color: #333333;">.</span>set_data(x2_temp, y2_temp)

    <span style="color: #008800; font-weight: bold;">return</span> line, line1, line2, line3


<span style="color: #888888;"># Function to be used as the updator for first and third Furier component.</span>
<span style="color: #888888;"># Here we have,</span>
<span style="color: #888888;"># 'line'    for rotating bar indicating the first component.</span>
<span style="color: #888888;"># 'line1'   for scanning bar moving up and down.</span>
<span style="color: #888888;"># 'line2'   for plotting the first and third Fourier components.</span>
<span style="color: #888888;"># 'patch1'  for rotating circle indicating the third component.</span>
<span style="color: #888888;"># 'line3'   for the center of the rotating circle (again, indicating the</span>
<span style="color: #888888;">#           third component).</span>
<span style="color: #888888;"># 'line4'   for the rotating bar indicating the third component.</span>
<span style="color: #888888;"># 'line5'   for plotting the original square function.</span>
<span style="color: #008800; font-weight: bold;">def</span> <span style="color: #0066bb; font-weight: bold;">update_line_3</span>(num, xy_plot, line, line1, line2,
                  patch1, line3, line4, line5):
    line<span style="color: #333333;">.</span>set_data([<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>]], [<span style="color: #0000dd; font-weight: bold;">0</span>, xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])
    line1<span style="color: #333333;">.</span>set_data([xy_plot_1[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>], <span style="color: #0000dd; font-weight: bold;">0</span>],
                   [xy_plot_1[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>], xy_plot_1[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])
    x2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy3_plot[num]]
    y2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy3_plot[num]]
    line2<span style="color: #333333;">.</span>set_data(x2_temp, y2_temp)

    patch1<span style="color: #333333;">.</span>center <span style="color: #333333;">=</span> (xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>], xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>])
    patch1<span style="color: #333333;">.</span>radius <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi

    ax2<span style="color: #333333;">.</span>add_patch(patch1)

    line3<span style="color: #333333;">.</span>set_data([xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>]], [xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])

    line4<span style="color: #333333;">.</span>set_data([xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>], xy_plot_1[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">0</span>]],
                   [xy_plot[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>], xy_plot_1[num <span style="color: #333333;">-</span> <span style="color: #0000dd; font-weight: bold;">1</span>][<span style="color: #0000dd; font-weight: bold;">1</span>]])

    x2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy_line_plot[num]]
    y2_temp <span style="color: #333333;">=</span> [item[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #008800; font-weight: bold;">for</span> item <span style="color: black; font-weight: bold;">in</span> xy_line_plot[num]]
    line5<span style="color: #333333;">.</span>set_data(x2_temp, y2_temp)

    <span style="color: #008800; font-weight: bold;">return</span> line, line1, line2, patch1, line3, line4, line5


fig1, ax1 <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>subplots()
ax1<span style="color: #333333;">.</span>set_aspect(<span style="background-color: #fff0f0;">'equal'</span>)
ax1<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"bottom"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax1<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"top"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax1<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"left"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax1<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"right"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax1<span style="color: #333333;">.</span>tick_params(direction<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'out'</span>, length<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">6</span>)

<span style="color: #888888;"># The static circle indicating the first component.</span>
circle <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>Circle((<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">0</span>), <span style="color: #0000dd; font-weight: bold;">4</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'red'</span>, fill<span style="color: #333333;">=</span><span style="color: #007020;">False</span>)
ax1<span style="color: #333333;">.</span>add_artist(circle)

<span style="color: #888888;"># The rotating circle indicating the third component.</span>
patch1 <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>Circle((<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>), <span style="color: #6600ee; font-weight: bold;">0.0</span>, fc<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'y'</span>)

<span style="color: #888888;"># Plot some indicator ticks for the graph.</span>
plt<span style="color: #333333;">.</span>plot(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">0</span>, <span style="background-color: #fff0f0;">'-o'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'gray'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">4</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">2</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #0000dd; font-weight: bold;">1</span>, <span style="color: #0000dd; font-weight: bold;">1</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">1</span>, <span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">1</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)

<span style="color: #888888;"># Generating data for plotting.</span>
x_temp <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>linspace(<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #6600ee; font-weight: bold;">4.0</span>, <span style="color: #0000dd; font-weight: bold;">500</span>)
<span style="color: #888888;"># First, the rotating bar indicating the first component.</span>
xy_plot <span style="color: #333333;">=</span> []
<span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
    xy_plot<span style="color: #333333;">.</span>append([<span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>cos(np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]) <span style="color: #333333;">-</span> <span style="color: #6600ee; font-weight: bold;">2.0</span>,
                    <span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i])])
<span style="color: #888888;"># Then, the rotating bar indicating the third component. For this one,</span>
<span style="color: #888888;"># the origin is rotating as well.</span>
xy_plot_1 <span style="color: #333333;">=</span> []
<span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
    center_1 <span style="color: #333333;">=</span> [<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">2.0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>]
    center_2 <span style="color: #333333;">=</span> [<span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>cos(np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]),
                <span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i])]
    ending <span style="color: #333333;">=</span> [<span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>cos(<span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]),
              <span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(<span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i])]
    xy_plot_1<span style="color: #333333;">.</span>append([center_1[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #333333;">+</span> center_2[<span style="color: #0000dd; font-weight: bold;">0</span>] <span style="color: #333333;">+</span> ending[<span style="color: #0000dd; font-weight: bold;">0</span>],
                      center_1[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #333333;">+</span> center_2[<span style="color: #0000dd; font-weight: bold;">1</span>] <span style="color: #333333;">+</span> ending[<span style="color: #0000dd; font-weight: bold;">1</span>]])

<span style="color: #888888;"># Moving square function.</span>
xy_line_plot <span style="color: #333333;">=</span> []
<span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
    xy_line_plot<span style="color: #333333;">.</span>append([])
    <span style="color: #008800; font-weight: bold;">for</span> j <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
        t_part <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]
        x_part <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[j]
        y_temp <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>sign(np<span style="color: #333333;">.</span>sin(t_part <span style="color: #333333;">-</span> x_part))
        xy_line_plot[i]<span style="color: #333333;">.</span>append([x_temp[j], y_temp])

<span style="color: #888888;"># Function of the first component.</span>
xy1_plot <span style="color: #333333;">=</span> []
<span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
    xy1_plot<span style="color: #333333;">.</span>append([])
    <span style="color: #008800; font-weight: bold;">for</span> j <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
        t_part <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]
        x_part <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[j]
        y_temp <span style="color: #333333;">=</span> <span style="color: #0000dd; font-weight: bold;">4</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(t_part <span style="color: #333333;">-</span> x_part)
        xy1_plot[i]<span style="color: #333333;">.</span>append([x_temp[j], y_temp])

<span style="color: #888888;"># Function of the third component.</span>
xy3_plot <span style="color: #333333;">=</span> []
<span style="color: #008800; font-weight: bold;">for</span> i <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
    xy3_plot<span style="color: #333333;">.</span>append([])
    <span style="color: #008800; font-weight: bold;">for</span> j <span style="color: black; font-weight: bold;">in</span> <span style="color: #007020;">range</span>(<span style="color: #007020;">len</span>(x_temp)):
        t_part_1 <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]
        x_part_1 <span style="color: #333333;">=</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[j]
        t_part_3 <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[i]
        x_part_3 <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">2.0</span> <span style="color: #333333;">*</span> x_temp[j]
        y_temp_1 <span style="color: #333333;">=</span> <span style="color: #0000dd; font-weight: bold;">4</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(t_part_1 <span style="color: #333333;">-</span> x_part_1)
        y_temp_2 <span style="color: #333333;">=</span> <span style="color: #6600ee; font-weight: bold;">4.0</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi <span style="color: #333333;">/</span> <span style="color: #6600ee; font-weight: bold;">3.0</span> <span style="color: #333333;">*</span> np<span style="color: #333333;">.</span>sin(t_part_3 <span style="color: #333333;">-</span> x_part_3)
        xy3_plot[i]<span style="color: #333333;">.</span>append([x_temp[j], y_temp_1 <span style="color: #333333;">+</span> y_temp_2])

<span style="color: #888888;"># Initialize and update the animation. First, we include only first</span>
<span style="color: #888888;"># Fourier component.</span>
l, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'r-'</span>)
l1, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'r-'</span>)
l2, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'r-'</span>)
l3, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'k-'</span>)
plt<span style="color: #333333;">.</span>xlim(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">5</span>, <span style="color: #0000dd; font-weight: bold;">5</span>)
plt<span style="color: #333333;">.</span>ylim(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">2</span>)
line_ani_1 <span style="color: #333333;">=</span> animation<span style="color: #333333;">.</span>FuncAnimation(fig1, update_line_1, <span style="color: #0000dd; font-weight: bold;">500</span>,
                                     fargs<span style="color: #333333;">=</span>(xy_plot, l, l1, l2, l3),
                                     interval<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, blit<span style="color: #333333;">=</span><span style="color: #007020;">True</span>)

<span style="color: #888888;"># Then we add in the third component (the components of even number</span>
<span style="color: #888888;"># are all 0).</span>
fig2, ax2 <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>subplots()
ax2<span style="color: #333333;">.</span>set_aspect(<span style="background-color: #fff0f0;">'equal'</span>)
ax2<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"bottom"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax2<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"top"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax2<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"left"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax2<span style="color: #333333;">.</span>spines[<span style="background-color: #fff0f0;">"right"</span>]<span style="color: #333333;">.</span>set_linewidth(<span style="color: #0000dd; font-weight: bold;">2</span>)
ax2<span style="color: #333333;">.</span>tick_params(direction<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'out'</span>, length<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">6</span>)

circle <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>Circle((<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">0</span>), <span style="color: #0000dd; font-weight: bold;">4</span> <span style="color: #333333;">/</span> np<span style="color: #333333;">.</span>pi, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'red'</span>, fill<span style="color: #333333;">=</span><span style="color: #007020;">False</span>)
ax2<span style="color: #333333;">.</span>add_artist(circle)
patch1 <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>Circle((<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>), <span style="color: #6600ee; font-weight: bold;">0.0</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'blue'</span>, fill<span style="color: #333333;">=</span><span style="color: #007020;">False</span>)

<span style="color: #888888;"># Plot some indicator ticks for the graph.</span>
plt<span style="color: #333333;">.</span>plot(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">0</span>, <span style="background-color: #fff0f0;">'-o'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'gray'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">2</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #0000dd; font-weight: bold;">0</span>, <span style="color: #0000dd; font-weight: bold;">0</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #0000dd; font-weight: bold;">1</span>, <span style="color: #0000dd; font-weight: bold;">1</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
plt<span style="color: #333333;">.</span>plot([<span style="color: #333333;">-</span><span style="color: #6600ee; font-weight: bold;">0.25</span>, <span style="color: #0000dd; font-weight: bold;">0</span>], [<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">1</span>, <span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">1</span>],
         <span style="background-color: #fff0f0;">'-'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">1</span>,
         markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
         markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)

l, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'r-'</span>)
l1, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'b-'</span>)
l2, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'b-'</span>)
l3, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'-o'</span>, color<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'gray'</span>,
               markersize<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, linewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>,
               markerfacecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
               markeredgecolor<span style="color: #333333;">=</span><span style="background-color: #fff0f0;">'black'</span>,
               markeredgewidth<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">2</span>)
l4, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'b-'</span>)
l5, <span style="color: #333333;">=</span> plt<span style="color: #333333;">.</span>plot([], [], <span style="background-color: #fff0f0;">'k-'</span>)
plt<span style="color: #333333;">.</span>xlim(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">5</span>, <span style="color: #0000dd; font-weight: bold;">5</span>)
plt<span style="color: #333333;">.</span>ylim(<span style="color: #333333;">-</span><span style="color: #0000dd; font-weight: bold;">2</span>, <span style="color: #0000dd; font-weight: bold;">2</span>)

line_ani_3 <span style="color: #333333;">=</span> animation<span style="color: #333333;">.</span>FuncAnimation(fig2, update_line_3, <span style="color: #0000dd; font-weight: bold;">500</span>,
                                     fargs<span style="color: #333333;">=</span>(xy_plot, l, l1, l2, patch1,
                                            l3, l4, l5),
                                     interval<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">5</span>, blit<span style="color: #333333;">=</span><span style="color: #007020;">True</span>)

<span style="color: #888888;"># Save the animation to movie file. For some reason, saving to</span>
<span style="color: #888888;"># GIF file won't allow us to change the FPS and the whole animation</span>
<span style="color: #888888;"># will become very slow. Therefore, we save the animation first as</span>
<span style="color: #888888;"># MP4 file and use the online converter to transform to GIF file:</span>
<span style="color: #888888;"># https://ezgif.com/</span>
line_ani_1<span style="color: #333333;">.</span>save(<span style="background-color: #fff0f0;">'first_component.mp4'</span>, fps<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">250</span>, dpi<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">300</span>)
line_ani_3<span style="color: #333333;">.</span>save(<span style="background-color: #fff0f0;">'third_component.mp4'</span>, fps<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">250</span>, dpi<span style="color: #333333;">=</span><span style="color: #0000dd; font-weight: bold;">300</span>)

plt<span style="color: #333333;">.</span>show()
</pre></td></tr></tbody></table>
</div>

<p style="text-align: justify">
Next, I will briefly talk about the two problems about Fourier transform that I mentioned earlier.

<br />
<br />

<strong>üìåThe \(1/2\pi\) factor appearing in the inverse Fourier transform</strong>

<br />

Usually, the Fourier transform of function \(f(x)\) is defined as,
</p>

\[F(f) = \int_{-\infty}^{\infty}f(x)e^{-2\pi i xf}dx\]

<p style="text-align: justify">
The inverse Fourier transform will then be symmetrically and nicely given as,
</p>

\[f(x) = \int_{-\infty}^{\infty}F(f)e^{2\pi i xf}df\]

<p style="text-align: justify">
according to the Fourier inversion theorem. However, quite often we will see an extra factor \(1/2\pi\) in front of the inverse Fourier transform. So the natural question is - why do we have an extra factor there? Why do we not stay with the nice and symmetric form of forward and inverse Fourier transform?  The reason is simply due to the using of angular frequency (\(\omega\)) instead of frequency (\(f\)) as the independent variable in Fourier space. The relation between these two variables is simply,
</p>

\[\omega = 2\pi f\]

<p style="text-align: justify">
Using \(\omega\) as our Fourier space variable, one has the forward Fourier transform as,
</p>

\[\hat{F}(\omega) = F(\frac{\omega}{2\pi}) = \int_{-\infty}^{\infty}f(x)e^{-i\omega x}dx\]

<p style="text-align: justify">
where the symbol \(\hat{F}\) is used to represent the functional form with \(\omega\) as the independent variable, in contrast to the symbol \(F\) with \(f\) as the independent variable. Accordingly, the inverse Fourier transform will be given as,
</p>

\[f(x) = \int_{-\infty}^{\infty}F(f)e^{2\pi i xf}df = \int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d(\frac{\omega}{2\pi}) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d\omega\]

<p style="text-align: justify">
from which one can clearly see the popping up of the extra factor \(1/2\pi\).

<br />
<br />

<strong>üìåDiscrete Fourier transform</strong>

<br />

The definition of Fourier transform given above is in its continuous format, whereas in practice the signal we hold in hand will never be continuous. Unlike the continuous version of Fourier transform (of which the definition is unique, as given above), we need to first pin down what we really mean by discrete Fourier transform. Suppose we have a series of data measured to be (0.1, 100), (0.12, 101), (0.15, 300), (0.16, 321), ‚Ä¶, where the first number in each pair represents our variable (say, time \(t\)) and the second one is our response (say, voltage \(V\)), then how do we proceed to do the Fourier transform? This is where the definition of discrete Fourier transform is introduced. According to <a target="_blank" href="https://draft.blogger.com/blog/post/edit/713170236114697752/1007606233171498796#">Wikipedia</a>, we have,
</p>

<blockquote cite="">
  <p>in mathematics, the discrete Fourier transform (DFT) converts a finite sequence of <code class="language-plaintext highlighter-rouge">equally-spaced samples</code> of a function into <code class="language-plaintext highlighter-rouge">a same-length sequence of equally-spaced samples</code>‚Ä¶</p>
</blockquote>

<p style="text-align: justify">
Therefore, for the example given above (and also in the case of  total scattering as we will see later), one needs to first group the measured data into bins with equal width and then carry out the discrete Fourier transform as defined (see, e. g., <a target="_blank" href="https://draft.blogger.com/blog/post/edit/713170236114697752/1007606233171498796#">Wikipedia</a> for the exact definition).
</p>

<p><br /></p>

<p align="center">
========================I AM A SEPARATOR========================
</p>

<p><br /></p>

<p style="text-align: justify">
Finishing the preparation work, we now move on to discuss the reflection of Fourier transform in total scattering regime. First of all, what is total scattering? Scattering is scattering, but what do we mean by ‚Äòtotal‚Äô? Does it mean that not mentioning ‚Äòtotal‚Äô in the context indicates we are missing something? The answer is YES. But what do we miss?

<br />

In terms of scattering experiment, either with X-ray, neutron or electron, what we usually mean by ‚Äòscattering‚Äô is actually the Bragg reflection, in which we are specially concerned about the reflection from atom planes. The underlying rule is the famous Bragg‚Äôs law,
</p>

\[2dsin(\theta) = n\lambda\]

<p style="text-align: justify">
The common approach for analyzing Bragg pattern then focuses on the positions and intensities of those reflection peaks, which is fundamentally determined by atomic structure of material under radiation beam. Structures extracted in such a way is what we usually call as average structure. To go beyond the Bragg reflection and talk about total scattering, we need to dig into the base level of the scattering event. We already know that Bragg reflection originates from the scattering from atom planes. This is fundamentally owing to the in-phase reflection of the incoming beam from group (certain lattice plane) of atoms, leading to the overall enhanced interference effect. In that sense (and also in fact), the scattering event actually happens on the atomic level (to be more precise, X-ray interacts with electrons surrounding atoms, neutron interacts with nuclei, electron‚Äôs interaction with materials being complicated). Accordingly, the normalized (over all \(N\) atoms in the system) scattering intensity is given as,
</p>

\[\frac{1}{N}\frac{d\sigma}{d\Omega} = \frac{1}{N}\sum_{j,k}b_jb_kexp[i\mathbf{Q}\cdot(\mathbf{r}_j - \mathbf{r}_k)]\]

<p style="text-align: justify">
with the dimension of area (\(\sigma\) for cross section, \(\Omega\) for solid angle, \(b\) for scattering length (form factor in the case of X-ray scattering), \(\mathbf{Q}\) for scattering vector, \(\mathbf{r}\) for atomic position). Given the incoming flux of incoming beam (e. g. number of neutrons) per area, the product is equal to the flux of scattered beam per solid angle, which can then be equated to the experimental measurement. From the formulation given right above, one can see that the Bragg peak positions are only some special points in reciprocal space (i. e. \(Q\)-space). When only focusing on those special points in \(Q\)-space and ignoring all the other \(Q\) points (in practice, all the points other than those special ones are treated as background, in, e. g Rietveld refinement), no doubt one will lose a lot of useful information from the scattering measurement! By bringing back those ignored \(Q\) points, we will have the total scattering pattern, enabling us to retrieve those missing information - the local structure - in conventional Bragg data analysis. This is where Fourier transform comes to play an important role, which is what we will cover right next.

<br />

For the following discussion, we refer ourselves to the book by M. Dove [1] (see Appendix-J in the book for detailed derivations), with several key aspects recovered in current context. First, by pulling out all the self-terms, one arrives at,
</p>

\[\frac{1}{N}\frac{d\sigma}{d\Omega} = F(Q) + \sum_ic_ib_i^2\]

<p style="text-align: justify">
in which \(F(Q)\) can be further expressed as,
</p>

\[F(Q) = \rho\sum_{j,k}c_jc_kb_jb_k4\pi\int_{0}^{\infty}r^2g_{jk}(r)\frac{sin(Qr)}{Qr}dr\]

<p style="text-align: justify">
where \(c\) represents the proportion of atoms of each type, \(\rho\) refers to the overall number density of the system, and the term \(sin(Qr)/Qr\) comes from the isotropic orientational average of \(\langle exp[i\mathbf{Q}\cdot(\mathbf{r}_j - \mathbf{r}_k)]\rangle\). It‚Äôs worth mentioning that the following part in the definition of \(F(Q)\) gives the average number of atoms of type \(k\) within the shell \(r\rightarrow r+dr\) surrounding atoms of type \(j\),
</p>

\[\rho c_k4\pi r^2g_{jk}(r)dr\]

<p style="text-align: justify">
while \(c_j\) in the definition of \(F(Q)\) fundamentally comes from the normalization over the total number of atoms (\(N\)) in the system. The logic here is that we treat all inter-atomic distances within the range \(r\rightarrow r+dr\) to be the same and we count the number of atomic pairs with such a distance and multiply that number to the phase factor (in this case, \(sin(Qr)/Qr\)). Saying that, we are still doing the same thing as given in the original formation of the normalized scattering intensity above. The difference here is we group distances falling into the same bin together, instead of calculating every single possible distance individually and explicitly. This is the fundamental reason why calculating the reciprocal space total scattering pattern following the Debye approach (see Eqn. 4.9 in the book by R. Neder and T. Proffen [2]) and the Fourier transform approach (as we will see next) should give very similar result (slight difference may pop up due to the difference between considering each pair explicitly and binning similar distances).

<br />

Furthermore, by defining a new function,
</p>

\[G(r) = \sum_{j,k}c_jc_kb_jb_k[g_{jk}(r) - 1]\]

<p style="text-align: justify">
the function \(F(Q)\) can be further expressed as,
</p>

\[QF(Q) = \rho\int_{0}^{\infty}4\pi rG(r)sin(Qr)dr\]

<p style="text-align: justify">
from which one can clearly see that \(QF(Q)\) and \(rG(r)\) are linked by Fourier transform. Here we have the real version of Fourier transform, since the scattering measurement are measuring intensity only but not the phase and therefore we lose the phase information. Theoretically, accordance with such an experimental fact during our derivation for the scattering intensity dates back to Eqn. 6.22 in M. Dove‚Äôs book [1], where the square of the phase shift instead of the phase shift itself is used to reproduce the experimental scattering intensity.

<br />

As the partner equation of the one given just above, one has,
</p>

\[rG(r) = \frac{1}{(2\pi)^3\rho}\int_{0}^{\infty}4\pi QF(Q)sin(Qr)dQ\]

<p style="text-align: justify">
Here, the reason why we have \(1/(2\pi)^3\) term in the pre-factor is just that presented in early part of current blog. Specifically, the definition of \(Q\) is analogous to the angular frequency \(\omega\) we mentioned before, since we have \(Q = 2\pi/d\) where \(1/d\) is analogous to the frequency \(f\) we have before. Analogously, we can call \(1/d\) the space frequency and \(Q\) the space angular frequency. The cubic exponential in \(1/(2\pi)^3\) is coming from the fact that we have a 3D space and therefore naturally the factor \(1/2\pi\) should appear three times.

<br />
<br />

<strong>üìåAbout maximum \(r\) or \(Q\)</strong>

<br />

Given a certain \(r\) or \(Q\) grid, one question one may ask is what is the corresponding maximum \(Q\) or \(r\) that we can reach - we know resolution in one space corresponds to the spanning range in the coupled space. However, how to quantify such a coupled relation is a question and this is to be covered next. Given the relation \(Q = 2\pi/d\), it may be straightforward to tell that \(Q_{range} = 2\pi/\Delta d\), where \(Q_{range}\) refers to the \(Q\)-space coverage range and \(\Delta d\) is the \(d\)-space interval between nearest points. However, this is INCORRECT and the CORRECT version should be,
</p>

\[Q_{range} = \pi/\Delta d\]

<p style="text-align: justify">
Similarly one has,
</p>

\[d_{range} = \pi/\Delta Q\]

<p style="text-align: justify">
where ‚Äòrange‚Äô and \(\Delta\) carries the same meaning as mentioned above. So the question is, why do we miss the factor ‚Äò2‚Äô there? The fundamental reason for this is, in the Fourier transform space, alongside with the positive frequency, we also have the corresponding negative frequency and the negative frequency part is simply a mirror image of the positive part. Taking the Fourier transform from \(d\)- to \(Q\)-space as an example, the existence of mirroring to negative frequency means the actual \(Q\)-space coverage is \(2Q_{range}\) and therefore we cancel out the factor ‚Äò2‚Äô on both sides of the equation to give us \(Q_{range} = \pi/\Delta d\). So, next, we should spend a bit time to understand what negative frequency is and why we have it. Going back to the definition of Fourier transform presented above (e.g., the angular frequency case), we see that \(\hat{F}(\omega)\) is defined over the whole \(\mathcal{R}\) axis - this means definitely we will have negative frequency. Giving it a closer look, we have,
</p>

\[\begin{equation}\begin{aligned}\hat{F}(\omega) &amp; = \int_{-\infty}^{\infty}f(x)e^{-i\omega x}dx\\ &amp; = \int_{-\infty}^{\infty}f(x)cos(\omega x)dx - i\int_{-\infty}^{\infty}f(x)sin(\omega x)dx\\ &amp; = A(\omega) - iB(\omega)\end{aligned}\nonumber\end{equation}\]

<p style="text-align: justify">
When changing \(\omega\) to \(-\omega\), we know that \(cos\) function will not change while \(sin\) function will become negative. Therefore, we have,
</p>

\[\hat{F}(-\omega) = A(\omega) + iB(\omega)\]

<p style="text-align: justify">
so that we know the positive and negative frequency is not independent which means in fact the negative frequency does not bring in anything new to our signal. So why do we still have negative frequency? Why don‚Äôt we change the definition domain for \(\hat{F}(\omega)\) to be \([0, \infty)\)? The reason is, with \(\hat{F}(\omega)\) being defined on the full \(\mathcal{R}\) axis, the inverse Fourier transform of \(\hat{F}(\omega)\) will give real function which has physical meaning (since simply the observable signal in practice should be real). To see this, we need to revisit the inverse Fourier transform,
</p>

\[f(x) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d\omega\]

<p style="text-align: justify">
where \(\hat{F}(\omega)\) is complex according to the definition of Fourier transform, and therefore, we can write,
</p>

\[\hat{F}(\omega) = |\hat{F}(\omega)|e^{i\phi(\omega)}\]

<p style="text-align: justify">
where \(|\hat{F}(\omega)|\) and \(\phi(\omega)\) refers to the amplitude and phase of \(\hat{F}(\omega)\), respectively. So, the inverse Fourier transform can be written as,
</p>

\[\begin{equation}\begin{aligned}f(x) &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty\hat{F}(\omega)e^{ix\omega}d\omega + \int_{-\infty}^0\hat{F}(\omega)e^{ix\omega}d\omega\bigg]\\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty|\hat{F}(\omega)|e^{i[\phi(\omega) + x\omega]}d\omega + \int_{-\infty}^0|\hat{F}(\omega)|e^{i[\phi(\omega) + x\omega]}d\omega\bigg]\\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty|\hat{F}(\omega)|e^{i[\phi(\omega) + x\omega]}d\omega + \int_{\infty}^0|\hat{F}(-\omega_t)|e^{i[\phi(-\omega_t) - x\omega_t]}d(-\omega_t)\bigg]\\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty|\hat{F}(\omega)|e^{i[\phi(\omega) + x\omega]}d\omega + \int_0^\infty|\hat{F}(-\omega)|e^{i[\phi(-\omega) - x\omega]}d\omega\bigg]\\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty|\hat{F}(\omega)|e^{i[\phi(\omega) + x\omega]}d\omega + \int_0^\infty|\hat{F}(\omega)|e^{-i[\phi(\omega) + x\omega]}d\omega\bigg]\\ &amp; =\frac{1}{2\pi}\int_0^\infty|\hat{F}(\omega)|\bigg[e^{i[\phi(\omega) + x\omega]} + e^{-i[\phi(\omega) + x\omega]}\bigg]d\omega\\ &amp; = \frac{1}{2\pi}\int_0^\infty|\hat{F}(\omega)|cos[\phi(\omega) + x\omega]d\omega\end{aligned}\nonumber\end{equation}\]

<p style="text-align: justify">
where we change the integration variable (\(\omega \rightarrow \omega_t\)) from line-2 to line-3. Using the fact that \(\omega_t\) is simply an integration dummy variable, we change it back to \(\omega\) and adjust the integration range accordingly (line-3 to line-4). From line-4 to line-5, we apply the relation between \(\hat{F}(\omega)\) and \(\hat{F}(\omega)\) ‚Äì they have identical amplitude but opposite phase. From the result, we can see that by expanding the definition domain to include negative frequency, we can guarantee that the inverse Fourier transform will always give real result, which is exactly what we need in practice. As for the physical meaning of negative frequency, we can imagine the sinusoidal function pictorially as rotation - the positive and negative then just corresponds to the rotation in different directions, i.e. clockwise or counterclockwise.
</p>

<p><br /></p>

<p><b>References</b></p>

<p>[1] M. T. Dove, Structure and Dynamics: An Atomic View of Materials. Oxford University Press, New York, 2002.</p>

<p>[2] R. B. Neder and T. Proffen, Diffuse Scattering and Defect Structure Simulations, Oxford University Press, New York, 2008.</p>

      </article>

      
        <div class="blog-tags">
          <span>Tags:</span>
          
            <a href="/tags#scattering">scattering</a>
          
            <a href="/tags#crystallography">crystallography</a>
          
            <a href="/tags#total scattering">total scattering</a>
          
            <a href="/tags#maths">maths</a>
          
        </div>
      

      

      
        <!-- Check if any share-links are active -->




<section id = "social-share-section">
  <span class="sr-only">Share: </span>

  
    <a target="_blank" href="https://twitter.com/intent/tweet?text=When+Fourier+transform+meets+total+scattering&url=http%3A%2F%2Flocalhost%3A4001%2F2020-06-28-fourier_transform%2F"
      class="btn btn-social-icon btn-twitter" title="Share on Twitter">
      <span class="fab fa-fw fa-twitter" aria-hidden="true"></span>
      <span class="sr-only">Twitter</span>
    </a>
  

  
    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4001%2F2020-06-28-fourier_transform%2F"
      class="btn btn-social-icon btn-facebook" title="Share on Facebook">
      <span class="fab fa-fw fa-facebook" aria-hidden="true"></span>
      <span class="sr-only">Facebook</span>
    </a>
  

  
    <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4001%2F2020-06-28-fourier_transform%2F"
      class="btn btn-social-icon btn-linkedin" title="Share on LinkedIn">
      <span class="fab fa-fw fa-linkedin" aria-hidden="true"></span>
      <span class="sr-only">LinkedIn</span>
    </a>
  

  

</section>



      

      <ul class="pagination blog-pager">
        
        <li class="page-item previous">
          <a class="page-link" href="/2020-06-27-conda_build/" data-toggle="tooltip" data-placement="top" title="Build package with conda recipe">&larr; Previous Post</a>
        </li>
        
        
        <li class="page-item next">
          <a class="page-link" href="/2020-07-04-sublime/" data-toggle="tooltip" data-placement="top" title="Notes on Sublime Text 3">Next Post &rarr;</a>
        </li>
        
      </ul>
      
  <div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_shortname = &quot;rmcprofile&quot;;
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://rmcprofile.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    </div>
  </div>
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row column_top">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
        <h3>External Links</h3>
        </div>
    </div>
    <div class="row" style="margin-bottom:10px">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Monte Carlo</h4>
				<a target="_blank" href="https://tproffen.github.io/DiffuseCode/">DISCUS</a>
				</br>
				<a target="_blank" href="https://www.szfki.hu/~nphys/rmc++/opening.html">RMC++</a>
				</br>
				<a target="_blank" href="https://research.csiro.au/mmm/hrmc/">HRMC</a>
				</br>
				<a target="_blank" href="https://bachiraoun.github.io/fullrmc/">fullrmc</a>
				</br>
        <a target="_blank" href="http://www.dragon.lv/exafs/rmc.htm">RMC for EXAFS</a>
        </br>
        <a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/Empirical-Potential-Structure-Refinement.aspx">EPSR</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/rmc/">RMC at ISIS facility</a>
				</br>
				<a target="_blank" href="http://www.rmcprofile.org/Main_Page">RMCProfile website - legacy</a>
				</br>
				<a target="_blank" href="https://en.wikipedia.org/wiki/Reverse_Monte_Carlo">Wikipedia for RMC</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Rietveld-like</h4>
        <a target="_blank" href="https://www.diffpy.org/products/pdfgui.html">PDFgui</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/diffpycmi/index.html">DIFFPy-CMI</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/mPDF.html">magnetic PDF</a>
        </br>
        <a target="_blank" href="https://community.dur.ac.uk/john.evans/topas_workshop/tutorial_pdf_sno2.htm">Topas for PDF</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Tools</h4>
        <a target="_blank" href="http://addie.ornl.gov/">ADDIE (ORNL internal)</a>
        </br>
				<a target="_blank"
						href="http://li.mit.edu/Archive/Graphics/A/">Atomeye</a>
				</br>
				<a target="_blank"
						href="https://sourceforge.net/projects/xming/">Xming</a>
				</br>
				<a target="_blank"
						href="https://www.mantidproject.org/Main_Page">Mantid</a>
				</br>
				<a target="_blank" href="https://www.facebook.com/disord.matt">GUDRUN</a>
				</br>
				<a target="_blank"
						href="https://www.diffpy.org/products/pdfgetx.html">PDFGet..
						</a>
				</br>
				<a target="_blank" href="https://www.ncnr.nist.gov/resources/n-lengths/">Neutron scattering length</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/reference/Xray_scatfac.htm">X-ray form factor</a>
				</br>
				<a target="_blank" href="https://www.webelements.com/">Web elements</a>
				</br>
				<a target="_blank" href="https://ptable.com/#Properties">Dynamic
						periodic table</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/disordered/Manuals/ATLAS/atlas_values.htm">ISIS values</a>
				</br>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Facilities</h4>
				<a target="_blank" href="https://neutrons.ornl.gov/nomad">US - ORNL - NOMAD</a>
        </br>
				<a target="_blank" href="https://neutrons.ornl.gov/powgen">US - ORNL -
						POWGEN</a>
				</br>
				<a target="_blank" href="https://www.aps.anl.gov/Beamlines/Directory/Details?beamline_id=16">US - APS - 11-ID-B</a>
				</br>
				<a target="_blank" href="https://www.bnl.gov/ps/beamlines/beamline.php?r=28-ID-1">US - BNL - 28-ID-1</a>
				</br>
				<a target="_blank"
						href="https://www.isis.stfc.ac.uk/Pages/Gem.aspx">UK - ISIS - GEM</a>
				</br>
				<a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/polaris.aspx">UK - ISIS - Polaris</a>
				</br>
				<a target="_blank" href="https://www.diamond.ac.uk/Instruments/Crystallography/I15-1.html">UK - Diamond - I15-1</a>
				</br>
				<a target="_blank" href=""https://mlfinfo.jp/en/bl21/>Japan - J-PARC - NOVA</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL14B1/instrument/lang-en/INS-0000000309/instrument_summary_view">Japan - SPRING8 - BL14B1</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL22XU/instrument/lang-en/INS-0000000327/instrument_summary_view">Japan - SPRING8 - BL22XU</a>
				</br>
				<a target="_blank" href="https://europeanspallationsource.se/instruments/heimdal">Europe - ESS - HEIMDAL</a>
				</br>
				<a target="_blank" href="http://e-ssrf.sinap.cas.cn/beamlines/bl13w1/201401/t20140112_152430.html">China - SSRF - BL13W1</a>
      </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 footer_bottom">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a target="_blank" href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="mailto:zhangy3@ornl.gov" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="https://github.com/kvieta1990" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">

      
      </p>
      <p class="theme-by text-muted">
        Copyright 2020 ¬©
        <a>Yuanpeng Zhang</a>
      </p>
      </div>
    </div>
	<div class="row" id="vistor_map" style="position:absolute; left:-10px; bottom:20px;">
	  <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=000000&w=300&t=tt&d=mXrA2cjTFPms32CLvpbXJeN7mGr8Pp6J7WRX3Im-ZOw&co=eaeaea&ct=000000'></script>
	</div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
