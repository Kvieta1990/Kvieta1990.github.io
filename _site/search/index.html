<!DOCTYPE html>
<html lang="en">
<!-- Beautiful Jekyll 5.0.0 | Copyright Dean Attali 2020 -->
<head>
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
<link rel="manifest" href="/assets/img/site.webmanifest">
<link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

  

  <title>Yuanpeng's Blog</title>

  
  <meta name="author" content="Yuanpeng Zhang">
  

  <meta name="description" content="{% include search-lunr.html %}">

  

  

  <link rel="alternate" type="application/rss+xml" title="Yuanpeng's Blog" href="http://localhost:4000/feed.xml">

  

  

  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-44PBCNZ80G"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-44PBCNZ80G');
</script>

  
    
      
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


    
      
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic">


    
      
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800">


    
  

  
    
      <link rel="stylesheet" href="/assets/css/bootstrap-social.css">
    
      <link rel="stylesheet" href="/assets/css/beautifuljekyll.css">
    
  

  

  
  
  

  

  
  <meta property="og:site_name" content="Yuanpeng's Blog">
  <meta property="og:title" content="Yuanpeng's Blog">
  <meta property="og:description" content="{% include search-lunr.html %}">

  
  <meta property="og:image" content="http://localhost:4000/assets/img/avatar-icon.png">
  

  
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://localhost:4000/search/">
  <link rel="canonical" href="http://localhost:4000/search/">
  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta property="twitter:title" content="Yuanpeng's Blog">
  <meta property="twitter:description" content="{% include search-lunr.html %}">

  
  <meta name="twitter:image" content="http://localhost:4000/assets/img/avatar-icon.png">
  

  


  

  

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script async='async' src='https://www.gstatic.com/external_hosted/clipboardjs/clipboard.min.js'></script>
<script src='https://unpkg.com/sweetalert@2.1.2/dist/sweetalert.min.js'></script>
<script language='JavaScript'>
  function copytoclipboard(containerid){
    if (document.selection) {
      var range = document.body.createTextRange();
      range.moveToElementText(document.getElementById(containerid));
      range.select().createTextRange();
      document.execCommand("copy");
    } else if (window.getSelection) {
      var range = document.createRange();
      range.selectNode(document.getElementById(containerid));
      var selection = window.getSelection() // get Selection object from currently user selected text
      selection.removeAllRanges() // unselect any user selected text (if any)
      selection.addRange(range) // add range to Selection object to select it
      document.execCommand("copy");
      //alert("Codes snippet copied to clipboard!")
      swal({
      title: "",
      text: "Codes snippet copied to clipboard!",
      icon: "success",
      });
    }
  }
</script>
</head>

<body>

  


  <nav class="navbar navbar-expand-xl navbar-light fixed-top navbar-custom top-nav-regular"><a class="navbar-brand navbar-brand-logo" href="http://localhost:4000/"><img alt="Yuanpeng's Blog Logo" src="/assets/img/home.png"/></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="main-navbar">
    <ul class="navbar-nav ml-auto">
          <li class="nav-item">
              <a class="nav-link" href="/about">About</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Posts</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/all_posts">All posts</a>
                    <a class="dropdown-item" href="/archive">Archive</a>
                    <a class="dropdown-item" href="/tags">Tags</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Academic</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="/nav_pages/publications">Publications</a>
                    <a class="dropdown-item" href="/nav_pages/lnotes">Learning Notes</a>
            </div>
          </li>
        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">More Links</a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown"><a target="_blank" class="dropdown-item" href="https://www.ornl.gov/staff-profile/yuanpeng-zhang">ORNL Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://scholar.google.com/citations?user=NgqIgO0AAAAJ&hl=en">Google Scholar</a>
								  <a target="_blank" class="dropdown-item" href="https://orcid.org/0000-0003-4224-3361">ORCID</a>
								  <a target="_blank" class="dropdown-item" href="https://rmcprofile.pages.ornl.gov/">RMCProfile</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990">GitHub Profile</a>
								  <a target="_blank" class="dropdown-item" href="https://mybinder.org/v2/gh/Kvieta1990/Jup_Notes/master">Jupyter Binder</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Iris">More Notes</a>
								  <a target="_blank" class="dropdown-item" href="https://github.com/Kvieta1990/Kvieta1990.github.io">Blog Repo</a>
								  
            </div>
          </li>
        </ul>
  </div>

  

  
    <div class="avatar-container">
      <div class="avatar-img-border" id="others">
      </div>
    </div>
    <div class="avatar-container">
      <div class="avatar-img-border">
					<div class="avatar-adjust" id="safari">
				  </div>
      </div>
    </div>
  

<script>
function myFunction() {
		return '<a href="http://localhost:4000/"><img alt="Navigation bar avatar" class="avatar-img" src="/assets/img/avatar-icon.png" />';
}
let safariAgent = navigator.userAgent.indexOf("Safari") > -1;
let chromeAgent = navigator.userAgent.indexOf("Chrome") > -1;
if (chromeAgent) {
  document.getElementById("others").innerHTML = myFunction();
} else if (safariAgent) {
  document.getElementById("safari").innerHTML = myFunction();
} else {
  document.getElementById("others").innerHTML = myFunction();
}

</script>

</nav>


  <!-- TODO this file has become a mess, refactor it -->




<div class="intro-header"></div>





<div class="intro-header"></div>

<div role="main" class=" container-md ">
  

  </br>

<script src="/js/lunr.js"></script>

<script>

var documents = [{
    "id": 0,
    "url": "http://localhost:4000/404.html",
    "title": "404 - Page not found",
    "body": " Whoops, this page doesn’t exist.  Move along. (404 error)   "
    }, {
    "id": 1,
    "url": "http://localhost:4000/about/",
    "title": "About My Blog",
    "body": "  This is my personal blog, for the purpose of recording my learning progress. For every single idea which I believe is crucial for understanding specific physics or other topics,I have been trying my best to write them down. On one hand, this can help myself refreshing my mind from time to time,and on the other, if someone else loving physics happens to meet this site,I hope either these materials can help them or they can provide important advice for me to revise some key stuff, which could help improving my understanding! We all have such moments when forgetting something we already understood before. So why not writing them down when you are sure you have got it (maybe someday, what you were sure about turns out to be wrong!)?Also, learning physics, or perhaps anything else, is a process of accumulating and we can never say what is important or not. Neither can we say with hundred percent confidence that we really understand the real meaning of some specific issues – this makes me recall a saying by R. Feynman – ‘illusion of understanding’. So let’s write everything in mind down to paper,and have a look in the future (or show around to others). There are two cases possibly to happen – one is ‘Ah ha, what I thought at that time is absolutely correct!’ and we then get a deeper impression in mind about how it works. The other case is that ‘Oh no, the stuff I wrote at that time is totally wrong!!!’. That is, however, not totally a disaster since we now realize something is going wrong, which, at least, is better than pretending everything is right! At last, it is reading, writing, reviewing and effective interaction that makes everybody and also physics itself different from what it was yesterday. So, let’s write! "
    }, {
    "id": 2,
    "url": "http://localhost:4000/nav_pages/about_community/",
    "title": "RMCProfile Community",
    "body": "Two magic ways to join the RMCProfile community for discussion    [Recommended] GitHub Issues.          Go to COMMUNITY -&gt; ON GITHUB in the top-right corner of the page.           Quickly access community discussion,                Once opening the ON GITHUB link, bookmark it.                 The GitHub issues are associated with a GitHub repository. Therefore,Star the repository will give you quick access to our GitHub issuesthrough your Starred repository.                 Access to the community through this RMCProfile website is not a badoption.                    More information to be presented below.          Mailing list.      Go to COMMUNITY -&gt; MAILING LIST in the top-right corner of the page.    Brief covering for the recommended way of joining the community discussion,using GitHub issues    You need a GitHub account.      &gt; Click Me to get it if you are not already having one.       Though it is fairly straightforward to use, a demo for how-to is still worthit, as given below.        A few more links introducing GitHub issues to check out.          About issues           Mastering issues       "
    }, {
    "id": 3,
    "url": "http://localhost:4000/all_posts/",
    "title": "Yuanpeng's Posts",
    "body": ""
    }, {
    "id": 4,
    "url": "http://localhost:4000/nav_pages/change_log/",
    "title": "Change Log",
    "body": ""
    }, {
    "id": 5,
    "url": "http://localhost:4000/nav_pages/developers/",
    "title": "Developers",
    "body": ""
    }, {
    "id": 6,
    "url": "http://localhost:4000/nav_pages/disclaimer/",
    "title": "Disclaimer",
    "body": "The software and files on this site are delivered to you AS IS and for non-profit making purposes. The primary authors (Matt Tucker, Martin Dove, Andrew Goodwin, Anthony Phillips, David Keen, Helen Playford, Wojciech A. Slawinski, Igor Levin, Victor Krayzman, Maksim Eremenko and Yuanpeng Zhang) and their employing organizations (STFC, ORNL, NIST, the Universities of Oxford and Cambridge, Queen Mary, University of London) make no warranty as to their use or performance. The employing organizations and their suppliers make no warranties regarding performance, results or otherwise, express or implied, nor also regarding to non-infringement or third-party rights, merchantability, or fitness for any particular purpose. In no event will the employing organizations be liable to you for any consequential, incidental, or special damages, including any lost profits or lost savings, even if the their representatives have been advised of the possibility of such damages, or for any claim by any third party. "
    }, {
    "id": 7,
    "url": "http://localhost:4000/archive/2021/06/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 8,
    "url": "http://localhost:4000/archive/2021/12/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 9,
    "url": "http://localhost:4000/archive/2020/03/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 10,
    "url": "http://localhost:4000/archive/2020/04/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 11,
    "url": "http://localhost:4000/archive/2020/02/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 12,
    "url": "http://localhost:4000/archive/2020/11/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 13,
    "url": "http://localhost:4000/archive/2020/10/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 14,
    "url": "http://localhost:4000/archive/2020/07/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 15,
    "url": "http://localhost:4000/archive/2020/09/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 16,
    "url": "http://localhost:4000/archive/2020/06/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 17,
    "url": "http://localhost:4000/archive/2020/12/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 18,
    "url": "http://localhost:4000/archive/2022/11/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 19,
    "url": "http://localhost:4000/archive/",
    "title": "Archive",
    "body": "        2023                      February (1)       2022                                     December (3)                           November (2)                                                October (5)                   June (1)       2021                       December (1)                    August (1)                                  July (3)                    June (1)                          May (2)       2020                                     December (3)                                  November (3)                    September (1)                                         July (4)                                  June (3)                           April (2)                                 March (3)       2019                    December (2)"
    }, {
    "id": 20,
    "url": "http://localhost:4000/archive/2022/10/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 21,
    "url": "http://localhost:4000/archive/2022/06/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 22,
    "url": "http://localhost:4000/archive/2022/12/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 23,
    "url": "http://localhost:4000/archive/2023/02/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 24,
    "url": "http://localhost:4000/archive/2019/12/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 25,
    "url": "http://localhost:4000/archive/2021/05/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 26,
    "url": "http://localhost:4000/archive/2021/07/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 27,
    "url": "http://localhost:4000/archive/2021/08/",
    "title": "Archive",
    "body": ""
    }, {
    "id": 28,
    "url": "http://localhost:4000/",
    "title": "Yuanpeng's Blog",
    "body": "About Me      &lt;h1&gt;Spallation Neutron Source&lt;/h1&gt;      &lt;h1&gt;Oak Ridge National Laboratory&lt;/h1&gt;   Working as neutron scattering scientist at ORNL, I have been actively involved in software development and scientific research activities. The software development part mainly involves the development and maintenance oftools for neutron scattering data reduction and analysis, such as ADDIE environmentfor neutron total scattering data reduction, ADDIE web interface for structuremining and online Bragg and pair distribution function refinement, RMCProfile packagefor fitting scattering data based on supercell approach. Meanwhile, I am alsointerfacing the beamline scientists team and the software development team at ORNL,actively working on the development of Mantid framework for powder diffraction data reduction.  My research interest mainly focuses on the application of neutron total scatteringto look at local structure of materials - both nucleus and magnetic. The local environmentplays an important role in determining properties in a wide range of functional materials,e. g. , the polarization behavior in ferroelectric materials, ion transportation behavior inenergy story materials, magnetic anisotropy in low dimensional magnetic systems, etc. Myresearch interest at this point is to utilize total scattering technique to reveal localstructure for energy storage (e. g. Li-ion battery, functional material (high entropy spinelmaterials) and low dimensional magnetic system (e. g. 2D vdWs magnetic materials). Forfuturistic perspective, using machine learning algorithms in phase recognition duringphase transition is one of the goals to pursue. More   Yuanpeng’s ORNL profile     Yuanpeng’s Google scholar     Yuanpeng’s ORCID     RMCProfile website     Yuanpeng’s GitHub     Binder for Jupyter notebooks     Learning notes on GitHub     GitHub repo for current blog  "
    }, {
    "id": 29,
    "url": "http://localhost:4000/nav_pages/lnotes/",
    "title": "Collection",
    "body": " Contents:  1. Notes on Machine Learning 1. 1. Probability Theory1. 2. Machine learning in practice2. Notes on group theory1. Notes on Machine Learning: 1. 1. Probability Theory: Probability theory basicsBayesian learningGaussian process 1. 2. Machine learning in practice: Linear algebra in machine learningLinear predictionRegularization &amp; cross-validationL1 Norm and LassoCategorical, Dirichlet distribution &amp; Naive BayesOptimizationLogistic regressionNeural network 2. Notes on group theory: Lecture note-ILecture note-IILecture note-III "
    }, {
    "id": 30,
    "url": "http://localhost:4000/nav_pages/manual/",
    "title": "",
    "body": ""
    }, {
    "id": 31,
    "url": "http://localhost:4000/nav_pages/publications/",
    "title": "Selected Publications",
    "body": "Click here for a full list of my publication list.  2022  Qiang Zhang, Yuanpeng Zhang, Masaaki Matsuda, Vasile Ovidiu Garlea, JiaqiangYan, Michael A. McGuire, D. Alan Tennant, Satoshi Okamoto. J. Am. Chem. Soc. ,2022, 144, 14339-14350. 2021    J Marcial, Y Zhang, X Zhao, H Xu, A Mesbah, ET Nienhuis, S Szenknect, JC Neuefeind, J Lin, L Qi, AA Migdisov, RC Ewing, N Dacheux, JS McCloy and X Guo,Thermodynamic non-ideality and disorder heterogeneity in actinide silicate solid solutions, npj Mater. Degrad. , 2021, 5 (1), 1-14.     Mingyang Ou, Yuanpeng Zhang, Yongcheng Zhu, Chenyang Fan, Shixiong Sun, Jintai Feng, Xueping Sun, Peng Wei, Jia Xu, Jian Peng, Xianyong Wu, Gang Jiang, Qing Li, Chun Fang and Jiantao Han, Local Structures of Soft Carbon and Electrochemical Performance of Potassium-Ion Batteries, ACS Appl. Mater. Interf. , 2021, 13 (24), 28261-28269.     Peng Jian, Ou Mingyang, Yi Haocong, Sun Xueping, Zhang Yuanpeng, Zhang Bao, Yu Ding, Wang Feng, Gu Songqi, Lopez Carlos, Zhang Wang, Liu YI, Fang Ju, Wei Peng, Li Yuyu, Miao Ling, Jiang Jianjun, Fang Chun, Li Qing, Fernandez-Diaz Maria Teresa, Alonso Jose Antonio, Chou Shulei and Han Jiantao, Defect-free-induced Na+ disordering in electrode materials, Energy Environ. Sci. , 2021, 14, 3130-3140.     F. P. Marlton, Z. Zhao, Y. Zhang, T. E. Proffen, C. D. Ling and B. J. Kennedy, Lattice Disorder and Oxygen Migration Pathways in Pyrochlore and Defect-Fluorite Oxides, Chem. Mater. , 2021, 33 (4) 1407-1415.     Santanu Roy, Shobha Sharma, Waruni V Karunaratne, Fei Wu, Ruchi Gakhar, Dmitry S Maltsev, Phillip Halstenberg, Milinda Abeykoon, Simerjeet K Gill, Yuanpeng Zhang, Shannon M Mahurin, Sheng Dai, Vyacheslav S Bryantsev, Claudio J Margulis and Alexander S Ivanov, X-ray scattering reveals ion clustering of dilute chromium species in molten chloride medium, Chem. Sci. , 2021, 12, 8026-8035.  2020    C. Li, Y. P. Zhang, J. Liu and H. A. Graetsch. Long-Range and Local Structure of SrxBa1–xNb2O6 (x = 0. 33 and 0. 67) across the Ferroelectric–Relaxor Transition, Chem. Mater. , 2020, 32 (5), 1844-1853.     Yuanpeng Zhang, Maksim Eremenko, Victor Krayzman, Matthew G. Tucker, Igor Levin, New capabilities for enhancement of RMCProfile: instrumental profiles with arbitrary peak shapes for structural refinements using the reverse Monte Carlo method, J. appl. Crystallogr. , 2020, 53 (6) 1-10.     Bo Jiang, Craig A Bridges, Raymond R Unocic, Krishna Chaitanya Pitike, Valentino R Cooper, Yuanpeng Zhang, De-Ye Lin and Katharine Page, Probing the Local Site Disorder and Distortion in Pyrochlore High-Entropy Oxides, J. Am. Chem. Soc. , 2020, 143 (11), 4193-4204.     Zhi Deng, Mingyang Ou, Jing Wan, Shuai Li, Yuyu Li, Yuanpeng Zhang, Zhe Deng, Jia Xu, Yuegang Qiu, Yi Liu, Chun Fang, Qing Li, Li Huang, Jinlong Zhu, Songbai Han, Jiantao Han and Yusheng Zhao, Local Structural Changes and Inductive Effects on Ion Conduction in Antiperovskite Solid Electrolytes, Chem. Mater. , 2020, 32 (20), 8827-8835.  2019    Y. P. Zhang, M. McDonnell, W. Liu and M. G. Tucker. Reverse Monte Carlo modeling for low-dimensional systems, *J. Appl. Cryst. , 2019, 52, 1035-1042.     Y. P. Zhang, M. McDonnell, S. A. Calder and M. G. Tucker. Mechanistic Insights into the SuperexchangeInteraction-Driven Negative Thermal Expansion in CuO, *J. Am. Chem. Soc. , 2019, 141, 6310-6317.     Y. P. Zhang, T. Scholz, R. Dronskowski, M. McDonnell and M. G. Tucker. Local magnetic cluster size identified by neutron total scattering in the site-diluted spin glass SnxFe4-xN (x=0. 88). Phys. Rev. B, 2019, 100, 014419.  -2019    N. R. C. Corsini, Y. P. Zhang, W. R. Little, A. Karatutlu, O. Ersoy, P. D. Haynes, C. Molteni, N. D. M. Hine, I. Hernandez, J. Gonzalez, F. Rodriguez, V. V. Brazhkin and A. Sapelkin. Pressure-induced amorphization and a new high density amorphous metallic phase in matrix-free Ge nanoparticles, *Nano Lett. , 2015, 15, 7334-7340.     A. Karatutlu, M. Song, A. P. Wheeler, O. Ersoy, W. R. Little, Y. P. Zhang, P. Puech, F. S. Boi, Z. Luklinska and A. V. Sapelkin. Synthesis and structure of free-standing germanium quantum dots and their application in live cell imaging, RSC Adv. , 2015, 5, 20566-20573.     Y. P. Zhang, W. Liu and R. Wang. From ZnS nanoparticles, nanobelts to nanotetrapods: the ethelenediamine modulated anisotropic growth of ZnS nanostructures, *Nanoscale, 2012, 4, 2394-2399.  "
    }, {
    "id": 32,
    "url": "http://localhost:4000/post_templates/sample_1/",
    "title": "Welcome to RMCprofile community",
    "body": "This is a demo post to show you how to write blog posts with markdown.  I strongly encourage you to take 5 minutes to learn how to write in markdown - it’ll teach you how to transform regular text into bold/italics/headings/tables/etc. Here is some bold text Here is a secondary heading: Here’s a useless table:       Number   Next number   Previous number         Five   Six   Four       Ten   Eleven   Nine       Seven   Eight   Six       Two   Three   One   How about a yummy crepe? It can also be centered! Here’s a code chunk:    var foo = function(x) { return(x + 5);}foo(3) And here is the same code with syntax highlighting:    var foo = function(x) { return(x + 5);}foo(3) And here is the same code yet again but with line numbers:  1234var foo = function(x) { return(x + 5);}foo(3)Boxes: You can add notification, warning and error boxes like this: Notification: Note: This is a notification box. Warning: Warning: This is a warning box. Error: Error: This is an error box. "
    }, {
    "id": 33,
    "url": "http://localhost:4000/search/",
    "title": "",
    "body": "&lt;/br&gt; {% include search-lunr. html %} "
    }, {
    "id": 34,
    "url": "http://localhost:4000/tags/",
    "title": "Tag Index",
    "body": "      {% assign date_format = site. date_format   default: “%B %-d, %Y” %}   {%- capture site_tags -%}  {%- for tag in site. tags -%}    {{- tag | first -}}{%- unless forloop. last -%},{%- endunless -%}  {%- endfor -%}{%- endcapture -%}{%- assign tags_list = site_tags | split:’,’ | sort -%} {%- for tag in tags_list -%}   {{- tag -}} ({{site. tags[tag]. size}}){%- endfor -%}  {%- for tag in tags_list -%}  &lt;h2 id= {{- tag -}}  class= linked-section &gt;         {{- tag -}} ({{site. tags[tag]. size}})  &lt;/h2&gt;  &lt;div class= post-list &gt;    {%- for post in site. tags[tag] -%}      &lt;div class= tag-entry &gt;        {{- post. title -}}        &lt;div class= entry-date &gt;										{{- post. date | date: date_format -}}, by {{ post. author }}        &lt;/div&gt;      &lt;/div&gt;    {%- endfor -%}  &lt;/div&gt;{%- endfor -%} "
    }, {
    "id": 35,
    "url": "http://localhost:4000/nav_pages/tools/",
    "title": "Tools",
    "body": "   SofQ_Calib      A tool for calibrating \(S(Q)\) against Bragg pattern.            Installation     This requires users to have conda installed on their machines, so that one can easily install this tool using the following command:      conda install -c apw247 sofq_calib             Topas4RMC      A tool for preparing Topas profiles to be used in Bragg pattern fitting in RMCProfile.            Installation     This requires users to have conda installed on their machines, so that one can easily install this tool using the following command:      conda install -c apw247 topas4rmc          "
    }, {
    "id": 36,
    "url": "http://localhost:4000/nav_pages/tutorial/",
    "title": "Tutorials",
    "body": "Videos for each of the exercises included in RMCProfile release package. Exercise-1 {% include streamablePlayer. html id=page. streamableId1 %} Exercise-2 {% include streamablePlayer. html id=page. streamableId2 %} "
    }, {
    "id": 37,
    "url": "http://localhost:4000/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ “sitemap. xml”   absolute_url }}   "
    }, {
    "id": 38,
    "url": "http://localhost:4000/2023-02-15-notes_mybb/",
    "title": "Notes on Forum Setup with MyBB",
    "body": "2023/02/15 - This post is for putting down some random sites notes as I struggle through theprocess of setting up a forum hosted with MyBB.  Here is a very nice tutorial for running through the initial installation andsetup,  In this tutorial, the necessary modules were installed and configured during thesetup. We don’t have to follow this practice. A better way may be to configureall the necessary preparations beforehand, according to the MyBB doc.    nginx configuration      For the nginx configuration, the this gist is a minimal working example on my host to host the reverse proxy for both the MyBB and JupyterHub service.            SSL setup          We need to generate a key file and use that for generating an SSL certificate file. For most SSL certificate, we need to pay. In my case, I was using ORNL service located at here (which can only be accessed from within ORNL firewall).              LDAP authentication setup      To set up the LDAP authentication, we can use the MyBB LDAP Authentication plugin [1]. The setup within MyBB admin control panel can be found here.  It should be pointed out that,            This is for configuring against the ORNL LDAP server. For other servers, the configuration should be as simple as replacing those inputs with information relevant to a other specific servers.           The protocol version does matter – typically, if we set it to 2, it won’t work, at least in my case for the configuration against the ORNL LDAP server (for which we have to set it to 3).           However, the LDAP Protocol Version setting in the admin control panel above does not seem to be working properly.  As a temporary solution, I just hard coded the setting in the {MyBB_Main_Directory}/inc/plugins/ file, which is attached here (refer to line 728-734).           Also, it seems that the Connection Confidentiality setting in the admin control panel is not working properly either. Again, temporarily, the setting was hard coded into the attached file above.           The attached file here is a minimal working example of using LDAP in PHP.           The LDAP configuration file can be found at /etc/ldap/ldap. conf,      BASE  dc=xcams,dc=ornl,dc=gov URI   ldaps://ldapx. ornl. gov TLS_CACERT   /etc/ssl/certs/ca-certificates. crt          References[1] https://community. mybb. com/mods. php?action=view&amp;pid=1043 "
    }, {
    "id": 39,
    "url": "http://localhost:4000/2022-12-30-notes_slack_msg/",
    "title": "Notes on Slack App Setup",
    "body": "2022/12/30 - To set up for sending message to Slack using Python, we can refer to Ref. [1]. Most of the instructions in the referencewould work out, with several glitches and thus necessary adjustments.   First, it should be stressed the importance of setting the proper scope when setting up the OAuth &amp; Permissions. If thescope is not set up properly, the message would not be sent successfully even the login token is configured without any problems. The instructions in Ref. [1] provides all the list of scope items that would guarantee a successful message sending.  Another tip is that the Python script containing the token cannot be exposed to public domains, e. g. , be pushed to Github repo. Once we do that, Slack API can detect the exposure and disable the API, which does make sense since exposing the token to thepublic domain is definitely not a good idea. However, this only applies to the situation when we put the token directly in thescript. If we define a system variable for the token and access the token within the script via the system variable, it should be fine.  A little glitch in the instruction in Ref. [1] is about the channel name. It seems that the channel name cannot contain the # symbol. Here follows is a working example of sending message to Slack using Python,    #!/usr/bin/env pythonfrom slack_sdk import WebClientfrom slack_sdk. errors import SlackApiErrorimport randomclient = WebClient(token= MY_TOKEN_FROM_SLACK_API )num = random. random()if num &gt;= 0. 3:  file_in =  /home/y8z/Dropbox/Documents_ORNL/Memorize/words. md else:  file_in =  /home/y8z/Dropbox/Documents_ORNL/Memorize/others. md file_read = open(file_in,  r )lines = file_read. readlines()if len(lines) &gt; 0:  to_send = []  num_to_send = min(5, len(lines))  for i in range(num_to_send):    index_tmp = random. randint(0, len(lines) - 1)    to_send. append(index_tmp)  msg_list = [lines[i] for i in to_send]  msg_body =  \n . join(msg_list)  client. chat_postMessage(channel= memorize , text=msg_body) The script will randomly grab 5 words or other memorize items from the files in which I manually populated entries from time to time. Then it willsend the randomly grabbed memorize items to my Slack channel. I set up a cron job that executes this script on a daily base so that I can deepen mymemory on those items on a daily basis.  References [1] https://plazagonzalo. medium. com/send-messages-to-slack-using-python-4b986586cb6e "
    }, {
    "id": 40,
    "url": "http://localhost:4000/2022-12-11-notes_total_commander/",
    "title": "Notes on Total Commander Setups",
    "body": "2022/12/11 - This post is a collection of notes of tips and tricks for Total Commander setups. This is a software as an alternativeto the file explorer on Windows. It allows double column management and operations, making life much easier in terms offile and directory operations.   Import/Export configuration file By default, the configuration files for TC are stored in C:\Users\USER_NAME\AppData\Roaming\GHISLER, so when reinstallingthe program, normally we don’t need to worry about the importing of previous configuration files. However, in case we need toworry about that, we can back up the configuration files under that directory and copy them to wherever suitable for the newinstallation. To get an idea about where the program is looking for those configuration files, we can go to Help -&gt; About Total Commander in TC. There, we will see the location of the setting files. Click here for the backed up zip files for the configuration.  Button definition We can define buttons under the menu items in the TC interface to get quick access to programs, files, etc. This can be done manually. Also, we cango to the installation location of TC and look for files ending with bar or BAR and we can change or add items from there. Here follows is a typicaldefinition of a button,    button40=shell32. dll,19cmd40=openbar %Commander_path%\Sysapp. bariconic40=1menu40=SystemTools The first entry specifies the icon. The second one specifies the command to execute when the button is pressed. Here in this specific example, we cansee that the command is pointing to another bar file, which will then make the current button a parent group containing a whole bunch of children buttonsdefined in the Sysapp. bar file.  Editing multiple files Alternative to the solution with F4Menu (which is discussed elsewhere as posted below), I am providing a native solution. With this configuration, we can select multiple files and press a defined key combo to edit them using the defined editor. Go to Configuration -&gt; Options. . . -&gt; Misc. -&gt; Specify a hotkey combo (like in my case, I chose Ctrl+E) under the Redefine hotkeys (Keyboard remapping) section in the right panel. Then click on the magnify glass next to the Command: input box down below. A Choose command window will pop up where we can specify the command we want to associate with the hotkey we just defined. At the bottom of the pop-up window (the Choose command window), we can click on the New. . . button, which will bring up another pop-up window where we can give the command a name (e. g. , em_notepadpp). After giving it a name, we will be lead to another window where we can put down the specific commands we want to execute. In the first box, we put in the full path to the editor executable that we want to use. In my case, I am using Notepad++ and this is my full path, C:\Program Files (x86)\Notepad++\notepad++. exe. To make sure it is working properly, we may want to include double quotation mark before and after the full path. In the second input box, we want to put %P%S as the parameter of the command - this time, we dont need any quotation mark and also we dont have space between the two parameters. Then if we want to, we can specify the icon down below but I guess this is not necessary. Then we can just select the command we just defined (e. g. , em_notepadpp) in the Choose command window and click on OK. Then we will go back to the Configuration window where we can see the defined command is already populated in the Command: input box. Clicking on the √ on the right hand side will confirm the command. Then we are done by clicking on the OK button. The same trick was posted on TC user forum – see Ref. [1].  References [1] https://www. ghisler. ch/board/viewtopic. php?t=28817 "
    }, {
    "id": 41,
    "url": "http://localhost:4000/2022-12-11-notes_gsasii/",
    "title": "Notes on GSAS-II",
    "body": "2022/12/11 - This post is a collection of notes of tips and tricks for using GSAS-II.  Multi-phase refinement When we have more than one phase in GSAS-II refinement, we should have phase fraction for each of the phases involved. With this regard,we have, suppose we have two phases, three parameters – the overall scale factor and two phase fraction factors. In this case, we cannotlet all of these three parameters to be refined since otherwise the program will by a high chance crash due to the strong correlation amongthese parameters. Instead, we should refine the scale factor together with one of the two phase fraction factors, while setting a constraintto specify that overall phase fraction should be 1. To add the constraint, we should follow the instruction in Ref. [1] (see #3 in Step-I),or here. Here it should be noticed that the phase fraction is referred to as Scale for eachphase and this Scale should not be confused with that of the overall histogram.  References [1] https://subversion. xray. aps. anl. gov/pyGSAS/Tutorials/SeqRefine/SequentialTutorial. htm "
    }, {
    "id": 42,
    "url": "http://localhost:4000/2022-11-29-notes_slurm/",
    "title": "Notes on slurm server setup",
    "body": "2022/11/29 - This post is a collection of notes of tips and tricks when trying to set up slurm server on Ubuntu 20. 04 focal.  The instructions given in Ref. [1] has been followed to set up the single-node slurm service on Ubuntu. Several things are noteworthy, as below,    Before following the instructions for the setup, we need both slurm and munge user available on the server. To set up those users, if they are not already existing, we need to follow the instruction in Ref. [2].     We can ignore step 5-8 in Ref. [1], and instead we can just use the quoted slurm configuration file below as a minimal working version,   ControlMachine=orc-irisAuthType=auth/mungeCryptoType=crypto/mungeMpiDefault=noneProctrackType=proctrack/linuxprocReturnToService=2SlurmctldPidFile=/run/slurm-llnl/slurmctld. pidSlurmctldPort=6817SlurmdPidFile=/run/slurm-llnl/slurmd. pidSlurmdPort=6818SlurmdSpoolDir=/var/lib/slurm-llnl/slurmdSlurmUser=slurmStateSaveLocation=/var/lib/slurm-llnl/slurmctldSwitchType=switch/noneTaskPlugin=task/noneInactiveLimit=0KillWait=30MinJobAge=300SlurmctldTimeout=120SlurmdTimeout=300Waittime=0SchedulerType=sched/backfillSelectType=select/cons_resSelectTypeParameters=CR_CoreAccountingStorageType=accounting_storage/noneAccountingStoreJobComment=YESClusterName=clusterJobCompType=jobcomp/noneJobAcctGatherFrequency=30JobAcctGatherType=jobacct_gather/noneSlurmctldDebug=3SlurmdDebug=3NodeName=orc-iris CPUs=64 Boards=1 SocketsPerBoard=64 CoresPerSocket=1 ThreadsPerCore=1 RealMemory=54306PartitionName=batch Nodes=orc-iris Default=YES MaxTime=INFINITE State=UP      The configuration file above should be saved as /etc/slurm-llnl/slurm. conf, but not the one mentioned in step-9 in Ref. [1].     The host name orc-iris (occurring in multiple locations) in the above quoted configuration should be replaced by whatever the host name of the server is, which can be obtained by running hostname in the terminal.     The second line from the bottom should also be replaced by relevant info to the server. The info can be obtained by running slurmd -C in the terminal. The slurmd command will become available after running step 1-4 in Ref. [1]. Also, attention to the note in Ref. [2] about the reduction of RealMemory value.  After the configurations above, when running sudo service slurmd start and sudo service slurmctld start to start the service, sometimes they may fail to start. The reason could be multifold, but specifically in my case, it was due to that the port 6818 and/or 6817 is being used. In that case, we want to run the following command to kill anything running on the relevant port, e. g. ,    sudo kill -9 `sudo lsof -t -i:6818`  Sometimes, when trying to submit jobs after the server is up running, it may show that the computing node is drained. To undrain it, we may need to follow the instruction in Ref. [3]. Also, sometimes we may see the log of the server is complaining about not being able to fine the PID file. This should not matter that much in terms of server running and jobs management.  References [1] https://signac. io/development/2020/06/26/local-SLURM-environment. html [2] https://docs. siliconcompiler. com/en/latest/tutorials/slurmsetup. html [3] https://stackoverflow. com/questions/29535118/how-to-undrain-slurm-nodes-in-drain-state "
    }, {
    "id": 43,
    "url": "http://localhost:4000/2022-11-26-notes_jupyterhub/",
    "title": "Notes on Jupyterhub server setup",
    "body": "2022/11/26 - This post is a collection of notes of tips and tricks when trying to set up Jupyterhub server on Ubuntu 20. 04 focal, together with the installation of various kernels and extensions.  The instructions in Ref. [1] had been followed to set up the Jupyterhub server. The server was set up in a virtual environment located at /opt/jupyterhub and therefore all the python, jupyter, etc. relevant executables belongs to this virtual environment. This means that every time we need to execute one of those executables to install, e. g. , a kernel, or a jupyter server relevant executables (e. g. , ipykernel, jupyter_server, etc. ), we need to explicitly refer to this virtual environment where the server resides. Here follows is a random collection of issues that I came across when trying to set up the server and running various kernels and capabilities. Sometimes, improper combination of server executables may prevent certain services/capabilities from functioning properly.  N. B. The issues listed here follows are not following a logic order.  Issue-1: jQuery path not found, or something very similar. Solution: This issue may be due to the version of jupyterlab_server – too new a version may cause this issue, especially when trying to refresh the page. As of writing, it seems the version of 2. 10. 0 of jupyterlab_server is working properly. Here follows is a list of currently properly working versions of packages (which can be obtained via executing /opt/jupyterhub/bin/jupyter --version),—IPython     : 8. 6. 0ipykernel    : 6. 17. 1ipywidgets    : 8. 0. 2jupyter_client  : 7. 4. 4jupyter_core   : 4. 11. 2jupyter_server  : 1. 23. 1jupyterlab    : 3. 5. 0nbclient     : 0. 7. 0nbconvert    : 7. 2. 4nbformat     : 5. 7. 0notebook     : 6. 5. 2qtconsole    : not installedtraitlets    : 5. 5. 0—  Issue-2: plotly figure is not showing up. Solution: This again is something to do with the package version that is being installed. ipywidgets version 8. 0. 2 was found not to be working with plotly interactive plot. The version 7. 7. 2 should be working, which can be installed via [2],sudo /opt/jupyterhub/bin/python3 -m pip install ipywidgets==7. 7. 2  Issue-3: Jupyter server fails to build, when executing sudo /opt/jupyterhub/bin/jupyter lab build Solution-1: Sometimes it may be due to some problematic extension that was installed. In this case, we want to use either pip or conda to uninstall or remove the extension that was causing the problem (refer to the log file of the build that will be printed out on terminal). Meanwhile, we also need to uninstall the extension that was installed via the jupyter labextension command (if it has ever been installed in this way). Also, it seems that the un-installation of the extension should be after the un-installation of the module with pip or conda. In the case of the ipysheet extension, here follows may be the step to follow for the un-installation,1. sudo /opt/jupyterhub/bin/python3 -m pip uninstall ipysheetorsudo /opt/conda/bin/conda remove -p /opt/conda/envs/python ipysheet2. sudo /opt/jupyterhub/bin/jupyter labextension uninstall ipysheetSolution-2: Sometimes it could be due to low memory issue, i. e. , the system resource is not enough for building the jupyterlab server. In such a situation, following the prompt on the command line usually does not help. Specifically for Google cloud service, the advantage is that we can freely change the size of our instance allocation. So we can increase the size temporarily and build the jupyterlab server. After that, we can then change the size back to the smaller value as before just to save money – we will be billed based on the actual use of resource, which is very nice! Alternatively, the following command could also be used to build jupyter server to get around with the memory issue, sometimes,sudo /opt/jupyterhub/bin/jupyter lab build --dev-build=False --minimize=FalseTo get a sort of permanent solution to this issue (i. e. , without the need toappend --dev-build=False --minimize=False flags to the build command), we canedit the jupyter_config. py file under /opt/jupyterhub/etc/jupyter (createthe file if it does not exist under the directory). The directory can beobtained via the command /opt/jupyterhub/bin/jupyter --path.  Issue-4: Installation of xeus-cling kernel for C++ Solution: For installing xeus-cling kernel for C++, we need to use mamba, following the steps below,1. Follow the instruction in Ref. [3] to install mamba - we need to use the manual way of installation, i. e. using the curl command. Then we want to copy the micromamba binary to a central location, e. g. , /opt/jupyterhub/bin. N. B.  This is the directory that has been used for hosting the central jupyterhub server and I just put mamba executable there as well just to stay self-consistent. This may not be necessary. 2. mamba shell init --shell=bash --prefix=~/. micromambaN. B.  This guarantees that all envs and mamba stuff will be installed to the specified prefix directory. 3. source . bashrcN. B.  This is to make sure that the above added mamba initialization in our bash configuration file is taking effect. 4. Create the cling env, via mamba create -n cling. N. B.  To remove an env, we need mamba env remove -n cling. 5. mamba install xeus-cling -c conda-forge --prefix=~/. micromamba6. The command above will create jupyter kernel under $PREFIX/share/jupyter/kernels, or on some machines, the kernels may be found in some other places, like $PREFIX//cling/share/jupyter/kernels. To let our jupyterhub server see our kernels, we need to manually copy the available kernels to the proper directory (where jupyterhub can find). In my case, the target directory is /opt/jupyterhub/share/jupyter/kernels/.  Issue-5: List of kernels is not complete Solution: Sometimes when listing out all kernels using jupyter kernelspec list, itcould happen that not all kernels are listed out. That could be because we were using the wrong jupyter. For example, if there a version of jupyter installed at /usr/bin/jupyter, it will always win over other jupyter versions. If it happens that we follow certain instructions to install the jupyterhub server into other places (e. g. , Ref. [1]), then we will not see all kernels available on our machine by jupyter ernelspec list. In such a situation, we have to explicitly give the full path to the jupyter installed in a certain location (where we installed the jupyterhub server). In my case, the full path is /opt/jupyterhub/bin/jupyter.  Issue-6: Installation of Juka kernel Solution: To install the juka kernel, for sure, initially, we need to install Juka - see Ref. [4]. Then execute sudo /opt/jupyterhub/bin/pip install juka-kernel, followed by sudo /opt/jupyterhub/bin/python -m juka-kernel. install. Finally, we need to go to the juka_kernel installation location (e. g. /opt/jupyterhub/lib/python3. 8/site-packages/juka/) and execute, /opt/jupyterhub/bin/python install. py --user.  Issue-7: Installation of SSH kernel Solution: When installing the SSH kernel following the instruction in Ref. [5], by default, the kernel is installed into /root/. local/share/jupyter/kernels/ssh. It seems that Jupyter has difficulty in finding the installed kernel in the location above. So, we may need to manually copy the whole directory above to our local area, such as ~/. local/share/jupyter/kernels/ssh. A restart of theserver is needed to be able to see the copied kernel.  Issue-8: Installation of C kernel Solution: When installing the C kernel following Ref. [6], the execution of the kernel installation command may require sudo privilege,in which case the kernel will be installed to the root directory (i. e. /root/. local/share/jupyter/kernels/c). In that case, we then need to  manually copy the directory c to our local area, i. e. , $HOME/. local/share/jupyter/kernels/c.  Issue-9: Installation of Fortran kernel Solution-1: For installing the Coarray Fotran kernel, we can following Ref. [7]. One of the prerequisite package for installing this kernel is opencoarrays. For the installation of this package, if we are on Ubuntu higher than 18. 04, we may need to follow the instruction in Ref. [8] to install it manually. Solution-2: If the Coarrays Fortran kernel fails to execute any commands (complaining about libraries issues),try to execute the followings commands,—$ sudo cp /usr/lib/x86_64-linux-gnu/open-coarrays/mpich/lib/* /usr/lib/x86_64-linux-gnu/$ sudo cp /usr/lib/x86_64-linux-gnu/open-coarrays/openmpi/lib/* /usr/lib/x86_64-linux-gnu/$ cd /usr/lib/x86_64-linux-gnu/$ sudo ln -s libmpi_usempif08. so. 40 libmpi_usempif08. so$ sudo ln -s libmpi_usempi_ignore_tkr. so. 40 libmpi_usempi_ignore_tkr. so$ sudo ln -s libmpi_mpifh. so. 40 libmpi_mpifh. so$ sudo ln -s libmpi_mpifh. so. 40 libmpi_mpifh. so$ sudo ln -s libmpi. so. 40 libmpi. so$ sudo ln -s libopen-rte. so. 40 libopen-rte. so$ sudo ln -s libopen-pal. so. 40 libopen-pal. so$ sudo ln -s libevent-2. 1. so. 7 libevent. so$ sudo ln -s libevent_pthreads-2. 1. so. 7 libevent_pthreads. so$ sudo ln -s libhwloc. so. 15 libhwloc. so$ sudo mkdir -p /usr/include/OpenCoarrays-2. 0. 0-rc1_GNU-7. 3. 0$ sudo mkdir -p /usr/lib/x86_64-linux-gnu/openmpi/include—  Issue-10: conda environment as jupyter kernel Solution: When following Ref. [1] to install the jupyterhub server, a conda environment was set up to become a kernel environment. In the future if we want to install packages to that environment to make certain modules available in that kernel, we need to use the conda --prefix flag to specify the full path to the conda environment where we are going to install certain modules. A typical command would be,sudo /home/cloud/. conda/envs/mantid-developer/bin/python -m ipykernel install --prefix=/opt/jupyterhub/ --name 'mantid-developer' --display-name  Mantid Using the command above, the local conda environment located at /home/cloud/. conda/envs/mantid-developer will be registered as a jupyter kernel. The kernel will be installed into /opt/jupyterhub/share/jupyter/kernels/mantid-developer.  Issue-11: Installation of Lua kernel Solution: The Lua kernel can be easily installed following Ref. [9], in which the iLua kernel will be installed. Also, one needs to install lua separately to make the lua command system-wide available.  Issue-12: Installation of diffpy-cmi &amp; mpdf kernel Solution: To install diffpy, diffpy-CMI and mpdf packages into a single conda environment and make it available in a dedicated kernel, follow the steps below,—$ sudo /opt/conda/bin/conda create –prefix /opt/conda/envs/diffpy python=3. 7 ipykernel$ sudo /opt/conda/envs/diffpy/bin/python -m ipykernel install –prefix=/opt/jupyterhub/ –name ‘diffpy’ –display-name “Python (diffpy)”$ sudo /opt/conda/bin/conda install -p /opt/conda/envs/diffpy -c diffpy diffpy-cmi$ git clone https://github. com/FrandsenGroup/diffpy. mpdf. git$ mv diffpy. mpdf ~/. diffpy. mpdf &amp;&amp; cd ~/. diffpy. mpdf$ sudo /opt/conda/envs/diffpy/bin/python setup. py install—  Issue-13: Installation of sagemath kernel Solution: To install the sagemath kernel, we need to follow the instructions below,—Step-1: Ref. [10]Step-2: Ref. [11]—  Issue-14: Installation of the jupyter language server Solution: Follow the instruction in Ref. [12] for installation and refer to Ref. [13] for configuration of the service.  Issue-15: Code format Solution: Jupyterlab code format needs black to be installed. Refer to Ref. [14] for more details.  Issue-16: Execution of commands in cell within Jupyter server takes forever Solution: Sometimes a kernel may be launched successfully, but when trying to execute some commands within jupyterlab, it might fail. In this case, we can take a look at the kernel specification file (the JSON file) and see whether it is a problem with the improper command being executed when launching the kernel. Here follows is an example with the scilab kernel. 1. First, we can list out all the available kernels and get an idea about where the corresponding kernel file is located,/opt/jupyterhub/bin/jupyter kernelspec listN. B.  In the case of scilab, the kernel file is here,/opt/jupyterhub/share/jupyter/kernels/scilab2. Then cd into the kernel directory identified above and edit the kernel. json file. In the case of scilab, the default kernel file reads,     {     argv : [ python ,         -m ,  scilab_kernel ,         -f ,  {connection_file} ],     display_name :  Scilab ,     language :  scilab ,     mimetype :  text/x-octave ,     name :  scilab   } 3. Then we know that the actual command being executed at each time of the kernel launching is the system-wise version of python. In my case, this will fail, since we need the version of python corresponding to our Jupyterhub server, which is located at /opt/jupyterhub/bin/python. So, we need to change the kernel. json file to be like this,     {     argv : [ /opt/jupyterhub/bin/python ,         -m ,  scilab_kernel ,         -f ,  {connection_file} ],     display_name :  Scilab ,     language :  scilab ,     mimetype :  text/x-octave ,     name :  scilab   }   Issue-17: scilab kernel log file Solution: By default, running the scilab kernel will create a test. log file under home directory. To avoid this behavior, we can edit the corresponding kernel. py file and comment out relevant lines – line 97-98 in /opt/jupyterhub/lib/python3. 8/site-packages/scilab_kernel/kernel. py, i. e. , the following two lines,     with open(os. path. expanduser('~/test. log'), 'w') as fid:   fid. write('executable: ' + executable)   Issue-18: wolfram kernel documentation file location Solution: By default, the installed wolfram player kernel will use the home directory as the user documentation directory (which can be printed out within either jupyterlab cell execution or from within wolframscript CLI, by executing $UserDocumentsDirectory). This will create a Wolfram Player folder at each time when launching the kernel. To move this directory to another location, we need [15],1. xdg-user-dirs-update --set DOCUMENTS /home/cloud/. wolfram_doc (from command line)N. B. The directory specified at the end of the command can be anywhere we would like it to be. 2. Rebuild jupyterhub, by running sudo /opt/jupyterhub/bin/jupyter lab build. 3. Restart jupyterhub service, by running sudo systemctl restart jupyterhub  Issue-19: go kernel creates a go folder under home directory Solution: By default, the go kernel will use the go directory under home directory as the main working directory and therefore $HOME/go directory has to be there. To move the go directory to another location (e. g. , $HOME/. go), we may want to put the following line in our . bashrc and . bash_profile file, export GOPATH=$HOME/. go and edit the go kernel JSON file to,     {     argv : [       /home/cloud/. go/bin/gophernotes ,       {connection_file}     ],     display_name :  Go ,     language :  go ,     name :  go   } N. B. The location of kernel. json to be edited is, /home/cloud/. local/share/jupyter/kernels/gophernotes/kernel. json.  Issue-20: R kernel creates an R folder under home directory Solution: When following the instructions in Ref. [16] to install the IRkernel for R, the installed relevant R packages will be put under $HOME/R directory. Those installed packages can actually be moved to the default package installation location of R, e. g. , /usr/lib/R/library so that the R folder under home directory can be removed. To do that, we can execute, sudo cp -av $HOME/R/x86_64-pc-linux-gnu-library/3. 6/* /usr/lib/R/library/.   Issue-21: Installation of jupyterlab-latex extension Solution: To make sure the extension works properly, we need to installxelatex first. Refer to Ref. [17] for information about the installation ofxelatex.   Issue-22: Issue with multiline editing Solution: Sometimes we may find that using Alt + left mouse dragging isnot able to perform the multiline editing (i. e. , vertical selection). In thiscase, we can go to the settings and search for code jump and we will be ableto see Modifier key in the settings. We can try to change it to AltGraph –quite often it is defaulted to Alt key which will then make the multilineediting fail (the cursor will change shape but not functioning). This tip can befound in Ref. [18], where it is suggested to change this key to Control. However, it seems that changing it to Control will disable the multi-cursorediting (i. e. , Control + left click on multiple locations). Finally, it seemsthat changing it to AltGraph will enable both functionalities. N. B. Changing it to Shift would then diable the Shift + Left Click forblock selection.   Issue-23: Installation of SoS for working with multiple kernels in one notebook in a convenient manner Solution: SoS notebook is actually a jupyter kernel that allows up toselect different sub-kernels inside the notebook. So that if we want to runmultiple kernels in a single notebook without the necessity to changing kernelsmanually, this is the tool for us. Also, it has the capability to sharevariables in between kernels so it is not simply a kernel selection tool butinstead has the interactability between different kernels. To install this tool,we can refer to Ref. [19] which contains very detailed step-by-step instructions. One little issue we should notice is that during the installation, there is astep to execute python -m sos_notebook. install. At this stage, it may complainabout not being able to find the jupyter-contrib-core module. In this case, wecan use pip install jupyter-contrib-core [20] to install the module and rerun thestep and it should work. N. B. We should prepend the two commands mentioned with the full path ofthe executables, just like what we have been doing across the whole note here,/opt/jupyterhub/bin/.   Issue-24: Jupyter on Windows – 1 Solution: With my local Windows jupyter server, for some reason, itfails to load the jupyter_ntoebook_config. py configuration file which sets upthe port, password, etc. Not sure why but suspect this could be due to thepackage version issue – some of the packages might be updated or downgradedunintentionally during installing some packages. The workaround is to directlyspecify the port number when launching the jupyter lab server, by jupyter lab--no-browser --port 8000. For password setup (once for all), we can run thecommand jupyter lab password followed by inputting the password twice. Aconfiguration file containing the password will be saved to the config folder,which will be discussed in next issue. N. B. A bit of Googling seems to suggest that the jupyter labconfiguration file is jupyter_lab_config. py which can be generated byjupyter-lab --generate-config. Not sure why previously using jupyter_ntoebook_config. py just worked out.   Issue-25: Jupyter on Windows – 2 The configuration file is usually located in the . jupyter under user’s home directory. To obtain the location where the configuration file is stored, we can run jupyter --config-dir.   Issue-26: Jupyter on Windows – 3 Solution: To make the jupyter server an automatically loaded service when the machine starts, we can create a startup VBS script to launch the server. This may not be the optimal way, but it should work for the personal use. Here follows is attached the VBS script, for which we can make a shortcut, and we can put the shortcut into the startup folder (Start + R to launch the Run box, and type shell:startup to bring up the startup folder),    Set shell = CreateObject( WScript. Shell )shell. CurrentDirectory =  C:\Users\yuanp\OneDrive\One_Documents\JupyterLab shell. Run  cmd /c jupyter lab --no-browser --port 8000 --ip 0. 0. 0. 0 , 0, false By doing this, we can then access the server via localhost:8000 (or via the internet if the port forwarding is configured properly) at any time after the machine starts, without the need to start up the server manually. N. B. The second line here specifies the working directory. The ‘–ip 0. 0. 0. 0’ flag tells the server to accept connections from the internet but not only the local host. The 0, false flag tells the script not to keep the terminal running after launching the server.   Issue-27: Console Log for ipywidgets debug Solution: When developing ipywidgets interface in Jupyterlab, sometime we will find that the widgets interface is not functioning as expected but there is no error message printed out. To get a knowledge about the error message in case of any for debugging purpose, we need to enable the console log view in Jupyterlab. To do that, we need to go to View (\rightarrow) Show Console Log from the menu and then at the bottom of the page, we should be able to see all the console logs.   Issue-28: matplotlib and plotly interactive plot Solution: When there are some issues with either %matplotlib widget orsome javascript error in showing the interactive plot or widgets, it could besomething to do with the version of ipywidgets installed. Try the followingsteps,    sudo /opt/conda/envs/python/bin/pip uninstall ipywidgetssudo /opt/conda/envs/python/bin/pip install ipywidgets It seems that installing the version of 8. 0. 4 for ipywidgets does solve theissue. As a side note, on my local jupyter server on a Windows machine, I foundonly the version of 7. 6. 5 for ipywidgets will work.   Issue-29: Installation of Mantid kernel Solution: First, we need to follow the instruction in Ref. [21] to installthe conda environment for Mantid. After setting up the conda environment, weneed to run the following command to add a certain build of Mantid into theconda environment path so that the corresponding version of python can findall Mantid relevant modules,    conda activate mantid-developerpython MANTID_REPO_DIR/build/bin/AddPythonPath. py where MANTID_REPO_DIR refers to the full path of the mantid repo directoryand we are assuming that the conda environment for Mantid is called mantid-developer. Then we can refer to the instruction presented in Issue-10 above to registerthe corresponding conda environment as a kernel of Jupyter.  References [1] https://jupyterhub. readthedocs. io/en/1. 2. 1/installation-guide-hard. html [2] https://github. com/jupyterlab/jupyterlab/issues/12977 [3] https://mamba. readthedocs. io/en/latest/installation. html#linux-and-macos [4] https://jukalang. com/download [5] https://github. com/NII-cloud-operation/sshkernel [6] https://github. com/brendan-rius/jupyter-c-kernel [7] https://github. com/sourceryinstitute/jupyter-CAF-kernel [8] https://askubuntu. com/questions/1277932/cannot-install-open-coarrays-bin-for-gfortran-on-ubuntu-20-04 [9] https://github. com/guysv/ilua [10] https://sagemanifolds. obspm. fr/install_ubuntu. html [11] https://doc. sagemath. org/html/en/installation/launching. html#setting-up-sagemath-as-a-jupyter-kernel-in-an-existing-jupyter-notebook-or-jupyterlab-installation [12] https://jupyterlab-lsp. readthedocs. io/en/latest/Installation. html#please-read-this-first [13] https://github. com/jupyter-lsp/jupyterlab-lsp#other-configuration-methods [14] https://black. readthedocs. io/en/stable/getting_started. html [15] https://mathematica. stackexchange. com/questions/89369/prevent-10-2-from-creating-wolfram-mathematica-directory-on-linux [16] https://irkernel. github. io/installation/ [17] https://tex. stackexchange. com/questions/179778/xelatex-under-ubuntu [18] https://stackoverflow. com/questions/49988636/multi-cursor-editing-in-jupyter-lab [19] https://vatlab. github. io/sos-docs/running. html#content [20] https://pypi. org/project/jupyter-contrib-core/ [21] https://developer. mantidproject. org/GettingStarted/GettingStartedCondaLinux. html#gettingstartedcondalinux "
    }, {
    "id": 44,
    "url": "http://localhost:4000/2022-10-30-twin_paradox/",
    "title": "Notes on twin paradox",
    "body": "2022/10/30 - This post is my notes for reading an online article published on Scientific American about resolving the twin paradox purely in the special relativity framework. Refer to Ref. [1, 2] for the original article. In the article, the Lorentz transformation relation was applied to the whole process corresponding to the traveler launching from the earth to landing back to the earth. The final conclusion is both the homebody and traveler agree that their clock reading is different – the traveler is younger than the homebody. The discussion was divided into two sections - the traveler traveling towards to the remote star and the traveler traveling back from the remote star to the earth. However, the fundamental rationale that resolves the twin paradox is actually not the way being used to do the calculation. As pointed out in the article, it is the asymmetry between the homebody and the traveler that makes the reading of their clocks are meant to be different. In another word, the statement that the homebody can be thought of as being traveling relative to the traveler and therefore the homebody can also be rationalized to be younger than the traveler following exactly the same logic actually does not stand at all. At this point, we may need some clarification, based on the discussion presented in the article. First, as mentioned earlier, although the calculation can be done in two sections (which is sort of tedious), the end result is very easy to obtain. Taking the homebody as the reference, we can easily use either length contraction or time dilation to arrive at the conclusion that the traveler will be younger than the homebody. It is just that the article provides a more straightforward picture to view this whole process. Second, in the article, it was mentioned two types of asymmetry. From my understanding, it is actually only the second asymmetry that really matters. The first asymmetry says that the traveler is really traveling, i. e. , his position is really changing from one place (the earth) to another (the remote star) but that is not the case for the homebody who has been always staying on the earth without moving at all. However, since we know that according to relativity theory, there does not exist any absolutely static reference. Then we can say that both the traveler, the homebody, and the remote star are all traveling relative to another third-party reference. Then the traveling of the traveler just makes himself stay still in the third-party reference. In this case, it is actually the homebody who is really traveling and therefore if really it is the first asymmetry mentioned in the article that resolves the paradox, the logic is not self-explaining. The second asymmetry is therefore what I think as the fundamental asymmetry that resolves the asymmetry. Although, we can have the imagined third-party reference as mentioned here, it is always that case that it is the traveler meets the remote star (i. e. , they are in the same location at the same time) that defines the event-3 (see the original article for details). Therefore, the two brothers can only agree upon the clock reading of the traveler but not vice versa.  References [1] https://www. scientificamerican. com/article/how-does-relativity-theor/ [2] Evernote clip for the original article in Ref. [1] "
    }, {
    "id": 45,
    "url": "http://localhost:4000/2022-10-25-notes_mag_IV/",
    "title": "Notes on magnetism - IV",
    "body": "2022/10/25 - In this post, some basics about the stray and demagnetization field will be covered. The post originates from reading the book by Stöhr – Ref. [1]. Figure. 1. Demonstration of materials magnetization – reproduced from Fig. 2. 6 in Ref. [1]. To get an idea about the stray and demagnetization field, one needs to go back to the Stoke’s theorem, [\oint \vec{H} \cdot d\vec{l} = \iint_S (\nabla \times \vec{H})_n dS] The integrand on the right hand side is the current density, according to, [\nabla \times \vec{H} = \vec{j}] In the case of no current flow, we have (\vec{j} = 0) and therefore we should accordingly have the left hand side being 0 as well. There then comes the requirement that we have the magnetic field inside and outside of the material being opposite to each other – inside the material, we have the demagnetization field (since it is opposite to the external magnetic field and therefore is trying to cancel it out) and outside the material, we have the stray field.  To get an idea about the relation between magnetization field inside the material and the magnetic field, one then needs to turn to the Gauss’s theorem, [\iint_S \vec{B} \cdot \vec{n} dS = \iiint_V \nabla \cdot \vec{B} dV] Since we don’t have magnetic monopole, we should have the left hand side of the equation being 0, which then indicates (\nabla \cdot \vec{B} = 0). Figure. 2. Demonstration of materials magnetization – reproduced from Fig. 2. 7 in Ref. [1]. Combined with the relation between magnetic induction field, magnetic field and magnetization field, [\vec{B} = \mu_0\vec{H} + \vec{M}] we then have, [\mu_0\nabla \cdot \vec{H} = -\nabla \cdot \vec{M}] Mathematically, it is just a matter of reorganization of expression. However, physically, it infers a clear picture as presented in Fig. 2 – outside the material, it is just the stray field and inside the material, the end result of the interaction between the magnetic induction ((\vec{B})) and the demagnetization ((\vec{H}_d)) field is the magnetization field ((\vec{M})). Furthermore, we can imagine positive and negative magnetic ‘charge’ on the surface of the material, just like what we would have for electric field – though, in practice, we know that the magnetic ‘charge’ does not even exist. According to the equation above, we can say that the ‘positive charge’ on the right hand side of Fig. 2 is the source of the external stray field and is the sink of the internal magnetization field, and vice versa for the ‘negative charge’ on the left hand side. N. B. In the equation above, when we say (\vec{H}), we mean both (\vec{H}_d) inside the material and (\vec{H}_s) outside the material.  References [1] J. Stohr and H. C. Siegmann. Magnetism - from fundamentals to nanoscale dynamics. Springer. 2006. New York. "
    }, {
    "id": 46,
    "url": "http://localhost:4000/2022-10-13-css_javascript_img_effect/",
    "title": "Image effect in web page",
    "body": "2022/10/13 - In the index page of current blog, we have a picture shown as below - if we hover the mouse over the image, it will change to another picture and also as we move our mouse, the image will tilt along with the mouse moving.       &lt;h1&gt;Spallation Neutron Source&lt;/h1&gt;      &lt;h1&gt;Oak Ridge National Laboratory&lt;/h1&gt;   The codes for displaying the effect above is presented below,    &lt;div align='center' class='card' data-tilt data-tilt-scale= 0. 9 &gt;&lt;img src= /assets/img/ORNL. png   alt= SNS   title= SNS  /&gt;  &lt;img src= /assets/img/SNS. jpg  class= img-top  alt= ORNL &gt;&lt;div class= centered-text &gt;&lt;h1&gt;Spallation Neutron Source&lt;/h1&gt;&lt;/div&gt;&lt;div class= centered-text-1 &gt;&lt;h1&gt;Oak Ridge National Laboratory&lt;/h1&gt;&lt;/div&gt;&lt;/div&gt;&lt;script src= https://cdnjs. cloudflare. com/ajax/libs/vanilla-tilt/1. 7. 2/vanilla-tilt. min. js &gt;&lt;/script&gt; Here is its implementation in the index. md file for current blog, Click Me! Accordingly, the CSS configuration relevant to such an image effect is shown below,  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788. card {  position: relative;  display: inline-block;  border: none;  display: flex;  flex-direction: solumn;  align-items: center;  justify-content: center;  color: #fff;  transform-style: preserve-3d;  transform: perspective(1000px);}. card . img-top {  display: none;  position: absolute;  top: 0;  left: 0;  z-index: 99;}. card:hover . img-top {  display: inline;}@media screen and (min-width: 500px) {  . card . centered-text {    display: none;    position: absolute;    top: 5%;    left: 27%;    transform: translateZ(50px);    z-index: 99;  }  . card:hover . centered-text {    display: inline;  }  . card . centered-text-1 {  display: none;  position: absolute;  top: 18%;  left: 23%;  transform: translateZ(50px);     z-index: 99;  }  . card:hover . centered-text-1 {    display: inline;  }  h1 {    font-size: 35px;  }}@media screen and (max-width: 500px) {  . card . centered-text {    display: none;    position: absolute;    top: 5%;    left: 35%;    transform: translateZ(50px);    z-index: 99;  }  . card:hover . centered-text {    display: inline;  }  . card . centered-text-1 {    display: none;    position: absolute;    top: 18%;    left: 32%;    transform: translateZ(50px);    z-index: 99;  }  . card:hover . centered-text-1 {    display: inline;  }  h1 {    font-size: 10px;  }}Here, to realize the tilting effect, we rely on the vanilla-tilt Javascript. The actual code is just the last line in the HTNL code snippet presented above. Detailed information about this library can be found here. Apart from that sinle line of code, we then need to put data-tilt in the HTML &lt;div&gt; section that contains the image we want to tilt (see the first line in the HTML code snippet above). We can realize that the text and the image is tilted differently so that it seems they are not on the same layer. That effect is realized by referring to the Creating a parallax effect section of this website. From the website instruction, we will see that this requires some special CSS configuration, which, in our case of current blog implementation, can be found here and here. To realize the showing and hiding effect for both the image and text on mouse hovering, we will rely on the definition of a parent CSS class card and its children class img-top, as presented in the CSS snippet above. Then another definition to account for the mouse hovering effect should be defined - see the . card:hover img-top presented above. Then we know that when mouse is not hovering, the image associated with the img-top class will not be shown (display: none). When mouse hovers on the default image, display: inline will then bring up the image associated with the img-top class on top of the default image. N. B. The @media screen and (min-width: 500px) section in the CSS snippet above is enabled for browser with the width of at least 500px and @media screen and (max-width: 500px) is for browser with the width of at most 500px. This is the so-called media query to display in different manner for different browsers to realize the optimal display effect on various platforms (computer, ipad, or phone). "
    }, {
    "id": 47,
    "url": "http://localhost:4000/2022-10-09-jekyll_maths/",
    "title": "Math equation in Jekyll",
    "body": "2022/10/09 -  To enable the display of math equations in GitHub pages, we need to include the corresponding Javascript in our page header. Taking my current blog as an example (one can go to MORE LINKS (\rightarrow) BLOG REPO to visit the GitHub repo for current blog), in the header part of each post, it is specified the layout is post. We then can find post. html in the _layouts directory which includes the definition for the outlook of a post. There, in the header part, one can find it is further pointing to the base layout which then refers to the base. html file under _layouts. Opening the base. html file, we can find that it includes the head. html file (which fundamentally defines the &lt;header&gt; section in the rendered HTML file). The head. html file can be found under _includes directory. We then need to include the following codes in the head. html file,    &lt;script type= text/javascript  async src= https://cdn. mathjax. org/mathjax/latest/MathJax. js?config=TeX-MML-AM_CHTML &gt;&lt;/script&gt; Then for both inline and display equation, we can just use ‘$$’ symbol to claim an equation environment to write out equations. "
    }, {
    "id": 48,
    "url": "http://localhost:4000/2022-10-09-jekyll_code_snippet_copy/",
    "title": "Copy of code snippet in Jekyll",
    "body": "2022/10/09 -  Trying to follow several resources [1, 2] for setting up the code snippet copy capability in Jekyll site, but for some reason, I could not get it working. I suppose this may be something to do with theme I am using (the beautiful-jekyll theme), and I am not what to tune to make it working with the code snippet copy function posted by others (see Ref. [1, 2]). Instead of struggling with those minor tunes, I am using a separate routine for such a purpose, without any involvement with CSS styling, etc. To enable the code snippet copy in GitHub pages using my current way, we need to include the corresponding Javascript in our page header. Taking my current blog as an example (one can go to MORE LINKS (\rightarrow) BLOG REPO to visit the GitHub repo for current blog), in the header part of each post, it is specified the layout is post. We then can find post. html in the _layouts directory which includes the definition for the outlook of a post. There, in the header part, one can find it is further pointing to the base layout which then refers to the base. html file under _layouts. Opening the base. html file, we can find that it includes the head. html file (which fundamentally defines the &lt;header&gt; section in the rendered HTML file). The head. html file can be found under _includes directory. First, we need to put the following Javascript codes into the &lt;header&gt; section of the head. html file,  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 910111213141516171819202122232425&lt;script async=&#39;async&#39; src=&#39;https://www. gstatic. com/external_hosted/clipboardjs/clipboard. min. js&#39;&gt;&lt;/script&gt;&lt;script src=&#39;https://unpkg. com/sweetalert@2. 1. 2/dist/sweetalert. min. js&#39;&gt;&lt;/script&gt;&lt;script language=&#39;JavaScript&#39;&gt; function copytoclipboard(containerid){  if (document. selection) {   var range = document. body. createTextRange();   range. moveToElementText(document. getElementById(containerid));   range. select(). createTextRange();   document. execCommand(&quot;copy&quot;);  } else if (window. getSelection) {   var range = document. createRange();   range. selectNode(document. getElementById(containerid));   var selection = window. getSelection() // get Selection object from currently user selected text   selection. removeAllRanges() // unselect any user selected text (if any)   selection. addRange(range) // add range to Selection object to select it   document. execCommand(&quot;copy&quot;);   //alert(&quot;Codes snippet copied to clipboard!&quot;)   swal({   title: &quot;&quot;,   text: &quot;Codes snippet copied to clipboard!&quot;,   icon: &quot;success&quot;,   });  } }&lt;/script&gt;Here is where I put those lines in the head. html file, Click Me. Then, as what I have above in current blog, we need to put down a button to link to the copytoclipboard function defined in the Javascript we just included. Here follows is the code for the button, which we can directly grab and put into our blog post (see here for the implementation in current blog)  Copy snippet to clipboard!  123&lt;div align=&quot;right&quot;&gt;&lt;button onclick=&quot;javascript:copytoclipboard(&#39;csp2&#39;)&quot; style=&quot;border: none&quot;&gt;Copy snippet to clipboard!&lt;/button&gt;&lt;/div&gt;Then, we need to go to the hilite. me website, where we can paste in our code snippet and the website will help us turning that into HTML codes with language specific grammar highlighting. From there, we can then copy those HTML codes and directly paste them into our blog post, like what I have here for the current blog (the first Javascript code snippet above). Finally, to link the copytoclipboard function associated with a certain button to copy a specific block of codes, we need to add in a unique ID into the pasted HTML codes from hilite. me, like what I have here for the current blog (again, the first Javascript code snippet above). Then the function parameter for copytoclipboard needs to be consistent with the code block that we want to copy by clicking on the button - see here, again, for the the first Javascript code snippet above.  N. B. The ID for the pasted code from hilite. me should go to EXACTLY the &lt;td&gt; section as presented in the link here.  N. B. Those pasted HTML from hilite. me was changed a bit across all posts in my blog to remove the padding space of the code block - specifically it is this bit padding:. 0em . 0em; in here. "
    }, {
    "id": 49,
    "url": "http://localhost:4000/2022-06-20-iso_subg/",
    "title": "Notes On Isotropy Subgroup",
    "body": "2022/06/20 - Figure. 1. Isotropy subgroup [1].  This blog contains some key notes for reading the lecture notes by H. Stokes, et al. [1] on isotropy subgroup. Details about the lecture notes will not be reproduced here and instead we will just put down some key understanding as below, Two subspaces are equivalent if the basis vectors for each can be set up in such a way that they are associated with the same representation. The reason why the two subspaces are equivalent is that it is actually the linear combination coefficients that appear in front of the basis vectors that determines how the symmetry is lowered. Even though the basis vectors of the two subspaces may be very different, the same linear combination of basis vectors still lead to the same variation of symmetry, e. g. , lowering the space group from (G) to its subgroup (G’). This might be the reason why subgroups associated with vectors in parameter space are called isotropy subgroup – atomic distortions in the two equivalent subspaces could be very different in 3D space (i. e. , isotropic) but they both lead to the same symmetry lowering from (G) to (G’). In group theory, there are many ways of separating out group elements into different parts, like cosets. One of the ways is that the separated-out parts themselves can be regarded as a single group element, in which case we say the original group is mapped onto another group the elements of which is actually a group of elements instead of single operations. In such a situation, for sure there should be a certain group of elements that are mapped to the identify element in the new group i. e. , all the group elements involved are mapped to the identity element (of the new group). Representation is a certain type of mapping – it maps group elements in the original group to certain matrices in the new group (of matrices which are now the specific form of operations). Then in the context of isotropy subgroup, if a certain isotropy subgroup is mapped to the identity matrix by a certain irreducible representation (IR), that isotropy subgroup is called the kernel of the IR. This further means all vectors in the representation space is invariant under the operation of any elements in that isotropy subgroup (the kernel of the IR).  References [1] https://1drv. ms/b/s!AlZpbyasn9jtkNAL8RAzOHFoeYj2iQ "
    }, {
    "id": 50,
    "url": "http://localhost:4000/2021-12-21-owncloud_setup/",
    "title": "OwnCloud Server Setup",
    "body": "2021/12/21 -  👉 Ports configuration Refer to the following links to gist for configuration files concerning the ports configuration, /etc/apache2/ports. conf /etc/apache2/sites-enabled/000-default. conf 👉 Connection to WSL Apache server from outside (i. e. , beyond localhost) This link provide detailed explanation about the IP address assignment scheme for WSL 2 and we need to follow the instruction there to establish the connection from outside to WSL Apache server. Also, since each time when we launch the WSL, new IP address will be assigned to the virtual system and we have no way to make the IP address static. In this case, we can follow this link to grab the IP address of the virtual WSL system automatically and connect it to our Windows host. The following function can be put in powershell profile file so that we can do the configurations all-in-once,    Function own {  wsl sudo /etc/init. d/mysql start  wsl sudo service apache2 restart  $wsl_ip = (wsl hostname -I). trim()  netsh interface portproxy add v4tov4 listenport=5051 listenaddress=0. 0. 0. 0 connectport=5051 connectaddress=$wsl_ip}  👉 Port confliction &amp; Firewall issues Sometimes, if the connection cannot be established via public IP address (or domain name if configured), there could be multiple reasons. First, we may want to change the Apache configuration to let it listen to another alternative port, since sometimes other services (e. g. , Jupyterlab) will take over the port used by Apache. Second, we want to make sure the rule for a specific port is added in Windows Firewall exception (inbound traffic).  👉 Configure external drive By default, onwCloud will use ‘/var/www/owncloud/data’ as the data directory, where all files would be stored. Also, by default, using external local drive as storage is disabled (for safety reason). To enable this, we can refer to Ref. [3].  References [1] https://www. how2shout. com/how-to/how-to-install-owncloud-server-on-windows-10-wsl. html [2] https://lucidar. me/en/owncloud/install-owncloud-server-on-ubuntu-20-04/ [3] https://github. com/owncloud/core/pull/27590 "
    }, {
    "id": 51,
    "url": "http://localhost:4000/2021-08-25-nano_rmc/",
    "title": "Size effect in RMCProfile",
    "body": "2021/08/25 - Figure. 1. Simulation box for bulk (left) and nano (right) systems.  In Ref. [1], we discussed the theoretical principles for correcting the nano-size effect when modeling the pair distribution function (PDF). The fundamental idea is to bring back the uncorrelated pairings in between atoms belong to different nanoparticles, based on the assumption of random distribution of nanoparticles in system. Such uncorrelated pairings will then be added to the partial PDF’s calculated explicitly from the structural model in simulation box, as presented in the right of the picture shown above. The kernel mathematical expression in Ref. [1] is reproduced as follows, [G(r) = \sum_{i,j}c_ic_jf_if_j[\frac{\rho^{RMC}}{\rho}g_{ij}^{RMC}(r) + U(r) - 1]] where the meaning of all symbols can be found in Ref. [1] and we won’t reproduce them all here. Instead, we are going to focus on the term (g_{ij}^{RMC}(r)) which represents the partial PDF’s calculated explicitly from the simulation box and (U(r)) which represents the uncorrelated correlation term. What we are going to discuss here is how to bring these two terms together so that they can be calculated in a compact manner when coded in, e. g. , RMCProfile package. First, (g_{ij}^{RMC}(r)) can be further written as, [g_{ij}^{RMC}(r) = \frac{n_{ij}}{4\pi r^2dr\rho_j} = \frac{\frac{hist_{ij}}{n_i}}{4\pi r^2dr\frac{n_j}{Vol}} = \frac{hist_{ij}}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}] where (hist_{ij}) represents the histogram of pairings between atoms of type (i) and (j) in system. Basically, it is just the number of pairs between atoms of type (i) and (j) that fall into specific distance bins. (Vol) represents the ‘overall’ volume for calculating the partial number density (\rho_j). However, if (Vol) in the equation represents the overall volume of the simulation box (where we have void space, to get rid of periodic boundary condition), we then have to bring in an extra correction factor so that the partial number density can be calculated properly. To this point, the factor (\rho^{RMC}/\rho) can be introduced, where (\rho^{RMC}) and (\rho) refers to the overall number density calculated with and without void space in the simulation box, respectively. If we multiple this factor the $Vol$, the effective volume then can be obtained, in which case the equation above just becomes, [g_{ij}^{RMC}(r) = \frac{hist_{ij}}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol^{eff}}} = \frac{\rho^{RMC}}{\rho}\frac{hist_{ij}}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}] Next, we focus on the (U(r)) term – when coding in such a correction term, we want to do it in a clean way and thus will try to calculate the ‘histogram’ corresponding to the correction term, so that the correction can be applied at the initialization stage and we don’t need to worry about it anymore when calculating the overall PDF and all the other relevant quantities in the program. To do this, we first write, [\frac{\rho^{RMC}}{\rho}g_{ij}^{RMC}(r) + U(r) = \frac{\rho^{RMC}}{\rho}\frac{hist_{ij}}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}} + \frac{U(r)4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}] Pulling all the factors out, we will arrive at, [\begin{equation}\begin{aligned}\frac{\rho^{RMC}}{\rho}g_{ij}^{RMC}(r) + U(r) &amp; = \frac{\rho^{RMC}}{\rho}\frac{1}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}[hist_{ij} + \frac{\rho}{\rho^{RMC}}U(r)4\pi r^2dr\frac{n_i\cdot n_j}{Vol}]\ &amp; = \frac{\rho^{RMC}}{\rho}\frac{1}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}[hist_{ij} + \frac{\rho}{n_{all}/Vol}U(r)4\pi r^2dr\frac{n_i\cdot n_j}{Vol}]\ &amp; = \frac{\rho^{RMC}}{\rho}\frac{1}{4\pi r^2dr\frac{n_i\cdot n_j}{Vol}}[hist_{ij} + \rho U(r)4\pi r^2dr\frac{n_i\cdot n_j}{n_{all}}]\end{aligned}\nonumber\end{equation}] where the second term in the square bracket is the effective histogram corresponding to the uncorrelated pairings, which then can be added to the partial PDF’s at the initialization stage.  References [1] Y. Zhang, et al. , J. Appl. Cryst. (2019). 52, 1035-1042. "
    }, {
    "id": 52,
    "url": "http://localhost:4000/2021-07-09-coh_incoh_sl/",
    "title": "Derivation of neutron incoherent scattering length",
    "body": "2021/07/09 - Figure. 1. Neutron scattering length table by NIST [1]. When we do calculations relevant to neutron scattering, it is unavoidable that we will come across either coherent, incoherent or total scattering length of elements, which describes the strength of scattering neutrons by different elements, either coherently, incoherently or both. In this article, I will try to uncover the three different types of neutron scattering length, by going through the derivation in details. First, the differential cross section for neutron scattering by a certain structure is given as below – here we do the derivation for a single-species system so we can derive the relevant scattering length conveniently. [\frac{d\sigma}{d\Omega} = \sum_{i,j}b_ib_je^{-i\vec{Q}\cdot (\vec{R}_i - \vec{R}_j)}] where (i), (j) refers to atoms located at different locations in the structure under beam. In practice, every single (b_i), (b_j) depends on the corresponding nuclear isotope, spin orientation relative to neutron, nuclear eigenstate, etc. What we are interested in and what is meaningful in practical calculation is the average (\langle b_ib_j\rangle) across all pairs in system, which then can be used as an effective representative of system. To obtain (\langle b_ib_j\rangle), we first write, [b_i = \langle b\rangle + \delta b_i] where we should have (\langle\delta b_i\rangle = 0), if assuming random variation of (b_i) around (\langle b\rangle) for an arbitrary (i). Further, [\begin{equation}\begin{aligned}\langle b_ib_j\rangle &amp; = \Big\langle\langle b\rangle^2 + \langle b\rangle(\delta b_i + \delta b_j) + \delta b_i\delta b_j\Big\rangle\ &amp; = \Big\langle\langle b\rangle^2\Big\rangle + \big\langle\langle b\rangle(\delta b_i + \delta b_j)\big\rangle + \langle\delta b_i\delta b_j\rangle\ &amp; = \langle b\rangle^2 + 0 + \langle\delta b_i \delta b_j\rangle\end{aligned}\nonumber\end{equation}] (\langle\delta b_i\delta b_j\rangle) is then the quantity we want to calculate. The good news is, it is only non-zero when (i = j), assuming atom (i) and (j) is irrelevant to each other. For (i = j), we have, [\langle b^2\rangle = \langle b\rangle^2 + \langle\delta b_i^2\rangle \Rightarrow \langle\delta b_i^2\rangle = \langle b^2\rangle - \langle b\rangle^2] For (i \neq j), we simply have, [\langle b_ib_j\rangle = \langle b\rangle^2] Going back to the equation for calculating differential cross section and putting in the expression for (\langle b_ib_j\rangle), we have, [\begin{equation}\begin{aligned}\frac{d\sigma}{d\Omega} &amp; = \sum_{i,j}^N\langle b_ib_j\rangle e^{i\vec{Q}\cdot(\vec{R}i - \vec{R}_j)}\ &amp; = \sum{i\neq j}^N\Big[\langle b\rangle^2e^{i\vec{Q}\cdot(\vec{R}i - \vec{R}_j)} + \langle\delta b_i\delta b_j\rangle e^{i\vec{Q}\cdot(\vec{R}_i - \vec{R}_j)}\Big] + \ &amp; \hspace{0. 75cm} \sum{i=j}^N\Big[\langle b\rangle^2e^{i\vec{Q}\cdot(\vec{R}i - \vec{R}_j)} + \langle\delta b_i\delta b_j\rangle e^{i\vec{Q}\cdot(\vec{R}_i - \vec{R}_j)}\Big]\ &amp; = \sum{i\neq j}^N\Big[\langle b\rangle^2e^{i\vec{Q}\cdot(\vec{R}i - \vec{R}_j)} + 0\Big] + \sum{i=j}^N\Big[\langle b\rangle^2e^{i\vec{Q}\cdot(\vec{R}i - \vec{R}_j)} + (\langle b^2\rangle - \langle b\rangle^2)\Big]\ &amp; = \sum{i,j}^N\langle b\rangle^2e^{i\vec{Q}\cdot(\vec{R}_i - \vec{R}_j)} + N(\langle b^2\rangle - \langle b\rangle^2)\end{aligned}\nonumber\end{equation}] where (N) is the total number of atoms in system. Here we see the first term is relevant to atomic positions and therefore is the coherent scattering term. Accordingly, (\langle b\rangle^2) is the coherent scattering length (squared). The second term is nothing to do with structure and therefore is the incoherent scattering term. Accordingly, [\langle b^2\rangle - \langle b\rangle^2] is the incoherent scattering length (squared).  References [1] https://www. ncnr. nist. gov/resources/n-lengths/ "
    }, {
    "id": 53,
    "url": "http://localhost:4000/2021-07-08-top_physics/",
    "title": "Notes on topological physics",
    "body": "2021/07/08 - Image reproduced from Ref. [5]. In this blog, I will put down my learning notes as reading through the article on topological electrons by A. P. Ramirez and B. Skinner [1]. Basically, I will follow the story flow in Ref. [1] and therefore, first, I will note down the main flow that one can follow to arrive at the notion of topological electrons. Then I will cover the implications of topology and its connection to quantum Hall effect and quantum spin Hall effect. Finally, Weyl semimetal will be covered. It should be pointed that I will not reproduce all the nice discussions presented in Ref. [1]. Rather instead, I will just try to note down those key points or questions that I came across during reading Ref. [1]. First, the topological structure of an geometric object is defined by the Gauss-Bonnet integral, [\frac{1}{2\pi}\int_S K dA = n] where (K) refers to the curvature at points on surface (A). The integral will give us a constant (n) which corresponds to the genus (number of holes) of a certain geometric object in the following manner, [n = 2(1 - g)] When defining topological electrons, we are trying to look for similar definition as for the Gauss-Bonnet integral presented above. We can summarize the discussion in Ref. [1] as the following flow, Berry connection (\rightarrow) Berry curvature (\rightarrow) Berry phase. Considering then the integral of Berry curvature on the boundary of a 2D Brillouin zone, we then arrive at the topological invariant - the Berry phase, [\frac{1}{2\pi\hbar^2}\int_{BZ}\Omega d^2p = C] where the topological invariant (C) in this case is called the Chern number. (\Omega = \nabla \times \mathbf{X}) is defined as Berry curvature, where (\mathbf{X}) is the Berry connection. The general definition for Berry connection and Berry phase can be found on Wikipedia [2] and won’t be reproduced here. Though, it should be pointed out that the general variable (R) in the formulation presented in Ref. [2] becomes (p) (i. e. momentum of electron) in the specific context of discussing topological electrons. Accordingly, the Berry connection in the context of topological electrons has its physical meaning - the average position of electron as the function of momentum. To understand this, we can refer to Eqn. (5. 34)-(5. 39) in Ref. [3]. Next, I will talk about the implication of topological invariant for magnetic field. First, to have non-zero Chern number, we will have a self-rotation in momentum space, as presented in Fig. 3 in Ref. [1]. Moreover, from the discussion above, we know that the mean value of atomic center position in unit cell is a function of momentum (\mathbf{p}). This indicates that the changing in momenta (i. e. , rotation - attention to the difference between rotation in momentum and real space) accompanies the changing of position and therefore indicates that the angular momentum is associated with the local Berry curvature (which infers the rotation of momenta). Therefore, we can see the analogous relation between Berry curvature and magnetic field - they both break symmetry (Berry curvature breaks the inversion symmetry when we have non-zero Chern number); they both bring in orbital angular momentum. Another implication for magnetic field from Berry curvature is that non-zero curl of (\mathbf{X}) will introduce movement in the transverse direction as, e. g. , electrons are accelerated in electric field - refer to Wikipage for curl [4] (see the two examples given there).  If inversion symmetry is not broken, the path integral along the boundary ofBrillouin zone will always Chern number of 0 — for any ‘(\mathbf{p})’,we have a corresponding ‘(-\mathbf{p})’ with identical Berry connection,which will make the integration always 0. The implication for magnetic field as originated from topological invariant brings us to the connection with quantum Hall effect. When certain 2D materials are immersed in strong magnetic field and low temperature environment, they show quantized Hall conductance behavior. The physics picture for such a behavior is, electrons are circulating interior the bulk and rolling along the surface. Such circulating and rolling orbitals are quantized according to Landau levels which gives the quantization of cyclotron orbitals of charged particles in a uniform magnetic field. The quantization of Hall conductance can be explained purely by Landau’s quantization theory for magnetic field [6], and also it can be deduced based on topological consideration [7, 8]. The topological paradigm also explains the robustness of quantum Hall effect, i. e. the quantized Hall conductance is protected by topological invariant [7, 8]. According to Ref. [7, 8], the topological invariant is defined in parameter space, which is different from the version as presented in current summary based on Ref. [1] where the topological invariant is given in momentum space. Going back to the discussion about topological invariant as defined in momentum space, the implication for magnetic field gives rise to edge states much like those in the quantum Hall effect. There are two things to note down at this point, 1) as pointed out just above, the topological protection mechanism of quantum Hall effect systems and the topological system defined in momentum space is different. 2) though the topological invariant (again, defined in momentum space) implies magnetic field (which seems to suggest that the edge states can stably exists without external magnetic field), the breaking of time reversal symmetry in such topological systems makes it impossible to hold stable edge currents as what we can have in quantum Hall effect systems. However, in certain systems with strong spin-orbital coupling [1, 9], electrons with spin up and spin down can break down the time reversal symmetry separately to give opposite non-zero Chern number. In another word, spin up electrons flow, e. g. , to the right on surface whereas spin down electrons to the left. In such systems. the overall time-reversal symmetry is kept and on surface, we won’t have net current of electrons but we do have net flux of spins - either up or down. Such an effect is called quantum spin Hall effect [1, 10, 11]. The topological notion discussed here can apply to both 2D and 3D systems – in 3D systems, it can be used to understand Weyl semimetal. What is semimetal? It shows continuous band structure as what we have for metal but the connection part (somewhat like the neck) is quite narrow – that is typical band structure of semimetals. Specifically for Weyl semimetals, two bands touch each other in momentum space at Weyl points where we have the abrupt change in the orbital character of the wavefunction – the momentum of electrons does not change smoothly crossing Weyl points. The picture shown at the top of current blog gives a typical picture of the corresponding band structure in 3D space. Usually, electronic band cannot coincide in energy since anytime two bands meet each other, there will be hybridization happening which will splits the degeneracy and therefore the two bands are bounced away from each other. In early age, the touching of two bands was explained to be accidental in which case hybridization is avoided. However, such an accidental touching could be easily destroyed by perturbation and therefore does not stand. In the context of topological paradigm, we see that such a type of band structure for Weyl semimetal systems is protected by the topological invariant. The value of topological invariant is relevant to the inclusion of Weyl points in the integration area when evaluating the Chern number integral. Weyl points are topological analogues to electric charges – they are monopoles of Berry flux [1]. Also the Weyl points always come in pairs with opposite topological charges and the two Weyl points in the pair are with different chirality. Therefore, in Weyl semimetal systems, half of electrons are Weyl fermions with one chirality (see Ref. [12] for definition of electron chirality – basically, it means whether electron spin is in the same or opposite direction flowing direction), the other half being Weyl fermions (electrons without explicit chirality are Dirac [fermions) with opposite chirality.  References [1] A. P. Ramirez and B. Skinner.  Physics Today 73, 9, 30 (2020). [2] https://en. wikipedia. org/wiki/Berry_connection_and_curvature [3] https://1drv. ms/b/s!AlZpbyasn9jtoqUZCYW069akHDG2rQ?e=gCynHc [4] https://en. wikipedia. org/wiki/Curl_(mathematics) [5] https://www. bnl. gov/newsroom/news. php?a=117401 [6] https://1drv. ms/b/s!AlZpbyasn9jtoqUlsQ_9KB7CG2g-og?e=kSOfZu [7] https://1drv. ms/b/s!AlZpbyasn9jtoqUkYCO6KG6h8JZFFA?e=gdOCXB [8] https://1drv. ms/b/s!AlZpbyasn9jtoqUj2N8fMFbK-0_cNQ?e=oe58FK [9] https://jqi. umd. edu/glossary/quantum-hall-effect-and-topological-insulators [10] https://scienceblogs. com/principles/2010/07/20/whats-a-topological-insulator [11] https://www. evernote. com/shard/s266/sh/2a935515-dfaa-4312-bb66-1d5dd5086339/dcdb9fe33e21b49f7c10168fd8980861 [12] https://en. wikipedia. org/wiki/Chirality_(physics) "
    }, {
    "id": 54,
    "url": "http://localhost:4000/2021-07-07-ising_sol/",
    "title": "Notes on Ising model",
    "body": "2021/07/07 - Ernst Ising (Left) and Wilhelm Lenz (Right) - Ising was Lenz’s student and the Ising model was claimed (by Ising himself) to be originated by Lenz but named after Ising. Ising model was originally proposed for ferromagnetism and owing to its simplicity in describing the system interaction, it has been widely used in not only describing magnetic systems in theoretical physics area but also in other areas involving similar interaction mechanism. In fact, Ising model can potentially find its position in describing systems involving binary states whereby we have active influence upon each other between neighbors. Here in this blog, I will not try to reproduce those already available beautiful introduction to Ising model - see e. g. , Ref. [1-4] and a whole bunch of others one can easily find on Internet. Instead, I will just write down the outline of the problem we are facing once we have the simple Ising model set up for describing the system energy. For example, we always hear people talking about the exact solution for Ising model. But, what actually are we trying to solve? What about those non-exact ways for ‘solving’ the Ising model?First, it is worthwhile to write down the Hamiltonian for Ising model, [E_I{S_i} = -\sum_{\langle i,j\rangle}J_{ij}S_iS_j - \sum_{i=1}^NB_iSi] where the subscript (I) represents the Ising model. The first term corresponds to the interaction energy between neighboring spins and the second term is the interaction energy with externally applied magnetic field. ({S_i}) is a shortcut for the spin configuration of the system where each spin on its lattice site has its own orientation - either up (+1) or down (-1). (i) and (j) refers to lattice site and (J_{ij}) is the exchange constant describing the interaction strength between neighboring spins. Given the Hamiltonian of system, we are trying to calculate a crucial quantity - the partition function, which is a defined as the function of system state variables such as temperature, volume, etc. Starting from partition function, we can derive most of other thermodynamic variables, e. g. , system total energy, free energy, entropy, pressure, etc. Then naturally we can look into the phase transition problem, e. g. , for magnetic system, using those quantities derived from partition function. Therefore, for Ising model, when we say we want the exact solution, we mean to obtain the exact analytical solution for the partition function, the general expression of which is given as below, [Z = \sum_{s_1=-1}^{+1}\sum_{s_2=-1}^{+1}\cdots\sum_{s_N=-1}^{+1}e^{-\beta E_I{S_i}}] The solution for 1D Ising model can be found in Ref. [3], which is based on the original publication by Kramers and Wannier [5]. The exact solution for 2D model was originally proposed by Onsager [6-8] and the whole derivation procedure is reproduced in details as presented in Ref. [6]. The exact solution for 3D situation has been a challenging question to the physics community. In 2007, Prof. Z. Zhang proposed his exact solution based on two conjectures [9] and currently it is still under active debate and development [10, 11]. About this debate, Prof. Z. Zhang has three series of blogs introducing the history and current development of this theory - one can refer to Ref. [12-14] for details. Apart from exact solution, there are other ways to explore the phase transition behavior using Ising model, mainly based on numerical or simulation (e. g. , Monte Carlo) approach. An approach based on iterative numerical technique can be found in Ref. [3] and typical examples for those based on Monte Carlo simulation can be found in Ref. [15, 16].  References [1] http://blog. sciencenet. cn/blog-2344-3193. html [2] http://blog. sciencenet. cn/blog-2344-3194. html [3] https://1drv. ms/b/s!AlZpbyasn9jtoqUSanNV39-L40X42g?e=pOxR7u [4] https://1drv. ms/b/s!AlZpbyasn9jtoqUTtwM3cceW31_s5Q?e=d8RZv4 [5] H. A. Kramers and G. H. Wannier, Phys. Rev. 60, 263, 1941. [6] https://1drv. ms/b/s!AlZpbyasn9jtoqUUAfC4omrmXx1SSg?e=BX4WtI [7] https://1drv. ms/b/s!AlZpbyasn9jtoqUVcBIXJkaygOTFXw?e=3V0JK0 [8] L. Onsager. Phys. Rev. 65, 117, 1944. [9] Z-D. Zhang, Philos. Mag. Lett. 87 (34), 5309-5419, 2007. [10] Zhi-Dong Zhang, Chinese Phys. B. 22, 030513, 2013. [11] Zhidong Zhang, Osamu Suzuki and Norman H. March, Adv. Appl. Chifford Al. 29, 12, 2019. [12] http://blog. sciencenet. cn/blog-2344-3476. html [13] http://blog. sciencenet. cn/blog-2344-49176. html [14] http://blog. sciencenet. cn/blog-2344-1173989. html [15] https://rajeshrinet. github. io/blog/2014/ising-model/ [16] https://towardsdatascience. com/monte-carlo-method-applied-on-a-2d-binary-alloy-using-an-ising-model-on-python-70afa03b172b "
    }, {
    "id": 55,
    "url": "http://localhost:4000/2021-06-24-man_jupyter_kernel/",
    "title": "Management of Jupyter kernels",
    "body": "2021/06/24 -  Having multiple kernels available for Jupyter service, we may need to manage them at some point, e. g. , rename kernel names and remove kernels. First, to show all available kernels, run the following command,  jupyter kernelspec list we will then see output like this,  Available kernels:  python3  /opt/jupyterhub/lib64/python3. 6/site-packages/ipykernel/resources  diffpy   /usr/local/share/jupyter/kernels/diffpy  py37    /usr/local/share/jupyter/kernels/py37  python   /usr/local/share/jupyter/kernels/python This is the full list of all available kernels on our machine and the directory specifies where the configuration file for each kernel is located. To change kernel name, we then need to go into the corresponding directory for a specific kernel and open the ‘kernel. json’ file to change the ‘display_name’ entry to whatever we want. To remove a kernel, we want to use the following command,  jupyter kernelspec remove KERNEL_NAME For example, if we want to remove the ‘diffpy’ kernel above, we want to execute,  jupyter kernelspec remove diffpy Among all the available kernels, there is a special one - the ‘base’ JupyterHub kernel from kernelspec. The ‘python3’ kernel shown above is just the ‘base’ JupyterHub kernel. If we try to remove this kernel, it will complain that the kernel cannot be found. Here in Ref. [1] is given detailed description and solution to this issue. To remove this base kernel, as posted in Ref. [1], there are two main things to do, 1) rename one of the other kernels to the base kernel name [2] and 2) disable native kernel by changing Jupyter configuration file [3]. Concerning the second part, we may need to create Jupyter configuration file first if it is not already existing, as instructed in Ref. [4].  References [1] https://github. com/jupyterhub/jupyterhub/issues/2759 [2] https://github. com/jupyterhub/jupyterhub/issues/2759#issuecomment-538139098 [3] https://github. com/jupyterhub/jupyterhub/issues/2759#issuecomment-770025308 [4] https://testnb. readthedocs. io/en/latest/config. html "
    }, {
    "id": 56,
    "url": "http://localhost:4000/2021-05-17-sphinx/",
    "title": "Intro to Sphinx",
    "body": "2021/05/17 -  Docstring is part of Python script which will keep record of documentation and description of the relevant section in the script. It won’t make any effect upon the execution of the script but whenever needed, the docstring could be pulled out and displayed for users’ reference. Based on that, we can go further to generate dedicated documentation pages/docs for general purpose. At this point, Sphinx is a commonly used package to transform the docstrings in Python script into either HTML, LaTeX or some other suitable formats. Here in this blog, I am going to write down some notes in using Sphinx for building documentation based on the docstring in Python scripts. The steps below could be used as sort of general guidance to set things up with Sphinx.  1. Installation The official link to Sphinx gives rather detailed instructions about the installation and here I am not going to reproduce those details - refer to Ref. [1].  2. Initial setup Once Sphinx is installed, we may want to set up the building system initially, following the instruction provided with Sphinx official site - refer to Ref. [2] at this point. It is a common practice to put everything about the documentation building into a single dedicated directory, alongside the Python files containing our docstrings. For example, here following is presented the tree structure for one of my projects, . ├── LICENSE. txt ├── … ├── docs ├── requirements. txt ├── rmc_tools ├── … whereby rmc_tools is a folder containing a whole bunch of Python scripts containing docstrings in each of them and docs is the folder where I put the documentation building system.  3. Documentation tree After initial setup, we can start to put together the documentation tree so that we can further use Sphinx to build our documentation. Here in my example, the whole documentation tree (in which each file is following the reStructuredText format) is stored in the source directory. The following is presented the overall tree structure for the documentation (i. e. stuff put under docs directory), . ├── Makefile├── make. bat└── source  ├── _static  │   └── init. py  ├── conf. py  ├── ext_links. rst  ├── index. rst  ├── install. rst  ├── installation  │   ├── rmc_modules_install. rst  │   └── rmc_tools_install. rst  ├── rmc_modules  │   ├── bulk_stuff. rst  │   ├── nano_stuff. rst  │   └── rmc6f_stuff. rst  ├── rmc_modules. rst  ├── rmc_tools  │   ├── bulk_shells. rst  │   ├── np_gen. rst  │   ├── np_lin_analyzer. rst  │   ├── np_shells. rst  │   ├── rmc_strain. rst  │   ├── sofq_calib. rst  │   └── topas4rmc. rst  └── rmc_tools. rst Then located in docs directory on terminal, we can simply execute make html to build up the documentation HTML pages. Things should start to roll like a charm at this point and following I note down several aspects we may want to pay attention to as we follow the procedures,  rst files could be grouped into dedicated folders and referred to in a separate rst file - like what we have above for the rmc_tools. rst file which contains references to those rst files in rmc_tools folder.    The rst file at the fundamental level should then contain reference to the docstring in Python file. For example in the rmc_tools/bulk_shells. rst file, it refers to the NP_Shells/bulk_shells. py file located in the main project directory. To let the building system find the Python file, we need to tell the building engine where those scripts are located. This can be done through the conf. py file located under source directory. Sometimes, we may think that if we have an entry in a rst file like . . automodule:: RMC_Strain_Analyzer. rmc_strain, it is enough to specify the parent directory where RMC_Strain_Analyzer is located. However, this turns out to be not the case - we need to include the full path to RMC_Strain_Analyzer in the system path as well. &lt;/li&gt; 4. Go online Upload documentation to online service so that it can be accessed by public. To do this, we can use the service provided by readthedocs. Here I will take the combination of readthedocs with GitHub as the example. If we have suitable directory setup as discussed above, e. g. everything concerning the documentation setup is contained in docs directory, and we have the whole project available in GitHub repository, we can set up a readthedocs account using our GitHub account, after which we can then import our GitHub repository holding the documentation project without problem. Once we are done the link between GitHub and readthedocs, any time we push something to our GitHub repository, the documentation will be built automatically and will be made available through readthedocs service.  Sometimes, certain Python scripts involved in the documentation building will try to import external modules, e. g. numpy or whatever - in this case, we need to tell readthedocs service explicitly what external modules we need. Otherwise, readthedocs won’t be able to find those necessary modules on its building server and therefore will fail the corresponding part of documentation building. As a comprehensive example, the GitHub repository given in Ref. [3] could be used as the template for documentation building with Sphinx.  References [1] https://www. sphinx-doc. org/en/master/usage/installation. html [2] https://www. sphinx-doc. org/en/master/usage/quickstart. html [3] https://github. com/Kvieta1990/rmc_adv_tools "
    }, {
    "id": 57,
    "url": "http://localhost:4000/2021-05-17-jup_kernel/",
    "title": "Jupyterlab kernel setup",
    "body": "2021/05/17 -  When trying to set up our own Jupyterlab server where general users can visit and use, the link in Ref. [1] could be followed. Once we follow literally the step-1 specified in the link, the server should be running without problem and we can just start using our own online Jupyterlab service. However, since the Jupyterlab service we just set up is a system-wise available service and therefore when we want to add kernels to the Jupyterlab service, we cannot use those kernels belonging to a specific user. Instead, we should set up system-wise available environment which then can be used as system-wise available kernels. The step-2 in Ref. [1] provides us with a generic way to set up the system-wise available environment using conda. Definitely we can follow the instructions there to set up conda in such way that conda itself is also system-wise available. As an alternative, we can be a bit flexible - we can use general users’ local conda environment to do this as well, as long as the general user has the sudo privilege. For example, the following commands could be executed to set up the system-wise available Python environment,  sudo ~/miniconda3/condabin/conda create –prefix /opt/conda/envs/py37 python=3. 7sudo /opt/conda/envs/py37/bin/python -m pip install ipykernelsudo /opt/conda/envs/py37/bin/python -m ipykernel install –name py37 –display-name “Python (py37)” –prefix=/usr/local/ In this way, the py37 environment could also be accessed across the system by all logged in users.  References [1] https://jupyterhub. readthedocs. io/en/1. 2. 0/installation-guide-hard. html "
    }, {
    "id": 58,
    "url": "http://localhost:4000/2020-12-21-notes_mag_III/",
    "title": "Notes on magnetism - III",
    "body": "2020/12/21 -  Talking about magnetic field, we have three relevant physical quantities - magnetic field (\vec{H}), magnetic induction field (\vec{B}) and magnetization field (\vec{M}). It is straightforward to understand (\vec{M}) - when applying magnetic field (here, by ‘magnetic field’, we mean something in general, but not specifically refer to (\vec{H})), we use (\vec{M}) to characterize how much the matter in question is magnetized. However, concerning (\vec{H}) and (\vec{B}), it seems that both are describing some sort of ‘strength’ of magnetic field (again, we mean ‘magnetic field’ in general. The same applies below until we become specific about what we mean by ‘magnetic field’). But why do we have two quantities here to describe the ‘same’ thing? The answer is - they are not the same thing, as described by (\vec{H}) and (\vec{B}), respectively. Fundamentally, this goes back to the foundation of the electromagnetic theory - specifically, we mean the two historical discoveries. One is the finding that an electric current creates a magnetic field, by Oersted. The other is the discovery by Faraday that, in brief, a changing magnetic field will create electromotive force across an electrical conductor. The first one describes how a magnetic field can be generated from a current. Starting from such a discovery, if we are going to define a quantity to describe magnetic field, such a quantity will be bounded to electrical current, i. e. such a defined quantity for describing magnetic field can be purely derived from electrical current - this is the quantity (\vec{H}), to which we give the name of magnetic filed (we now become specific about what we mean by ‘magnetic field’). Concerning the second discovery, we also have a correspondingly defined quantity to describe the associated magnetic field (here, we go back to the general meaning of saying ‘magnetic field’, temporarily) – the quantity we define as (\vec{B}), to which we give the name of magnetic induction field. Different from (\vec{H}), the quantity (\vec{B}) serves as the ‘source’ of electric field, i. e. (\vec{B}) is considered to induce electric field (thus given the name magnetic induction field) and therefore (\vec{B}) does not have to originate itself purely from electrical current. In another word, when we talk about the induction of electric field from magnetic ‘stuff’, we mean every aspect of the magnetic ‘stuff’, including both that generated from electrical current (i. e. the magnetic field (\vec{H})) and the magnetization effect of matter (i. e. , the magnetization field (\vec{M})). After all, the following relation summarizes the discussion above, [\vec{B} = \mu_0\vec{H} + \vec{M}] The two discoveries mentioned above were further summarized into Maxwell’s equation in matter (i. e. , non-vacuum), respectively, [\nabla \times \vec{E} = -\frac{1}{c}\frac{\partial \vec{B}}{\partial t}] [\nabla \times \vec{H} = \frac{1}{c}(4\pi \vec{J}_f + \frac{\partial \vec{D}}{\partial t})] In summary, (\vec{H}) can be thought of as being purely coming from electrical current, whereas (\vec{B}) covers both the part originating from electrical field and that from matter magnetization (i. e. , a comprehensive ‘magnetic field’) – that’s why the Gauss’s law for magnetism is summarized as (\nabla \cdot \vec{B} = 0), where the comprehensive quantity (\vec{B}) is used instead of (\vec{H}). "
    }, {
    "id": 59,
    "url": "http://localhost:4000/2020-12-18-spin/",
    "title": "About electron spin",
    "body": "2020/12/18 - Illustration for Stern-Glach experiment [1].  Angular moment means rotation - this applies to electron as well. For electrons, any movement is associated with current and therefore angular moment naturally is tightly linked to current as well. Furthermore, current means magnetic field, as originated by Orsted. Mathematically, starting from expressing the current with the angular moment of rotating electrons, followed by detailed mathematics based on Biot-Savart law (induction (\vec{B}) as the function of current), one can arrive at the expression of magnetic induction in terms of magnetic (dipole) moment (\vec{m}_l). In another word, it can be shown that the magnetic field generated by electron rotation current is equivalent to that generated by magnetic dipole, with the equivalent dipole moment defined as (see Ref. [2] for detailed derivation), [\vec{m}_l = -\frac{1}{2}eR^2\vec{\omega}] Given that the angular moment can be written as (\vec{l} = m_eR^2\vec{\omega}), we can obtain the following relation, [\vec{m}_l = -\frac{e}{2m_e}\vec{l}] Defining the Bohr magneton as, [\mu_B := \frac{e\hbar}{2m_e}] we arrive at the more familiar expression for the magnetic dipole moment, [\vec{m}_l = -\mu_B\frac{1}{\hbar}] This is what we mean by angular moment quantum number (l) in quantum mechanics. When we say the electron angular moment quantum number is 1, we mean, actually, (l = \hbar), as in the equation given above. Everything now does not seem to be so strange yet - at least we can somehow start from classic mechanics to arrive at expression for quantum mechanics. However, things change a bit as we start to think about electron spin. Following the idea presented above, we know that electron spin should have similar expression as above for its corresponding effective magnetic dipole moment, i. e. [\vec{m}_s = -\mu_B\frac{\vec{s}}{\hbar}] since anyways electron spin is indeed a sort of rotation, if we consider electron spin purely as classic phenomenon. However, in fact what we have is, [\vec{m}_s = -g\mu_B\frac{\vec{s}}{\hbar}] where, if ignoring other effect (e. g. spin-orbital coupling), we would have (g = 2). But, where does the extra factor (g) comes from? Why do we need it? The reason is, if following the same format of the magnetic dipole moment expression, as for the orbital angular moment, we just have to have (g = 2) to have such a correspondence that (g\vec{s} \sim \vec{l}), since simply we have the spin quantum number for electron to be (\frac{1}{2}). But why do we have electron spin as one half? Why cannot we have electron spin quantum number as 1 so that we do not need to worry about the extra factor (g) at all? The reason goes way back to the Stern-Gerlach experiment, in which it was shown that the split of electron spin in magnetic filed is 2. In another word, we have two possible projections of spin onto the (z)-axis (the direction along the magnetic field). From the basic principle of quantum mechanics, we know that we have to have the electron spin quantum number to be (\frac{1}{2}) for such a splitting behavior of electron spin in magnetic field. More notes about this can be found in Ref. [3] - basically, the principle is the number of projections along the direction of magnetic field (our (z)-axis) should be (2l + 1), where we use (l) to represent angular moment in general.  N. B. (l) in quantum mechanics is usually used to represent orbital angular moment, but here we are using (l) to represent angular moment in general, i. e. it can refer to either orbital angular moment or electron spin angular moment. References [1] http://hyperphysics. phy-astr. gsu. edu/hbase/spin. html [2] http://u. pc. cd/ydWrtalK [4] https://www. iris2020. net/2020/03/notes-on-magnetism-i-magnetism-of-free. html "
    }, {
    "id": 60,
    "url": "http://localhost:4000/2020-12-01-rmc_configure/",
    "title": "Configure RMCProfile",
    "body": "2020/12/01 -    Configuration on Linux system          rmcprofile on cluster      To run rmcprofile on cluster, the following bash script may be helpful,       #!/bin/bash ulimit -s unlimited export OMP_NUM_THREADS=12 RMCProfile_PATH=WHEREVER_RMCProfile_FOLDER_IS_LOCATED export PGPLOT_DIR=$RMCProfile_PATH/exe/libs export LD_LIBRARY_PATH=$RMCProfile_PATH/exe/libs export LIBRARY_PATH=$RMCProfile_PATH/exe/libs export PATH=$PATH:$RMCProfile_PATH/exe $RMCProfile_PATH/exe/rmcprofile stem_name        where WHEREVER_RMCProfile_FOLDER_IS_LOCATED refers to the main  RMCProfile directory within which the exe and tutorial  sub-directories are usually located. stem_name refers to whatever the stem name is for our RMC fitting. Put this script within RMC  fitting directory and run it from there should not be a bad idea.           Speeding up rmcprofile     No matter running on clusters or a PC, running the following two  commands just before kicking off RMC fitting should help speeding up the fitting.      ulimit -s unlimited export OMP_NUM_THREADS=12             Configuration on MacOS          Speeding up rmcprofile     Running the following two commands just before kicking off RMC fitting should help speeding up the fitting.      ulimit -s unlimited export OMP_NUM_THREADS=12          "
    }, {
    "id": 61,
    "url": "http://localhost:4000/2020-11-28-notes_jekyll/",
    "title": "Notes on Jekyll",
    "body": "2020/11/28 -  One can follow Ref. [1] to build up site with Jekyll - it contains quite a few steps concerning the set-up of sites through GitHub pages. However, this is not necessary if one just wants to set up site locally and test. Therefore, after installing Ruby and Bundle, one can directly create a local folder and go into it. From there, one needs to follow the steps given below,1. Run bundle init - this will create the Gemfile. 2. According to Ref. [1], GitHub pages depends on certain version of packages (a link can be found there in Ref. [1] about details) and therefore one may need to install certain version of Jekyll with Bundle (though, again this may not be necessary if one only wants to do it locally). To install a certain version of Jekyll with Bundle, one need to put in the following line into Gemfile,  gem ‘jekyll’, ‘3. 9. 0’ 3. Then one needs to execute bundle install to install the required version of Jekyll. 4. At this stage if one continues, as instructed in Ref. [1], to execute bundle exec jekyll new . , most likely error will occur, complaining that the directory is not empty (since we created the Gemfile in previous step for installing the right version of Jekyll). In this case, one just executes the following command, bundle exec jekyll new –force . , which will by force overwrite the already existing Gemfile. 5. To test locally, one simply executes the following command, bundle exec jekyll serve to start the service, where one should be able to see the localhost that we need to open in browser to check our template site!More reference materials can be found in Refs. [2-4].  Typical issues - 1    Load error: cannot load such file – webrick Solution Run the command, bundle add webrick.  References [1] https://docs. github. com/en/free-pro-team@latest/github/working-with-github-pages/creating-a-github-pages-site-with-jekyll [2] https://docs. github. com/en/free-pro-team@latest/github/working-with-github-pages/testing-your-github-pages-site-locally-with-jekyll [3] https://pages. github. com/versions/ [4] https://bundler. io/gemfile. html "
    }, {
    "id": 62,
    "url": "http://localhost:4000/2020-11-22-kde/",
    "title": "Notes on kernel density estimation",
    "body": "2020/11/22 - With a collection of data, we may want to extract or estimate the underlying distribution model. For example, we have the collection of house price in a certain area, we want to have an idea about how the house price in that area is distributed. However, without a priori knowledge about what the model that distribution should follow, we cannot follow the so-called parameterized way for estimating the distribution. In that way, we know beforehand about what the distribution model should be and it’s just some parameters yet need to be determined. Then we can do the commonly used least-square fitting to obtain those unknown parameters. However, it is usually the case where we have no knowledge about what the distribution model should look like, in which case we need a non-parameterized approach to estimate the underlying distribution, e. g. the histogram method and the one we are going to focus here: kernel density estimation (KDE). Here is the formulation of KDE, [\hat{f}(x_0) = \frac{1}{Nh}\sum_{i=1}^N K(\frac{x_i - x_0}{h})] where (h) is called the bandwidth which plays an important role in determining our estimation for the distribution density. (K) is just our kernel function, for which we may have several alternative choices - a Gaussian kernel is usually used. Detailed introduction about mathematics of KDE can be found in Ref. [1] and we are not going to reproduce them here. Instead I put several key points as follows, which I think is quite important for better understanding the KDE method,  Wherever we have an observed data, we should put a corresponding kernel there.  The kernel function we put at each observed data point is a normalized distribution function, for which the probability density is the highest at each corresponding observed data point.  The fundamental idea behind the kernel approach is that around each observed data point, the further we go away from the observed data point, the less our probability density should be.  The overall sum of all the kernels should be normalized to 1, i. e. the overall probability should obviously be 1. There are more technical details about KDE, for which one can refer to the introduction given by Ref. [1]. Here we use two simple animations to demonstrate the idea about KDE, as presented below,  The left-hand side figure gives the situation where all five data points fall onto the same position and the KDE distribution stays all the same as we have more data coming. The right-hand side figure gives more general situation where all five data points fall onto different positions, from which one can clearly see how the estimation of KDE distribution varies as we collect more and more data points.  ========================I AM A SEPARATOR======================== ☝About the influence of norm choice upon KDE for higher dimension The idea of KDE can be easily extended to higher dimensions and the idea is still the same - the further we go away from the center of a specific kernel, the less distribution probability we will have. However, for high dimensions, it is not as straightforward as it is for 1D case, in terms of how we define the distance from the kernel center. Mathematically, the distance we mean here is actually a norm of a certain type, e. g. L0 norm, L1 norm or L2 norm, … According to the definition of norm,       [       \vec{x}       _p = \sqrt[\leftroot{-1}\uproot{5}p]{\sum_i   x_i   ^p}]   where (p\in{\rm I!R}). For 1D situation, the value of various different L norms is the same (except L0 norm, which is kind of special - see note below), since simply we have only one entry in the vector. But going to higher dimensions, we have more entries in the vector and therefore different L norms do give different distances. Therefore, choosing different L norms for the KDE analysis will influence the results, especially when we have limited number of input data points. Detailed discussion about the influence of different L norm choices can be found in Ref. [1]. N. B. There are two special L norms - L0 norm and L-Infinity norm - among which L0 norm is even more problematic since we don’t have rigorous definition for what (\sqrt[0]{n}), where (n\neq 0). Therefore, in practice, the L0 norm is actually defined as,       [       \vec{x}       _0 = #(i   x_i\neq 0)]   where (#) means ‘the number of’. As for the L-Infinity norm, it means the maximum entry in the vector component. This is relatively straightforward to follow - given the mathematical definition of L norm above, the maximum entry will be the only one dominating as compared to all the other entries, considering the infinity power. Refer to Ref. [2, 3] for more detailed discussion about L norms.  References [1] https://www. youtube. com/watch?v=x5zLaWT5KPs&amp;list=PLAYk0l7EXZVumN_Uil7ou8WUBkrFkVE91 [2] https://rorasa. wordpress. com/2012/05/13/l0-norm-l1-norm-l2-norm-l-infinity-norm/ [4] https://www. evernote. com/l/AQpVf7ClpwZJp7qhPTXWRPHUZL2MAIUC40E "
    }, {
    "id": 63,
    "url": "http://localhost:4000/2020-11-20-flask/",
    "title": "Notes on Flask",
    "body": "2020/11/20 -  We follow the tutorial given in Ref. [1, 2] for setting up the web host using Python Flask module. Details will not be reproduced in current blog step by step. Instead, we will focus on 1) some key aspects to make step description clearer and 2) steps where error can easily occur. First, we give all the necessary recipes, as follows,  Flask - Python web server  uWSGI - Sitting in the middle between Flask and Nginx for connection purpose.  Nginx - Facing outwards to receive request. and we will configure the web host on CentOS 7.  Traditionally, we have the web server hosts files in specific location on the server (e. g. /var/www) and then we will have, e. g. the Apache HTTP server to listen to user request (through a certain port, e. g. 80) and fetch certain files stored in specific location on the server and then send back to users’ browser. When using Python to set up web host, we have one more layer for the connection between files on the server to be visited and users. The idea is that Python is responsible for creating contents, uWSGI is responsible for ‘translating’ and Nginx is responsible for receiving from users for request and sending back to users the ‘translated’ contents. ☝Preparation On CentOS 7, Nginx can be installed with yum,sudo yum install nginxSometimes, it may also be necessary to install pip and python-devel if they are not already [3, 4],sudo yum install python-pip python-develWith Python 3, we may need to change the command to [5, 6, 13, 14],sudo yum install python3-pip python37-devel(here we take Python 3. 7 as an example). It is always recommended that we should create dedicated environment when setting up the web host with Python. Therefore, either we can follow the instruction given in Ref. [1, 2] to install and set up virtual Python environment using virtualenv using pip. Or we can use conda to set up the dedicated Python environment. Within the created environment, we can either use pip or conda to install necessary packages, namely uwsgi and flask. In some cases, using pip to install uwsgi may return error, where one has to use conda to install it. N. B. Though the packages are installed within certain environment (which seems not accessible from outside the environment), they can still be accessed from outside - the reason simply is that when a specific version of Python is used in question (e. g. that within a certain environment), all the packages installed within the corresponding environment will become available.  ☝A simple start With just Flask installed (no Nginx, no uWSGI), one can already host a web - that’s why we call Flask a Python web server, since simply with it we can just host a web server! Refer to Ref. [1, 2] for a Hello World demo with a simple Python script.  ☝Create the WSGI entry point Now we go a bit further to start the web host through WSGI entry point. According to Ref. [1, 2], the entry point here is just a simple Python script which first imports the Python method (containing the Flask app) and then run it. In Ref. [1, 2], the entry point script and the main Python app script are put together under the same directory. But in practice, we don’t have to do that - the import command in the entry point script should specify where to find the main app script. N. B. By default, uwsgi expects application as our app name. If we want to use another name for the app (specified in the main app Python script), we should specify the callable app name [7, 8]. When starting the uWSGI service directly from command line, we should have,uwsgi --socket 0. 0. 0. 0:8000 --protocol=http --callable myapp -w runwhere myapp is our app name and run is the entry point script stem name. N. B. We should not use port 80 in the entry point script [9].  ☝Configuring Nginx The last step is to configure Nginx - to establish the connection between outside world and our Python app (through uWSGI as the interface as discussed above). To do this, again we should follow steps in Ref. [1, 2] and details won’t be reproduced here. One critical parameter to mention is the location of the socket file - this file is like a junction between Nginx and uWSGI and therefore in the configuration files of both, the socket file should be with exactly the same name. Another potential issue to mention here is that, though Ref. [1, 2] mentions some file/folder permission configuration concerning setting up Nginx, in practice we may still have issues establishing the connection. The common problem is 502 bad gateway issue. Once this occurs, we can consider the following potential solutions,  Open port in firewall configuration. In CentOS 7, this may require the installation of `firewalld` package and following the instruction given in Ref. [11] for how-to.  If web server is within a certain organization network, we may need to check the firewall restriction of the organization network as well. Specifically for CADES service at ORNL, we need to follow the instruction in Ref. [12] for how-to.  We may want to disable SELinux, according to the comments in Ref. [1, 2]. plus those mentioned in Ref. [1, 2].  ========================I AM A SEPARATOR======================== ☝Notes on setting up pdfitc on CADES hosted at ORNL    We want to follow Long’s instruction in Ref. [15] for step-by-step procedures (see the ‘How to install’ section). We want to skip step-#5 and also for step-#7, the file we want to configure for implementing GSAS II is ‘run_gsas2_calc. py’ under ‘pdfitc’ folder. The line we want to change is the one containing ‘sys. path. insert’.     The folder cloned from Long’s ‘tsitc’ repository is not complete - some files and folders are missing which will cause the app not starting. We need to back up Long’s working version to a separate repository and develop from there (need to post the new repository here once it’s done).     For running the pdfitc service (edit ‘/etc/systemd/system/pdfitc. service’ file if changes to the service are needed) for the first time, we may encounter problems about modules not found. Usually, the missing modules (e. g. dash) should be straightforward to install with, e. g. conda.     The ‘celery. task’ method has been deprecated and therefore is no longer available with celery. Accordingly in the main ‘app. py’ file, we want to comment out the import line for ‘celery. task’ and change ‘revoke’ to ‘app. control. revoke’ [16, 17].  References [1] https://www. digitalocean. com/community/tutorials/how-to-serve-flask-applications-with-uwsgi-and-nginx-on-centos-7 [2] https://www. evernote. com/l/AQrJngSLeBxB0okR7mOoGaUV072RVCnFd2M [3] https://stackoverflow. com/questions/44037637/error-installing-uwsgi-in-virtualenv [4] https://www. evernote. com/l/AQpLAsPHMUdGBp-p5Y-y7Zvfe7Bvip53n84 [5] https://stackoverflow. com/questions/23541205/cant-install-python-dev-on-centos-6-5 [6] https://www. evernote. com/l/AQptvLJl0n9OzIm13ajH6X1VrYTsq9DxidE [7] https://stackoverflow. com/questions/12030809/flask-and-uwsgi-unable-to-load-app-0-mountpoint-callable-not-found-or-im [8] https://www. evernote. com/l/AQrMIOSck-VJQ6E5qeo_tsWxMVAJBwiRhoQ [9] https://stackoverflow. com/questions/51396047/running-flask-on-port-80-in-linux [10] https://www. evernote. com/l/AQqJG6XKtOxDtbIggIY2RwH1Mn2U3lcgbdM [11] https://www. tecmint. com/fix-firewall-cmd-command-not-found-error/ [12] https://docs. cades. ornl. gov/#openstack/manage-vm/create-new-security-group/ [13] https://phoenixnap. com/kb/how-to-install-pip-on-centos-8 [14] https://www. evernote. com/l/AQqEzk-6MpBOT5lTrj1N-Viu5MZOEXuT9y4 [15] https://code. ornl. gov/ly0/tsitc/-/tree/master/ [16] https://github. com/celery/celery/issues/6406 [17] https://docs. celeryproject. org/en/latest/userguide/workers. html#revoke-revoking-tasks "
    }, {
    "id": 64,
    "url": "http://localhost:4000/2020-09-25-rsa/",
    "title": "Notes on RSA algorithm",
    "body": "2020/09/25 - Image reproduced from Ref. [9]. In this post, i will note down my learning and understanding for the RSA algorithm. This will not go into deep details about RSA. Instead, only basics will be covered. In fact, most of the discussion presented here has already been covered in the relevant Wiki page: Click Me! Basically, I will just follow the Wiki page and put in my understanding along the way. Specially, when we go into the working example of RSA algorithm, detailed explanation about how the algorithm is realized in practice will be presented, with reference to some outstanding external resources. Finally, a bit understanding will be presented for why encryption and decryption through RSA algorithm is difficult or even impossible to decipher in practice and thus considered to be secure enough nowadays. ☝Keys generation1. Select two prime numbers (p) and (q). 2. Calculate (n = pq). 3. Calculate (\phi(n) = (p-1)(q-1)). 4. Select an integer (e) satisfying 1) (1 &lt; e &lt; \phi(n)) and 2) (e) is co-prime to (\phi(n)). 5. Calculate (d) to satisfy the congruence relation (de \equiv 1 (mod(\phi(n)))).  The congruence relation here reads, (de) and (1) are equivalent in terms of the remainder when divided by (\phi(n)). In this sense, it does not matter that much whether (de) or (1) sits on the left-hand side. (n) and (e) here are the public key that can be shared. (d) is the private key which should be kept securely. There is a question here: what we are generating is actually numbers, but that’s not what we usually see in public or private key file. For example, the example shows a demo for public key, where we actually do not see numbers but rather text. What is the trick here?    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC+Z2085MxeBuiQ77giIgwAjYWID4ze7pUk+Z+ANcWgX479KJPHROjuY7fH6bJ9KoRGqyc3vu72nC6WdLMD6i/p+dTUmAuXyFVlgJNFUeejyRZTWnglNnGxAvB9y5F0LsNHj+fumhKSk8zY+cs8/5JkKyNSCp6VzI7DNjPOQmuMdja9Km2CeLk963aUEvx+bfYB0sPvuQnhOwCmw0bAp68QW048IjKWfZPDZC6gKZBE6udeu+rGLVVsMVCjmMyllfVIajrwAVvevIhSaUVcr02j7Rq9jRDAxbqI6BWXxD7D2oi+eYXic6yE67qbxoYflC2eBHGVgvZRcctDe682aioYBHDXl22f+160KSm6gawYBJmymM7WotOsKpBCyM9d9ghw+U+pkAJXOSqqtuGypGMG3DXJQfO44DyETiL99OgC9g4+cioPxVbXsK/txUoXim1QOG+e91V31TxisSVcZL6JfD2KGAhz5Nuhrgw9fiw37VB8r1fRrwAIh7ztOa/Sakk= y8z@mac117849 In fact, the number generated from the RSA algorithm is stored in the so-called PEM file format, which involves obviously some encoding scheme turning those generated numbers into text for storage. In this following post, there is introduced some other available format for storing public key: Click Me!☝EncryptionFirst, the sender Bob needs to turn message M into a number m using some pre-agreed-upon protocol. Then Bob calculate the ciphered message c to send to the receiver following, [c = m^e\ \ mod\ n] ☝DecryptionWhen the receiver Alice receives the ciphered message c from Bob, she then needs to decode the original message m from c following, [m = c^d\ \ mod\ n] ☝DerivationGiven the way a certain message is encrypted and decrypted mentioned above, we only need to show, [c^d \equiv (m^e)^d \equiv m^{ed} \equiv m\ (mod\ n)]  Here, we need to remind ourselves again about the meaning of the congruence relation - see introduction above. Back to the step of key generation, the values of (e) and (d) were chosen so that, [ed \equiv 1\ (mod\ \phi(n))] Therefore, there exists some integer (k) so that, [ed = k\times\phi(n) + 1] Following that, we have, [\begin{equation}\begin{aligned}m^{ed} &amp; \equiv m^{k\phi(n) + 1}\ &amp; \equiv m\times m^{k\phi(n)}\ &amp; \equiv m\times(m^{\phi(n)})^k\ (mod\ n)\end{aligned}\nonumber\end{equation}] According to Wiki page, we can apply Euler’s theorem here, [m^{\phi(n)}\equiv 1\ (mod\ n)] to arrive at, [m\times (1)^k\equiv m\ (mod\ n)] However, Euler’s theorem actually applies to the situation where we have (m) and (n) involved here should be coprime. But in fact, it seems that (m) and (n) here may not be coprime - since (m) is generated from the message to be sent, which can be arbitrary. Concerning this confusion, here is a good reference for explanation: https://math. stackexchange. com/a/87720. ☝A Working ExampleA working example demonstrating the RSA algorithm is practice is presented in the PDF doc below,  When trying to decrypt the original message (m) from the encrypted message (c), the calculation we need to conduct, as shown in the PDF doc above, (c^{d}\ mod\ n) is usually quite computationally expensive, since the numbers involved in the calculation could be very large in practice. To speed up the calculation speed, the Chinese remainder theorem can be used here. The theorem says,  Suppose (p) and (q) are relatively prime, then (x \equiv a\ (mod\ pq)) if and only if (x\equiv a\ (mod\ p)) and (x\equiv a\ (mod\ q)). To demonstrate how the theorem can be used for message decryption, it is better to go with an example. We take the one given in Ref. [1] - (c = 17639), (d = 11613) and (n = 21829). We are going to calculate (m \equiv 17639^{11613}\ mod\ 21819). If we hold private key, then we know exactly (21829 = 83 \times 263). Therefore, according to the theorem, [m\equiv 17639^{11613}\ mod\ 83,\ \ m\equiv 17639^{11613}\ mod\ 263] Simplifying the first congruence, [\begin{equation}\begin{aligned}m &amp; \equiv 17639^{11613}\ mod\ 83\ &amp; \equiv 43^{11613}\ mod\ 83\end{aligned}\nonumber\end{equation}] where the second line of the simplification comes from the fact that (17639\equiv 43\ mod\ 83). Furthermore, according to Euler’s theorem mentioned above, the calculation can be further simplified, [\begin{equation}\begin{aligned}m &amp; \equiv 43^{51}\ mod\ 83\ &amp; \equiv 58\ mod\ 83\end{aligned}\nonumber\end{equation}] Just to remind ourselves with Euler’s theorem, ’’’For (a), (N) coprime, (a^{\phi(N)}\equiv 1\ mod\ N). ‘’’ Here we have (N = 83) itself is just a prime, and therefore (\phi(83) = 82), where (\phi(N)) is the number of positive integers smaller than (N) and coprime to (N). Therefore, if (N) is a prime, we know for sure [\phi(N) = N - 1] Then we have, [43^{11613}\ mod\ 83 = (43^{82})^{141}\times43^{51}\ mod\ 83 \equiv 1^{141}\times 43^{51}\ mod\ 83] As for how we go from the first line to the second one in the calculation presented above, refer to Ref. [2] for a YouTube demo for a general method. Following the same procedure, we can arrive at the following equation from the other congruent equation mentioned above, [m \equiv 44\ mod\ 263] Assuming (m) can be written as (m = 263x + 44), then we want to find (x) to satisfy, [263x + 44 \equiv 58\ mod\ 83] which can be further simplified to (14x \equiv 14\ mod\ 83). Then we can easily inspect the solution as (x = 1). For general situation of solving the congruent equations, refer to Ref. [3, 4]. ☝RSA for SSH connectionIntroduction about the application of RSA in SSH connection (the so-called ‘asymmetric encryption’) is beyond the topic of current blog. Detailed explanation/introduction can be found in Refs. [5-8]. ☝In brief, why RSA is difficult to hack?From the calculation presented above, we can see that to decrypt the encrypted message by the public key ((n) and (e)), one needs to know (d). To obtain (d), we actually start from (n) - however, knowing (n) is not enough, since it is beyond the capability of modern computer to calculate the two prime factors (p) and (q) from (n). This is the fundamental reason for why RSA algorithm is regarded as being safe enough for encryption and communication between client and server.  References [1] https://www. youtube. com/watch?v=NcPdiPrY_g8 [2] https://www. youtube. com/watch?v=tTuWmcikE0Q [3] https://www. expii. com/t/solving-linear-congruence-ax-b-mod-n-3389 [4] Evernote link to [3]. [5] https://www. hostinger. com/tutorials/ssh-tutorial-how-does-ssh-work [6] https://www. digitalocean. com/community/tutorials/understanding-the-ssh-encryption-and-connection-process [7] https://www. digitalocean. com/community/tutorials/ssh-essentials-working-with-ssh-servers-clients-and-keys [8] https://www. ssh. com/attack/man-in-the-middle [9] https://brosite. org/2020/12/27/the-ftc-is-investigating-data-collection-at-youtube-facebook-and-seven-other-companies/ "
    }, {
    "id": 65,
    "url": "http://localhost:4000/2020-07-27-thermo_2nd/",
    "title": "为什么不能通过让海水不断降温从而获取无尽的能量？",
    "body": "2020/07/27 -        根据热力学第二定律的开尔文表述，不可能从单一热源吸热并全部用来做功而不引起其他变化，从这个角度完全可以说明为什么不能以海水为单一热源，从它获取源源不断的能量并用来做功。到这里似乎问题就已经结束了，但是如果海水并不是体系当中唯一的热源，除此之外还存在另外一个高温热源，如下图所示，       在这种情况下是否能实现通过让海水不断降温将热量传向高温热源从而源源不断的向外输出功？同理可以问类似的一个问题，能否将冰箱在制冷的过程中放出的热量收集起来然后带动热机对外做功，或者干脆带动冰箱自己来实现下一轮的制冷过程，从而实现冰箱自己带动自己制冷进而无限循环下去而不需要外界提供任何能量？两个问题的答案显然都是，不能。如图所示，左半部分代表的是冰箱制冷的过程（也可以代表海水降温向外放热的过程），这里实际上就是热力学第二定律的克劳修斯表述，要想实现热量从低温热源传向高温热源，外界是必须要做功的（图中(W_1)），右半部分对应的是从高温热源收集热量再用来驱动热机对外做功的过程，这里对应的是热力学第二定律的开尔文表述，在驱动热机做功的过程中，是必须要向低温热源（冰箱，或者海水）放出一定的热量的。如果想要实现上面所说的两个永动机，整个图示的过程综合起来最终要满足一个关系：(W_2 &gt; W_1)，因为只有这样才有有效的对外净输出。换句话说，如果这里提到的两个永动机能够对外输出的功还不够让低温热源降温所需要做的功（或者刚好能够提供低温热源降温所需要做的功），那么这个时候此类永动机根本不是“永动”的（因为它无法向外界输出有用功）。针对(W_1=W_2)的情况需要一点特殊说明，这个时候，上面提到的两个永动机理论上是可以“永动”的，只是无法向外界输出功。但是实际上这也是不可能的，因为热机在运转的过程中总是存在各种能量损耗，如果(W_1 = W_2)，那么体系是没有多余的输出来抵消哪怕是丝毫的损耗的，这时永动机也就无法“永动”了。这有点类似于说物体在水平方向不受外力的情况下可以在水平绝对光滑的平面上一直运动下去的，但是实际上绝对光滑的平面是不存在的。同理，没有损耗的热机也是不存在的，因而(W_1=W_2)也是无法保证永动机“永动”的。要满足(W_2 &gt; W_1)，总体上看，如图所示，这就相当于从高温热源放出了((Q_2^{‘} - Q_2) - (Q_1^{‘} - Q_1))的热量全部用来做功而并没有引起其他变化，这与热力学第二定律的开尔文表述是矛盾的，所以上面提到的两个永动机都是不可能存在的。 "
    }, {
    "id": 66,
    "url": "http://localhost:4000/2020-07-22-temperature/",
    "title": "Notes On Temperature",
    "body": "2020/07/22 - 📌Introduction - What is temperature?By temperature ((T)), we could mean simply the ‘hotness’ of something, i. e. as always the case in our daily life, the higher (T) of an object, the hotter it is. But in physics, when we say temperature, we could also mean a parameter that is shared between systems when they reach equilibrium, in terms of heat flow. Quite often, these two specific meanings of temperature agree with each other. For example, in terms of heat flow, the natural (by which we mean no extra work needs to be done for it to happen, naturally) direction of heat flow will always be from hotter object (thus with higher (T)) to colder (thus with lower (T)) one. As heat flows out of the hotter object, its temperature (now, we mean ‘temperature’ by its first definition as given above) will decrease, and vice versa for the colder object. This process will continue until these two objects in question reach equilibrium ‒ they now share the same temperature and now, we mean ‘temperature’ by its second definition as given above. 📌Why is that we will never touch 0 K? Or, what does 0 K really mean? Concerning the first way of defining temperature, to get its definite value, one needs to set up a scale first. Usually, such systems will be used as the indicator of temperature that they respond differently and definitely to different temperature magnitude (i. e. the extent of hotness). For example, mercury will expand differently at different temperature so conventionally it is used as the medium of thermometer. Though thermometers like those made of mercury are used commonly, their disadvantage from the perspective of physics is obvious ‒ the definition of temperature scale depends on the properties of particular matter that is used as the medium for measuring temperature. Here, by ‘properties of matter’, we mean basically the amount of heat flow, given certain increase or decrease of temperature of the matter in question. Lord Kelvin then developed the idea of defining an absolute scale of temperature, vis a vis the uniqueness of temperature value in terms of heat flow [1]. The idea was originated from Carnot’s theory on ideal gas engine, whereby we have the relationship between the heat flow (in between working matter of high and low temperature) and temperature of working matters as follows, [\frac{Q_1}{Q_2} = \frac{T_1}{T_2}] Kelvin’s ideas was that if following Carnot’s principle of ideal engine to define temperature, it will be on an absolute scale then since as shown in the equation above, the heat flow only depends on the temperature of the working matter but nothing else. Saying this in another way, if we are using some other temperature scales (e. g. the mercury one and some other similar ones), the equation above will not simply hold universally in between the situations where different scale is used. Knowing what we mean by absolute scale of temperature, we then need to know how we can obtain its value. To do this, we need to first know a fact that the absolute scale of temperature defined by Kelvin is identical to that defined on a special working matter ‒ among all the possible working matters that we can choose to use ‒ the ideal gas. The proof of this can be found in Ref. [2] (page 35-36). Then suppose we use (T) to represent the temperature, of ideal gas, in absolute scale and we have a parameter (b) for the transformation between absolute scale and conventionally used temperature scale (e. g. the Celsius scale), we then have the following famous expression (ideal gas law), [PV = nR(T - b)] where, as we already know, (R) is a constant. Now suppose we fix our volume and the amount of matter in question (i. e. (n) in the equation above), we can then measure the change of pressure (P) versus the change of temperature (T). The constant (R) can thus be estimated. Once we know (R), we then proceed to seek for the zero point in the absolute scale - where the pressure goes to absolute 0 (which means all atoms are then staying statically and not moving) - by simply extrapolating the (P)-((T-b)) line from whatever ([P_x, (T_x - b)]) point we measured the system at, to ((0, 0)). That is to say, [b = T_x - \frac{P_xV}{nR}] Originally, the value of (b) was calculated to be around (237. 15) [3]. In 1954, the resolution 3 of the 10th CGPM meeting defines one unit (K) of temperature in absolute scale equals (1/237. 16) the interval between absolute (0) and the temperature of triple-phase point of water [4]. Hereby, we know the reason why the absolute (0) is EXACTLY (-273. 15) degree in Celsius: the temperature of water triple point is DEFINED to be (0. 01) degree in Celsius and also DEFINED to be (273. 16) degree in absolute scale, which means simply the (0) degree in Celsius is EXACTLY (273. 15) degree in absolute scale. Back to the question in the section title - why we can never reach absolute (0)? As discussed above, (0) (K) is an assumed state with pressure of (0) and is proposed mathematically by extrapolating the ideal gas equation to (0) (K). In the assumed state, since we will have pressure to be (0), we will then have all atoms staying statically, which is obviously impossible - fundamentally due to the Heisenberg uncertainty principle. 📌But, why do we have negative temperature?Now we know why absolute zero can never be reached, but sometimes we will come across negative temperature in literature. Wait…what??? We just said (0) (K) is even impossible, how will it be possible that we have negative temperature? To get an idea about negative temperature, we need turn back to the definition of temperature again, as we have already mentioned at the very beginning of this blog. Up until now, we haven’t talked about the second approach of defining temperature mentioned there ‒ temperature defined as the parameter shared in between systems in equilibrium. To discuss negative temperature, that’s something we have to go for now. Suppose we have an isolated system containing two subsystems. The overall number of particles and energy of the whole system will be kept as constants, i. e. we have a microcanonical ensemble. Say we have the overall energy of the whole system to be (E) and the two subsystems are with energy of (E_1) and (E_2), respectively, we should then have (E = E_1 + E_2). Our question is then when, or in what condition can we say the two subsystems are in an equilibrium state, in terms of heat flow. Since we have an overall microcanonical ensemble, we know that the equilibrium state will be the one with maximum number of microstates. The total number of microstates of the overall system is given as, [N(E_1, E_2) = N_1(E_1)\times N_2(E_2)] where we have (E_1) and (E_2) as our variables of the function of microstates number, with the constraint that, as we mentioned above, (E = E_1 + E_2). Going a bit further, a famous quantity is defined to describe the number of states ‒ entropy, which originated from Boltzmann. In fact, entropy ((S)) is nothing but taking the log of total number of states of the system in question, to within a multiplicative constant ‒ Boltzmann constant (k_B). Now, the entropy of the overall system mentioned here in the context can be expressed as, [S(E_1, E_2) = k_Bln[N(E_1, E_2)]] From the discussion above, we know that when the two subsystems reach equilibrium, we will have (S) to be stationary, with regard to infinitesimal change in (E_1) and/or (E_2), i. e. , [\begin{equation}\begin{aligned}dS &amp; = dS_1 + dS_2\ &amp; = \big(\frac{dS_1}{dE_1}\big)dE_1 + \big(\frac{dS_2}{dE_2}\big)dE_2\ &amp; = \big(\frac{dS_1}{dE_1}\big)dE_1 - \big(\frac{dS_2}{dE_2}\big)dE_1\ &amp; = \big(\frac{dS_1}{dE_1} - \frac{dS_2}{dE_2}\big)dE_1 = 0\end{aligned}\nonumber\end{equation}] Here there are two things to mention about the derivation. First, for the first line in the equation above, we have, [\begin{equation}\begin{aligned}S &amp; = k_Bln[N(E_1, E_2)]\ &amp; = k_Bln[N_1(E_1)\times N_2(E_2)]\&amp; = k_Bln[N_1(E_1)] + k_Bln[N_2(E_2)]\ &amp; = S_1 + S_2\end{aligned}\nonumber\end{equation}] The second thing is from the 3rd to 4th line in the same equation. Here we need to recall that (E = E_1 + E_2) is kept as a constant, and therefore we have, [dE = dE_1 + dE_2 = 0 \Rightarrow dE_2 = -dE_1] Then from the equation (dS = 0) given above, we will have, [\frac{dS_1}{dE_1} - \frac{dS_2}{dE_2} = 0 \Rightarrow \frac{dS_1}{dE_1} = \frac{dS_2}{dE_2}] Till here, we arrive at a quantity that is shared between two systems in equilibrium, which then becomes our theoretical definition for temperature (T), [T = \frac{dS}{dE}] For most systems, when its energy increases, the entropy will also increase ‒ as we pump energy into a system, the overall energy of atoms (or whatever building block of the system) within the system will increase. This will create more possibilities for the system, i. e. the number of states will increase as the result of energy increase. Therefore, in most cases, our definition for (T) will get a positive value. However, this may not be the case of some spin systems. Suppose we have (N) spins existing in magnetic field. The ground state will be that all spins pointing along the direction of the magnetic field (ignoring spin-orbital coupling for the moment), say, spin-up direction. As we flip over one spin from spin-up to spin-down, the system energy will for sure increase. As for entropy, flipping over one spin will change the entropy from (S = k_Bln1 = 0) to (S = k_BlnC_N^1 = k_BlnN), where we also have entropy increasing as the result of the spin flip-over. As we continue to flip over spins one by one, the increase of energy will continue. However, the increasing of entropy will stop when we reach the turning point of (C_N^j) function (of (j)), where (j) is the number of flipped-over spins ‒ (j = N/2) if (N) is an even number and (j = (N\pm 1)/2) if (N) is an odd number. Going over the turning point, the entropy will decrease as we continue to flip over spins. In this case, according to the definition of the theoretical temperature, (T) will become negative. Furthermore, it should be pointed out that the negative temperature system is actually hotter than the positive temperature system. What does that mean? Imagine two systems touching each other, one of them is with negative temperature, and the other one with positive temperature. Now if energy flows from the negative-(T) system to the positive-(T) system, what will happen? The number of microstates (i. e. the entropy (S)) of the whole system will increase. Why? For negative-(T) system, when energy was taken away from it, (S) will increase since for negative-(T) system, entropy increases as the decreasing of energy. Similarly, the accepting of extra energy for the positive-(T) system will also lead to the increase of entropy, since for positive-(T) system, entropy increases as the increasing of energy. Therefore, when negative- and positive-(T) systems touch each other, the energy naturally tends to flow from the negative to the positive one, to maximize the entropy (thus to reach a more stable overall state) ‒ till the whole system reaches its equilibrium.  References [1] Lord Kelvin (William Thomson), On an Absolute Thermometric Scale. Philosophical Magazine October 1848 [from Sir William Thomson, Mathematical and Physical Papers, vol. 1 (Cambridge University Press, 1882), pp. 100-106. ] [2] 汪志诚，热力学(\cdot)统计物理（第四版），高等教育出版社。 [3] Q &amp; A on Zhihu, https://www. zhihu. com/question/54691426. [4] https://www. bipm. org/en/CGPM/db/10/3/. "
    }, {
    "id": 67,
    "url": "http://localhost:4000/2020-07-06-occ_order/",
    "title": "Notes on occupational short-range ordering in crystal",
    "body": "2020/07/06 - When multiple atomic species (including vacancies) coexist on the same crystallographic site, it immediately brings up a question - say, we have species A and B sharing the same site, then do we have clustering of A and B in separate domains, or do we have A and B preferring to stay together, or do we have random distribution of A and B? This is usually what we mean by short-range order (SRO) and what we have mentioned here is specifically the occupational SRO (one can find introduction about more types of SRO in Chapter-10 in Ref. [1]). Detailed theoretical description about SRO can be found in Refs. [1-3] - the early paper by J. M. Cowley [2] gives the definition of SRO for binary systems; the one by D. De Fontaine [3] extends the definition to multi-component system (to give the so-called pairwise multi-component SRO, i. e. PM-SRO); the book by R. B. Neder and T. Proffen presents in details practical implementation and calculation of SRO, in DISCUS framework. Here I am not going to reproduce what has been covered in Refs mentioned here. Instead, only two main aspects, which I think is crucial for understanding the topic, will be recovered here.  In current blog, when we say SRO, we mean the Warren-Cowley (WC, or WC-like) coefficient. 📌SRO in terms of one-to-one connection VS shell Taking the simple binary system shown above as an example, we have two types of atoms here - A and B. When we say SRO, we may mean the correlation between specific sites (left part of the picture above). For example, if we want to calculate the correlation between A and B along the [10] direction with A as the center, the only connection we have here is from A2 to B3, and vice versa for B (but now we focus on the connection along [-10] and the only connection we have here is from B3 to A2). In this case, the calculation for SRO is given as,For A(\rightarrow)B, [\alpha_{AB} = 1 - \frac{\bar{P}_{AB}}{c_B} = 1 - \frac{\frac{0+1}{2}}{\frac{3}{5}} = \frac{1}{6}] For B(\rightarrow)A, [\alpha_{BA} = 1 - \frac{\bar{P}_{BA}}{c_A} = 1 - \frac{\frac{0+0+1}{3}}{\frac{2}{5}} = \frac{1}{6}] from which one can see the SRO with either A or B as the centering atom simply agrees with each other in quantity. Fundamental reason for this is that concerning the correlation along a certain direction, we have a one-to-one connection between A and B in question. This is exactly the case discussed in Ref. [2], concerning the pairwise correlation between species (the definition is not restricted to binary systems there). However, when we say SRO, we could also mean the correlation in terms of shells, like shown in the right side of the picture above. In this case, the calculation for SRO changes to,For A(\rightarrow)B, [\alpha_{AB} = 1 - \frac{\bar{P}_{AB}}{c_B} = 1 - \frac{\frac{0+\frac{3}{4}}{2}}{\frac{3}{5}} = \frac{3}{8}] For B(\rightarrow)A, [\alpha_{BA} = 1 - \frac{\bar{P}_{BA}}{c_A} = 1 - \frac{\frac{1+1+1}{3}}{\frac{2}{5}} = -\frac{3}{2}] Since in this case, the connection between A and B in terms of coordination shells is no longer a one-one-one connection, we therefore no longer necessarily have the result of SRO with A or B as the centering atom being equal to each other. 📌The limit value of SROAccording to the definition of SRO, [\alpha_{AB} = 1 - \frac{P_{AB}}{c_B}] (P_{AB}) means the probability of find B around A, and (c_B) is the number concentration of B. Given fixed (c_B), the limit value of (\alpha_{AB}) is determined by (P_{AB}) which we know is a probability and therefore will range from 0 to 1 in theory. However in practice, we should have the following restriction for the value that (P_{AB}) can take, [P_{AB}\times N_A \leq N_B \Rightarrow P_{AB}\leq \frac{N_B}{N_A}] where (N_A) and (N_B) refers to the total number of atoms of type A and B in the system, respectively. Then accordingly, we have, [\alpha_{AB} = 1 - \frac{P_{AB}}{c_B}\geq 1 - \frac{\frac{N_B}{N_A}}{\frac{N_B}{N_A + N_B}} = -\frac{N_B}{N_A}] As the result of (P_{AB}) potentially not reaching its theoretical limit of 1, (\alpha_{AB}) may have a floor higher than its theoretical limit, accordingly. On the other side, we simply have, [P_{AB} \geq 0] and therefore, [\alpha_{AB} = 1 - \frac{P_{AB}}{c_B} \leq 1] References [1] R. B. Neder and T. Proffen. Diffuse Scattering and Defect Structure Simulations: A Cook Book Using the Program DISCUS. Oxford University Press. (2008). [2] J. M. Cowley. Phys. Rev. 77, 5. (1950). [3] D. De Fontaine. J. Appl. Cryst. 4, 15. (1971). "
    }, {
    "id": 68,
    "url": "http://localhost:4000/2020-07-04-sublime/",
    "title": "Notes on Sublime Text 3",
    "body": "2020/07/04 -  For many packages installed in Sublime Text 3, either we can configure the key bindings for executing available commands by going to ‘Preferences’(\rightarrow)‘Key Bindings’, or we can go to the package specific key binding setting section. However, sometimes, we don’t have a dedicated key binding setting section for some of the installed package, e. g. ‘Google Search’ package. In this case, it becomes a headache to set the key binding since we don’t even know what commands are actually available there. To get an idea about what commands are available for such types of packages, we can go to ‘%APPDATA%\Sublime Text 3\Installed Packages’ directory (taking Windows OS as an example) and find the package file, e. g. ‘Google Search. sublime-package’. This file is just a zip file which contains all the necessary stuff of the installed package. Therefore, we can copy it to somewhere and change the file name extension to ‘. zip’ and open the package with whatever available zip file manager program to inspect the content of the package. Within the package, we can find the file ‘Default (Windows). sublime-keymap’ (again, taking Windows OS as an example). Opening the file, we can see what command are actually available there and then we can go to ‘Preferences’(\rightarrow)‘Key Bindings’ in Sublime Text 3 to assign new key bindings, if necessary. "
    }, {
    "id": 69,
    "url": "http://localhost:4000/2020-06-28-fourier_transform/",
    "title": "When Fourier transform meets total scattering",
    "body": "2020/06/28 -  In this article, I am going to note down my bits of understanding for the role that Fourier transform is playing in total scattering regime. Quite often we hear people talking about real space or reciprocal space representation of the total scattering signal. Also, it’s probably a common sense that the two spaces are coupled by Fourier transform. But if pulling ourselves out of those technical details for the moment and think about why Fourier transform comes into play in total scattering regime in the first place, sometimes we may find ourselves in a situation like ‘um…but…why?’Before diving into the specific total scattering topic, I will first mention a little bit background about Fourier transform. Here I will not try to reproduce details about it from head to toe, since obviously a simple Googling will guide us to tons of available resources about such a topic. Therefore, there is no need at all to reinvent the wheel. Instead, I will pick up a very interesting visualization of Fourier transform that I came across on YouTube and try to reproduce it here as an intro before going into my topic. Also, I will recover two little pieces of problems that I encountered during learning total scattering. They are not crucial for understanding the topic but I think it’s always good to stop and think why, instead of just accepting them as being granted. So, first lets start with the visualization of Fourier transform mentioned above. As I said, I first came across this fantastic visualization in a YouTube video, which one can check out here: Click Me! The original post can be found in the blog titled Purrier Series (Meow) and Making Images Speak, in which Mathematica was used to generate those fabulous animations. Also, mathematical formulation can be found either in the post mentioned here or the link here: Click Me! Here, I took the same idea and make a simple reproduction of two simple animations with Python, just as a practice. What we are transforming here is a square function and only the first two components are considered here. The transformation involving only the first component is like this: Then the first and third components are involved: The Python script used to generate the two animations above is reproduced as follows (one needs numpy and matplotlib to run it):  Copy snippet to clipboard!   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246import numpy as npimport matplotlib. pyplot as pltimport matplotlib. animation as animation# Function to be used as the updator for first Fourier component. # Here we have,# 'line'  for rotating bar# 'line1'  for scanning bar moving up and down# 'line2'  for plotting the first Fourier component. # 'line3'  for plotting the original square function. def update_line_1(num, xy_plot, line, line1, line2, line3):  line. set_data([-2, xy_plot[num - 1][0]], [0, xy_plot[num - 1][1]])  line1. set_data([xy_plot[num - 1][0], 0],          [xy_plot[num - 1][1], xy_plot[num - 1][1]])  # x2_temp = [item[0] for item in xy1_plot[:num]]  # y2_temp = [item[1] for item in xy1_plot[:num]]  x2_temp = [item[0] for item in xy1_plot[num]]  y2_temp = [item[1] for item in xy1_plot[num]]  line2. set_data(x2_temp, y2_temp)  x2_temp = [item[0] for item in xy_line_plot[num]]  y2_temp = [item[1] for item in xy_line_plot[num]]  line3. set_data(x2_temp, y2_temp)  return line, line1, line2, line3# Function to be used as the updator for first and third Furier component. # Here we have,# 'line'  for rotating bar indicating the first component. # 'line1'  for scanning bar moving up and down. # 'line2'  for plotting the first and third Fourier components. # 'patch1' for rotating circle indicating the third component. # 'line3'  for the center of the rotating circle (again, indicating the#      third component). # 'line4'  for the rotating bar indicating the third component. # 'line5'  for plotting the original square function. def update_line_3(num, xy_plot, line, line1, line2,         patch1, line3, line4, line5):  line. set_data([-2, xy_plot[num - 1][0]], [0, xy_plot[num - 1][1]])  line1. set_data([xy_plot_1[num - 1][0], 0],          [xy_plot_1[num - 1][1], xy_plot_1[num - 1][1]])  x2_temp = [item[0] for item in xy3_plot[num]]  y2_temp = [item[1] for item in xy3_plot[num]]  line2. set_data(x2_temp, y2_temp)  patch1. center = (xy_plot[num - 1][0], xy_plot[num - 1][1])  patch1. radius = 4. 0 / 3. 0 / np. pi  ax2. add_patch(patch1)  line3. set_data([xy_plot[num - 1][0]], [xy_plot[num - 1][1]])  line4. set_data([xy_plot[num - 1][0], xy_plot_1[num - 1][0]],          [xy_plot[num - 1][1], xy_plot_1[num - 1][1]])  x2_temp = [item[0] for item in xy_line_plot[num]]  y2_temp = [item[1] for item in xy_line_plot[num]]  line5. set_data(x2_temp, y2_temp)  return line, line1, line2, patch1, line3, line4, line5fig1, ax1 = plt. subplots()ax1. set_aspect('equal')ax1. spines[ bottom ]. set_linewidth(2)ax1. spines[ top ]. set_linewidth(2)ax1. spines[ left ]. set_linewidth(2)ax1. spines[ right ]. set_linewidth(2)ax1. tick_params(direction='out', length=6)# The static circle indicating the first component. circle = plt. Circle((-2, 0), 4 / np. pi, color='red', fill=False)ax1. add_artist(circle)# The rotating circle indicating the third component. patch1 = plt. Circle((0, 0), 0. 0, fc='y')# Plot some indicator ticks for the graph. plt. plot(-2, 0, '-o', color='gray',     markersize=5, linewidth=4,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([0, 0], [-2, 2],     '-', color='black',     markersize=5, linewidth=2,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [0, 0],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [1, 1],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [-1, -1],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)# Generating data for plotting. x_temp = np. linspace(0, 4. 0, 500)# First, the rotating bar indicating the first component. xy_plot = []for i in range(len(x_temp)):  xy_plot. append([4. 0 / np. pi * np. cos(np. pi / 2. 0 * x_temp[i]) - 2. 0,          4. 0 / np. pi * np. sin(np. pi / 2. 0 * x_temp[i])])# Then, the rotating bar indicating the third component. For this one,# the origin is rotating as well. xy_plot_1 = []for i in range(len(x_temp)):  center_1 = [-2. 0, 0]  center_2 = [4. 0 / np. pi * np. cos(np. pi / 2. 0 * x_temp[i]),        4. 0 / np. pi * np. sin(np. pi / 2. 0 * x_temp[i])]  ending = [4. 0 / np. pi / 3. 0 * np. cos(3. 0 * np. pi / 2. 0 * x_temp[i]),       4. 0 / np. pi / 3. 0 * np. sin(3. 0 * np. pi / 2. 0 * x_temp[i])]  xy_plot_1. append([center_1[0] + center_2[0] + ending[0],           center_1[1] + center_2[1] + ending[1]])# Moving square function. xy_line_plot = []for i in range(len(x_temp)):  xy_line_plot. append([])  for j in range(len(x_temp)):    t_part = np. pi / 2. 0 * x_temp[i]    x_part = np. pi / 2. 0 * x_temp[j]    y_temp = np. sign(np. sin(t_part - x_part))    xy_line_plot[i]. append([x_temp[j], y_temp])# Function of the first component. xy1_plot = []for i in range(len(x_temp)):  xy1_plot. append([])  for j in range(len(x_temp)):    t_part = np. pi / 2. 0 * x_temp[i]    x_part = np. pi / 2. 0 * x_temp[j]    y_temp = 4 / np. pi * np. sin(t_part - x_part)    xy1_plot[i]. append([x_temp[j], y_temp])# Function of the third component. xy3_plot = []for i in range(len(x_temp)):  xy3_plot. append([])  for j in range(len(x_temp)):    t_part_1 = np. pi / 2. 0 * x_temp[i]    x_part_1 = np. pi / 2. 0 * x_temp[j]    t_part_3 = 3. 0 * np. pi / 2. 0 * x_temp[i]    x_part_3 = 3. 0 * np. pi / 2. 0 * x_temp[j]    y_temp_1 = 4 / np. pi * np. sin(t_part_1 - x_part_1)    y_temp_2 = 4. 0 / np. pi / 3. 0 * np. sin(t_part_3 - x_part_3)    xy3_plot[i]. append([x_temp[j], y_temp_1 + y_temp_2])# Initialize and update the animation. First, we include only first# Fourier component. l, = plt. plot([], [], 'r-')l1, = plt. plot([], [], 'r-')l2, = plt. plot([], [], 'r-')l3, = plt. plot([], [], 'k-')plt. xlim(-5, 5)plt. ylim(-2, 2)line_ani_1 = animation. FuncAnimation(fig1, update_line_1, 500,                   fargs=(xy_plot, l, l1, l2, l3),                   interval=5, blit=True)# Then we add in the third component (the components of even number# are all 0). fig2, ax2 = plt. subplots()ax2. set_aspect('equal')ax2. spines[ bottom ]. set_linewidth(2)ax2. spines[ top ]. set_linewidth(2)ax2. spines[ left ]. set_linewidth(2)ax2. spines[ right ]. set_linewidth(2)ax2. tick_params(direction='out', length=6)circle = plt. Circle((-2, 0), 4 / np. pi, color='red', fill=False)ax2. add_artist(circle)patch1 = plt. Circle((0, 0), 0. 0, color='blue', fill=False)# Plot some indicator ticks for the graph. plt. plot(-2, 0, '-o', color='gray',     markersize=5, linewidth=2,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([0, 0], [-2, 2],     '-', color='black',     markersize=5, linewidth=2,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [0, 0],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [1, 1],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)plt. plot([-0. 25, 0], [-1, -1],     '-', color='black',     markersize=5, linewidth=1,     markerfacecolor='black',     markeredgecolor='black',     markeredgewidth=2)l, = plt. plot([], [], 'r-')l1, = plt. plot([], [], 'b-')l2, = plt. plot([], [], 'b-')l3, = plt. plot([], [], '-o', color='gray',        markersize=5, linewidth=2,        markerfacecolor='black',        markeredgecolor='black',        markeredgewidth=2)l4, = plt. plot([], [], 'b-')l5, = plt. plot([], [], 'k-')plt. xlim(-5, 5)plt. ylim(-2, 2)line_ani_3 = animation. FuncAnimation(fig2, update_line_3, 500,                   fargs=(xy_plot, l, l1, l2, patch1,                      l3, l4, l5),                   interval=5, blit=True)# Save the animation to movie file. For some reason, saving to# GIF file won't allow us to change the FPS and the whole animation# will become very slow. Therefore, we save the animation first as# MP4 file and use the online converter to transform to GIF file:# https://ezgif. com/line_ani_1. save('first_component. mp4', fps=250, dpi=300)line_ani_3. save('third_component. mp4', fps=250, dpi=300)plt. show()Next, I will briefly talk about the two problems about Fourier transform that I mentioned earlier. 📌The (1/2\pi) factor appearing in the inverse Fourier transformUsually, the Fourier transform of function (f(x)) is defined as, [F(f) = \int_{-\infty}^{\infty}f(x)e^{-2\pi i xf}dx] The inverse Fourier transform will then be symmetrically and nicely given as, [f(x) = \int_{-\infty}^{\infty}F(f)e^{2\pi i xf}df] according to the Fourier inversion theorem. However, quite often we will see an extra factor (1/2\pi) in front of the inverse Fourier transform. So the natural question is - why do we have an extra factor there? Why do we not stay with the nice and symmetric form of forward and inverse Fourier transform? The reason is simply due to the using of angular frequency ((\omega)) instead of frequency ((f)) as the independent variable in Fourier space. The relation between these two variables is simply, [\omega = 2\pi f] Using (\omega) as our Fourier space variable, one has the forward Fourier transform as, [\hat{F}(\omega) = F(\frac{\omega}{2\pi}) = \int_{-\infty}^{\infty}f(x)e^{-i\omega x}dx] where the symbol (\hat{F}) is used to represent the functional form with (\omega) as the independent variable, in contrast to the symbol (F) with (f) as the independent variable. Accordingly, the inverse Fourier transform will be given as, [f(x) = \int_{-\infty}^{\infty}F(f)e^{2\pi i xf}df = \int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d(\frac{\omega}{2\pi}) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d\omega] from which one can clearly see the popping up of the extra factor (1/2\pi). 📌Discrete Fourier transformThe definition of Fourier transform given above is in its continuous format, whereas in practice the signal we hold in hand will never be continuous. Unlike the continuous version of Fourier transform (of which the definition is unique, as given above), we need to first pin down what we really mean by discrete Fourier transform. Suppose we have a series of data measured to be (0. 1, 100), (0. 12, 101), (0. 15, 300), (0. 16, 321), …, where the first number in each pair represents our variable (say, time (t)) and the second one is our response (say, voltage (V)), then how do we proceed to do the Fourier transform? This is where the definition of discrete Fourier transform is introduced. According to Wikipedia, we have,  in mathematics, the discrete Fourier transform (DFT) converts a finite sequence of equally-spaced samples of a function into a same-length sequence of equally-spaced samples… Therefore, for the example given above (and also in the case of total scattering as we will see later), one needs to first group the measured data into bins with equal width and then carry out the discrete Fourier transform as defined (see, e. g. , Wikipedia for the exact definition).  ========================I AM A SEPARATOR======================== Finishing the preparation work, we now move on to discuss the reflection of Fourier transform in total scattering regime. First of all, what is total scattering? Scattering is scattering, but what do we mean by ‘total’? Does it mean that not mentioning ‘total’ in the context indicates we are missing something? The answer is YES. But what do we miss?In terms of scattering experiment, either with X-ray, neutron or electron, what we usually mean by ‘scattering’ is actually the Bragg reflection, in which we are specially concerned about the reflection from atom planes. The underlying rule is the famous Bragg’s law, [2dsin(\theta) = n\lambda] The common approach for analyzing Bragg pattern then focuses on the positions and intensities of those reflection peaks, which is fundamentally determined by atomic structure of material under radiation beam. Structures extracted in such a way is what we usually call as average structure. To go beyond the Bragg reflection and talk about total scattering, we need to dig into the base level of the scattering event. We already know that Bragg reflection originates from the scattering from atom planes. This is fundamentally owing to the in-phase reflection of the incoming beam from group (certain lattice plane) of atoms, leading to the overall enhanced interference effect. In that sense (and also in fact), the scattering event actually happens on the atomic level (to be more precise, X-ray interacts with electrons surrounding atoms, neutron interacts with nuclei, electron’s interaction with materials being complicated). Accordingly, the normalized (over all (N) atoms in the system) scattering intensity is given as, [\frac{1}{N}\frac{d\sigma}{d\Omega} = \frac{1}{N}\sum_{j,k}b_jb_kexp[i\mathbf{Q}\cdot(\mathbf{r}_j - \mathbf{r}_k)]] with the dimension of area ((\sigma) for cross section, (\Omega) for solid angle, (b) for scattering length (form factor in the case of X-ray scattering), (\mathbf{Q}) for scattering vector, (\mathbf{r}) for atomic position). Given the incoming flux of incoming beam (e. g. number of neutrons) per area, the product is equal to the flux of scattered beam per solid angle, which can then be equated to the experimental measurement. From the formulation given right above, one can see that the Bragg peak positions are only some special points in reciprocal space (i. e. (Q)-space). When only focusing on those special points in (Q)-space and ignoring all the other (Q) points (in practice, all the points other than those special ones are treated as background, in, e. g Rietveld refinement), no doubt one will lose a lot of useful information from the scattering measurement! By bringing back those ignored (Q) points, we will have the total scattering pattern, enabling us to retrieve those missing information - the local structure - in conventional Bragg data analysis. This is where Fourier transform comes to play an important role, which is what we will cover right next. For the following discussion, we refer ourselves to the book by M. Dove [1] (see Appendix-J in the book for detailed derivations), with several key aspects recovered in current context. First, by pulling out all the self-terms, one arrives at, [\frac{1}{N}\frac{d\sigma}{d\Omega} = F(Q) + \sum_ic_ib_i^2] in which (F(Q)) can be further expressed as, [F(Q) = \rho\sum_{j,k}c_jc_kb_jb_k4\pi\int_{0}^{\infty}r^2g_{jk}(r)\frac{sin(Qr)}{Qr}dr] where (c) represents the proportion of atoms of each type, (\rho) refers to the overall number density of the system, and the term (sin(Qr)/Qr) comes from the isotropic orientational average of (\langle exp[i\mathbf{Q}\cdot(\mathbf{r}_j - \mathbf{r}_k)]\rangle). It’s worth mentioning that the following part in the definition of (F(Q)) gives the average number of atoms of type (k) within the shell (r\rightarrow r+dr) surrounding atoms of type (j), [\rho c_k4\pi r^2g_{jk}(r)dr] while (c_j) in the definition of (F(Q)) fundamentally comes from the normalization over the total number of atoms ((N)) in the system. The logic here is that we treat all inter-atomic distances within the range (r\rightarrow r+dr) to be the same and we count the number of atomic pairs with such a distance and multiply that number to the phase factor (in this case, (sin(Qr)/Qr)). Saying that, we are still doing the same thing as given in the original formation of the normalized scattering intensity above. The difference here is we group distances falling into the same bin together, instead of calculating every single possible distance individually and explicitly. This is the fundamental reason why calculating the reciprocal space total scattering pattern following the Debye approach (see Eqn. 4. 9 in the book by R. Neder and T. Proffen [2]) and the Fourier transform approach (as we will see next) should give very similar result (slight difference may pop up due to the difference between considering each pair explicitly and binning similar distances). Furthermore, by defining a new function, [G(r) = \sum_{j,k}c_jc_kb_jb_k[g_{jk}(r) - 1]] the function (F(Q)) can be further expressed as, [QF(Q) = \rho\int_{0}^{\infty}4\pi rG(r)sin(Qr)dr] from which one can clearly see that (QF(Q)) and (rG(r)) are linked by Fourier transform. Here we have the real version of Fourier transform, since the scattering measurement are measuring intensity only but not the phase and therefore we lose the phase information. Theoretically, accordance with such an experimental fact during our derivation for the scattering intensity dates back to Eqn. 6. 22 in M. Dove’s book [1], where the square of the phase shift instead of the phase shift itself is used to reproduce the experimental scattering intensity. As the partner equation of the one given just above, one has, [rG(r) = \frac{1}{(2\pi)^3\rho}\int_{0}^{\infty}4\pi QF(Q)sin(Qr)dQ] Here, the reason why we have (1/(2\pi)^3) term in the pre-factor is just that presented in early part of current blog. Specifically, the definition of (Q) is analogous to the angular frequency (\omega) we mentioned before, since we have (Q = 2\pi/d) where (1/d) is analogous to the frequency (f) we have before. Analogously, we can call (1/d) the space frequency and (Q) the space angular frequency. The cubic exponential in (1/(2\pi)^3) is coming from the fact that we have a 3D space and therefore naturally the factor (1/2\pi) should appear three times. 📌About maximum (r) or (Q)Given a certain (r) or (Q) grid, one question one may ask is what is the corresponding maximum (Q) or (r) that we can reach - we know resolution in one space corresponds to the spanning range in the coupled space. However, how to quantify such a coupled relation is a question and this is to be covered next. Given the relation (Q = 2\pi/d), it may be straightforward to tell that (Q_{range} = 2\pi/\Delta d), where (Q_{range}) refers to the (Q)-space coverage range and (\Delta d) is the (d)-space interval between nearest points. However, this is INCORRECT and the CORRECT version should be, [Q_{range} = \pi/\Delta d] Similarly one has, [d_{range} = \pi/\Delta Q] where ‘range’ and (\Delta) carries the same meaning as mentioned above. So the question is, why do we miss the factor ‘2’ there? The fundamental reason for this is, in the Fourier transform space, alongside with the positive frequency, we also have the corresponding negative frequency and the negative frequency part is simply a mirror image of the positive part. Taking the Fourier transform from (d)- to (Q)-space as an example, the existence of mirroring to negative frequency means the actual (Q)-space coverage is (2Q_{range}) and therefore we cancel out the factor ‘2’ on both sides of the equation to give us (Q_{range} = \pi/\Delta d). So, next, we should spend a bit time to understand what negative frequency is and why we have it. Going back to the definition of Fourier transform presented above (e. g. , the angular frequency case), we see that (\hat{F}(\omega)) is defined over the whole (\mathcal{R}) axis - this means definitely we will have negative frequency. Giving it a closer look, we have, [\begin{equation}\begin{aligned}\hat{F}(\omega) &amp; = \int_{-\infty}^{\infty}f(x)e^{-i\omega x}dx\ &amp; = \int_{-\infty}^{\infty}f(x)cos(\omega x)dx - i\int_{-\infty}^{\infty}f(x)sin(\omega x)dx\ &amp; = A(\omega) - iB(\omega)\end{aligned}\nonumber\end{equation}] When changing (\omega) to (-\omega), we know that (cos) function will not change while (sin) function will become negative. Therefore, we have, [\hat{F}(-\omega) = A(\omega) + iB(\omega)] so that we know the positive and negative frequency is not independent which means in fact the negative frequency does not bring in anything new to our signal. So why do we still have negative frequency? Why don’t we change the definition domain for (\hat{F}(\omega)) to be ([0, \infty))? The reason is, with (\hat{F}(\omega)) being defined on the full (\mathcal{R}) axis, the inverse Fourier transform of (\hat{F}(\omega)) will give real function which has physical meaning (since simply the observable signal in practice should be real). To see this, we need to revisit the inverse Fourier transform, [f(x) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{F}(\omega)e^{ix\omega}d\omega] where (\hat{F}(\omega)) is complex according to the definition of Fourier transform, and therefore, we can write,       [\hat{F}(\omega) =   \hat{F}(\omega)   e^{i\phi(\omega)}]   where (|\hat{F}(\omega)|) and (\phi(\omega)) refers to the amplitude and phase of (\hat{F}(\omega)), respectively. So, the inverse Fourier transform can be written as,       [\begin{equation}\begin{aligned}f(x) &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty\hat{F}(\omega)e^{ix\omega}d\omega + \int_{-\infty}^0\hat{F}(\omega)e^{ix\omega}d\omega\bigg]\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty   \hat{F}(\omega)   e^{i[\phi(\omega) + x\omega]}d\omega + \int_{-\infty}^0   \hat{F}(\omega)   e^{i[\phi(\omega) + x\omega]}d\omega\bigg]\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty   \hat{F}(\omega)   e^{i[\phi(\omega) + x\omega]}d\omega + \int_{\infty}^0   \hat{F}(-\omega_t)   e^{i[\phi(-\omega_t) - x\omega_t]}d(-\omega_t)\bigg]\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty   \hat{F}(\omega)   e^{i[\phi(\omega) + x\omega]}d\omega + \int_0^\infty   \hat{F}(-\omega)   e^{i[\phi(-\omega) - x\omega]}d\omega\bigg]\ &amp; = \frac{1}{2\pi}\bigg[\int_0^\infty   \hat{F}(\omega)   e^{i[\phi(\omega) + x\omega]}d\omega + \int_0^\infty   \hat{F}(\omega)   e^{-i[\phi(\omega) + x\omega]}d\omega\bigg]\ &amp; =\frac{1}{2\pi}\int_0^\infty   \hat{F}(\omega)   \bigg[e^{i[\phi(\omega) + x\omega]} + e^{-i[\phi(\omega) + x\omega]}\bigg]d\omega\ &amp; = \frac{1}{2\pi}\int_0^\infty   \hat{F}(\omega)   cos[\phi(\omega) + x\omega]d\omega\end{aligned}\nonumber\end{equation}]   where we change the integration variable ((\omega \rightarrow \omega_t)) from line-2 to line-3. Using the fact that (\omega_t) is simply an integration dummy variable, we change it back to (\omega) and adjust the integration range accordingly (line-3 to line-4). From line-4 to line-5, we apply the relation between (\hat{F}(\omega)) and (\hat{F}(\omega)) – they have identical amplitude but opposite phase. From the result, we can see that by expanding the definition domain to include negative frequency, we can guarantee that the inverse Fourier transform will always give real result, which is exactly what we need in practice. As for the physical meaning of negative frequency, we can imagine the sinusoidal function pictorially as rotation - the positive and negative then just corresponds to the rotation in different directions, i. e. clockwise or counterclockwise.  References [1] M. T. Dove, Structure and Dynamics: An Atomic View of Materials. Oxford University Press, New York, 2002. [2] R. B. Neder and T. Proffen, Diffuse Scattering and Defect Structure Simulations, Oxford University Press, New York, 2008. "
    }, {
    "id": 70,
    "url": "http://localhost:4000/2020-06-27-conda_build/",
    "title": "Build package with conda recipe",
    "body": "2020/06/27 - There are indeed instructions and tutorials about how to build conda packages (which we can then install easily through conda, e. g. by simply executing ‘conda install …’ from command line) with conda recipe. However, as a beginner to conda build, it was really difficult for myself to find the way out of pieces of information all over the place. I was trying to find a minimal example which then I can use as a template for further tweaking and potentially adding in new things according to my pwn need. It turns out that I could not find such a working example, and that’s what this blog is really for - just to provide a very minimal working example to demonstrate the basic work flow of conda build. Here follows is a screenshot of the demo program, with which one can calibrate the total scattering in reciprocal space with the corresponding Bragg pattern.  One can install this program by executing the following command from terminal,  conda install -c apw247 sofq_calib Next, I will share all the configurations necessary for making the easy installation of this program possible, with conda. First, the actual codes are included here: sofq_calib. zip, which has the following tree structure, . ├── LICENSE. txt├── README. txt├── setup. py└── sofq_calib  ├── init. py  ├── sofq_calib. py  ├── stuff  │   ├── doc. txt  │   └── help. txt  │   └── icon. ico One should save the top-level unzipped folder as ‘sofq_calib’. In this folder, we have all files relevant to running the GUI shown above. Besides that, one can also notice a ‘setup. py’ file - this is actually the file that is really doing the packaging job. Later on, conda recipe will try to get access to this folder and fundamentally to this ‘setup. py’ file to kick off the packaging process. Given the source codes above, we now turn to the conda build side. Here one can find the package containing all components relevant to conda build: sofq_calib_conda_recipe. zip which has the following tree structure, . sofq_calib_conda_recipe ├── bld. bat ├── build. sh ├── icon. ico ├── menu-windows. json └── meta. yaml One can find detailed introduction about conda build recipe following the link: Click Me! Several things need to be specifically mentioned here - it is NOT necessary to save the top-level folder as the name appearing here; within the top-level folder, several files need to be with exactly the name as shown: bld. bat, build. sh, ‘menu-windows. json’ and ‘meta. yaml’; the ‘bld. bat’ and ‘build. sh’ are scripts to kick off the packaging, respectively on Windows and Unix-like OS; the ‘meta. yaml’ file contains necessary configurations (metadata) guiding the packaging engine to do what we want it to do. One can refer to the link here for more information about ‘meta. yaml’ file: Click Me; the build script and the YAML file are the minimal requirement for a successful packaging. For current example, apart from the very basic packaging, we also have included a useful feature - on Windows platform, when users install our package, a corresponding shortcut will be generated both on Desktop and in the Windows start menu. To make this possible, we need two extra files in the conda build folder - one is obviously the icon file (‘icon. ico’ in the folder above) and the other one is ‘menu-windows. json’. Accordingly, in the ‘bld. bat’, we have entries responsible for copying both the ‘icon. ico’ and ‘menu-windows. json’ files into the right place with the right name (‘menu-windows. json’ will be renamed as ‘package-name. json’ where ‘package-name’ refers to the name of our package and in this case, it is ‘sofq_calib’). Here following is the relevant contents in the build script,    set MENU_DIR=%PREFIX%\Menuif not exist (%MENU_DIR%) mkdir %MENU_DIR%copy %RECIPE_DIR%\icon. ico %MENU_DIR%if errorlevel 1 exit 1copy %RECIPE_DIR%\menu-windows. json %MENU_DIR%\sofq_calib. jsonif errorlevel 1 exit 1 where the environment variable ‘%PREFIX%’ refers to the top-level folder of corresponding conda environment. One can find out where it is, by typing ‘conda info’ in terminal. Then both files mentioned above concerning Windows menu entry will appear under the ‘%PREFIX%\Menu’ folder once the package is successfully installed. In the ‘menu-windows. json’ file is given the properties of the shortcut that will be created for the installed package on Windows. The content is reproduced here,    {   menu_name :  Anaconda${PY_VER} ${PLATFORM} ,   menu_items :  [    {       name :  SofQ_Calib ,     pywscript  :  ${PYTHON_SCRIPTS}/sofq_calib-script. pyw ,     icon :  ${MENU_DIR}/icon. ico ,     desktop : true  }  ]} where each entry within the ‘menu-items’ should be self-explaining. Attention here to the ‘pywscript’ entry which specifies the script that will be launched when double-clicking the shortcut. The full target entry of the shortcut (right click the shortcut → select [Properties] to see/change the target) will become,  C:\Users\yuanp\anaconda3\pythonw. exe C:\Users\yuanp\anaconda3\cwp. pyC:\Users\yuanp\anaconda3 C:\Users\yuanp\anaconda3\pythonw. exeC:\Users\yuanp\anaconda3\Scripts\sofq_calib-script. pyw One does not need to worry about the ‘sofq_calib-script. pyw’ file appearing here. This is a file that is automatically generated during the conda package building/installation procedure and also ‘-script. pyw’ is automatically appended to the end of package name to give the corresponding script name of ‘sofq_calib-script. pyw’. The purpose of generating such a file is to disable the command window popup specifically on Windows. Accordingly, in the YAML file, the entry point under the ‘app:’ block should also be specified as ‘pythonw -m sofq_calib. sofq_calib’, where ‘pythonw’ means the script will be executed by pythonw instead of python. The first ‘sofq_calib’ refers to the package name and the second ‘sofq_calib’ means the script to be executed - remember the ‘-script. pyw’ to be appended to the script file name to give ‘sofq_calib-script. pyw’, as already mentioned above. "
    }, {
    "id": 71,
    "url": "http://localhost:4000/2020-06-26-discus_install/",
    "title": "Install DISCUS version 6 on Windows 10",
    "body": "2020/06/26 -  On my Windows 10 machine, I first tried to install DISCUS version 6 following the one-touch installation procedure and got the error relevant to ‘HDF5’. Therefore, I turned to the manual installation procedures. During the installation, I have to install the ‘libssl1. 1’ library manually. After successful installation of discus_suite on WSL ubuntu machine, I could not find the ‘DiscusWSL’ folder under ‘C:\Users\DISCUS_INSTALLATION’ as specified in the installation instruction. Instead, I have to manually copy the ‘DiscusWSL’ folder from WSL directory/home/discus/DIFFUSE_INSTALL/DiscusWSLto the Windows folderC:\Program Files (x86). After the successful configuration following the manual installation instruction, I can lanuch the discus_suite terminal without problems. However, I came across the problem of not being able to start any xserver relevant service. For example, typing ‘manual’ within the ‘suite’ environment will give the error of something like ‘cannot start display :0’. After a bit Googling, I found this is something to do with the xserver settings. I have to put the following line in the ‘. profile. local’ file (this file will be called anytime discus_suite is started) on WSL system for the WSL subsystem to configure the display properly:export DISPLAY=$(cat /etc/resolv. conf | grep nameserver | awk '{print $2}'):0Then another problem pops up at this stage complaining about authentication failure, which is again relevant to the xserver stuff. I have to use the following command to start the ‘vcxsrv’ server to disable the authentication, C:\Program Files\VcXsrv\vcxsrv. exe  :0 -ac -terminate -lesspointer -multiwindow -clipboard -wglI haven’t figured out the way to put the command above into the starting batch file of discus_suite, so currently I have to manually execute the command above before launching the discus_suite program. To make life easier, I created a shortcut and associate the shortcut with the command here. Then I put the shortcut into the starting up folder (open the Windows run box by pressing ‘#+r’ - where ‘#’ represents the Windows start key - and put ‘shell:startup’ in it, followed by pressing ‘enter’ to open up the starting up folder). In this way, every time Windows starts, the ‘vcxsrv’ will launch automatically with authentification disabled. "
    }, {
    "id": 72,
    "url": "http://localhost:4000/2020-04-19-cuda_note_II/",
    "title": "Notes on CUDA programming II",
    "body": "2020/04/19 - First of all, we may need a review for the very basic CUDA programming and GPU execution principle. Here, I want to use the diagram below to demonstrate the threadings on GPU with a very simple array addition operation example.  In this simple case, we only have a single block on GPU, which contains, say, 500 threads (the actual number of threads may be larger than 500 but in this example, we only need 500 of them). The part above the dashed line refers to the single block. The for loop in the middle of the bottom half is usually what we do for coding in the array addition task. Basically, we loop over all the 500 indexes to do the addition one-by-one in a serial manner. Using GPU, the working scheme is different. Instead of a single ‘worker’ executing our commands one after another, we now have a whole bunch of ‘workers’ ready at the same time, waiting for our commands so that they can do their own job, independently. Each ‘worker’ has his/her unique ID - the location within the grid-block-thread organization we talked about in previous note (Click me to transfer there). At the beginning of the workflow, we let each ‘worker’ shout out their unique ID (‘threadIdx. x’ in the diagram above). Then we decide which part of the job to assign to each specific ‘worker’ (the assignment ‘i = threadIdx. x’ in the diagram above). After that, each ‘worker’ knows exactly what he/she is responsible for and then goes directly to do job (e. g. ‘c[35] = a[35] + b[35]’ in the diagram above). Here, the diagram only shows the working mechanism on GPU and the data copying in between the host (CPU) and the device (GPU) is not shown. Basically, copying data (the array ‘a’ and ‘b’ here) from host to device is analogous to trucks delivering materials to the factory (the device, our GPU) and copying data (the resulted array ‘c’ here) from device back to host is analogous to factory delivering products to the boss (the host, CPU). Since each ‘worker’ has his/her own unique ID with which we can assign a unique task for each of them. Therefore, the actual order of the job to be carried out does not really matter that much. That’s why we see that in the diagram above, the #35 part of the job is shown above #10. This is just to demonstrate the idea that order here does not matter. In practice, they all happen in parallel and no one really knows or cares which one of them gets executed/finished first. Based on the further discussion above, we now move on to a slightly complicated case, where we are going to do matrix multiplication with GPU. First, the basic principle of conducting matrix multiplication is shown in the following picture, To conduct the matrix multiplication in a parallel way on GPU, the fundamental idea is to execute each of the block within dashed boxes, independently on individual thread on GPU. To realize that, the basic workflow is presented in the following picture, Following the coding scheme as presented above, the fundamental difference as compared to usual serial coding here is that we represent the matrix in a one-dimensional manner, as indicated by the red arrows on the top of the figure above. The purpose of such a representation is for the ease of coding on GPU kernel, as we will see in the code snippet that will be presented later in current blog. Once we transform our matrix to its one dimensional form, the next step is again to let ‘workers’ shout out their unique ID, as we have discussed above. In this case, for demo purpose, assume we have a single block which contains (3\times2) thread structure, then in practice we have a one-to-one mapping between ‘workers’ and the entries of the final product matrix, i. e. each ‘worker’ is responsible for one entry in the final product matrix and none of them is wasted. The reason why we want to point out ‘none is wasted’ is that in practice, it often happens the overall GPU block unit is larger than what we really need. For example, in current example, if we claim a single GPU block with (5\times4) thread structure, we can still find right amount of ‘workers’ to do jobs for us, but in this case, for sure some of the ‘workers’ will not be assigned jobs, thus ‘wasted’. Back to our workflow, once all ‘workers’ know what they are responsible for, they can go ahead to do their jobs, i. e. multiplying the right row and column of the input matrices and sum up the result to obtain the entry for the final product matrix, as indicated by the part of the diagram above containing a whole bunch of grouped (by ‘worker’) squares. The explanation presented above about matrix multiplication with CUDA is based on the original blog post in Ref. [1]. Also, the code snippets there are reproduced here in current blog, with detailed comments for better understanding. A makefile, together with instructions about how-to, is also provided at the end of current blog, with which one can straightforwardly compile the code given below. main_mat_mul. cu  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 9101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;stdlib. h&gt;#include &lt;time. h&gt;#include &lt;cuda_runtime. h&gt;#include  kernel. h #include  kernel. cu #include  dev_array. h #include &lt;math. h&gt;using namespace std;int main(){  // Perform matrix multiplication C = A * B  // where A, B and C are NxN matrices.   int N = 16;  int SIZE = N*N;  // Allocate memory on the host.   vector&lt;float&gt; h_A(SIZE);  vector&lt;float&gt; h_B(SIZE);  vector&lt;float&gt; h_C(SIZE);  // Initialize matrices on the host.   for (int i=0; i&lt;N; i++){    for (int j=0; j&lt;N; j++){      h_A[i*N+j] = sin(i);      h_B[i*N+j] = cos(j);    }  }  // Allocate memory on the device. The 'dev_array' refers to a class  // defined separately in the 'dev_array. h' file - refer to the header  // list on top of current file.   dev_array&lt;float&gt; d_A(SIZE);  dev_array&lt;float&gt; d_B(SIZE);  dev_array&lt;float&gt; d_C(SIZE);  // The 'set' method defined in the 'dev_array. h' file is responsible for  // copying data from host to device. Here, the first parameter '&amp;h_A[0]' or  // '&amp;h_B[0]' is a pointer specifying the starting position in memory to  // copy from. The second parameter 'SIZE' specifies the number of 'blocks'  // we will copy. Detailed explanation about 'block' will be given in the   // 'dev_array. h' file (refer to the definition of 'set' method there).   d_A. set(&amp;h_A[0], SIZE);  d_B. set(&amp;h_B[0], SIZE);  // Now, we do the matrix multiplication on GPU, by calling the function  // below, which is defined in another separate . cu file - 'kernel. cu' in  // the header of current file. Within 'kernel. cu' file, the fundamental  // kernel function will be defined and called, which is the real part that  // is executing the matrix multiplication. Therefore, the calling scheme  // can be roughly depicted as follows:  //  //         call            call  // Current file  -----&gt; matrixMultiplication -----&gt; kernel  //   matrixMultiplication(d_A. getData(), d_B. getData(), d_C. getData(), N);  cudaDeviceSynchronize();  // The 'get' function is also defined in 'dev_array. h' file, as the 'set'   // function above. It is responsible for copying data from device to host.   d_C. get(&amp;h_C[0], SIZE);  cudaDeviceSynchronize();  // Next, we are going to do the same thing as above, i. e. matrix   // multiplication. This time, we will be doing it on CPU only.   float *cpu_C;  cpu_C=new float[SIZE];  // This is the familiar way of doing matrix multiplication in a serial  // manner on CPU.   float sum;  for (int row=0; row&lt;N; row++){    for (int col=0; col&lt;N; col++){      sum = 0. f;      for (int n=0; n&lt;N; n++){        sum += h_A[row*N+n]*h_B[n*N+col];      }      cpu_C[row*N+col] = sum;    }  }  // Compare GPU and CPU calculation results, for the same job.   double err = 0;  for (int ROW=0; ROW &lt; N; ROW++){    for (int COL=0; COL &lt; N; COL++){      err += cpu_C[ROW * N + COL] - h_C[ROW * N + COL];    }  }  cout &lt;&lt;  Error:   &lt;&lt; err &lt;&lt; endl;  return 0;} dev_array. h  Copy snippet to clipboard!   1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99100101102103104105106107108109110111112113114115116117118#ifndef _DEV_ARRAY_H_#define _DEV_ARRAY_H_#include &lt;stdexcept&gt;#include &lt;algorithm&gt;#include &lt;cuda_runtime. h&gt;// Template of type - it's just like a place holder, specifying the declared// variable is of SOME type (not known when being declared). Only when the // declared variable is used do we know what its type is. // See the following site for detailed explanation:// http://www. cplusplus. com/doc/oldtutorial/templates/template &lt;class T&gt;class dev_array{public:  // Refer to the following link for explanation about 'explicit':  // https://stackoverflow. com/questions/121162/what-does-the-explicit-keyword-mean  //   // Here follows we can find explanation about the functionality of  : :  // https://stackoverflow. com/questions/2785612/c-what-does-the-colon-after-a-constructor-mean  //   // Basicaly, we are initializing variables here.   explicit dev_array()    : start_(0),     end_(0)  {}  // Refer to the following link for explanation about data type 'size_t':  // https://en. cppreference. com/w/cpp/types/size_t  explicit dev_array(size_t size)  {    // The 'allocate' function is responsible for allocating memory on     // GPU - refer to the definition of 'allocate' function in the end of     // current file - the private functions part.     allocate(size);  }  ~dev_array()  {    free();  }  // Both the variables 'start_' and 'end_', as we will see later in current  // file, are pointers - 'start_' points to the starting position (in   // memory) and 'end_' points to the end. Therefore, the function defined  // here follows returns the size of the allocated array on GPU.   // Refer to the following site for explanation about const member function  // (i. e. the 'const' keyword after the function name below):  // https://docs. microsoft. com/en-us/cpp/cpp/const-cpp?view=vs-2019  size_t getSize() const  {    return end_ - start_;  }  // Return the starting position in memory, as a pointer.   T* getData() const  {    return start_;  }  // Function responsible for copying data from host to device. 'start_'  // specifies where the copied data will start on device; 'src' specifies  // the source of the copying on host; 'sizeof(T)' specifies the unit of  // the copied block and 'min' here gives how many such units of block will  // be copied.    void set(const T* src, size_t size)  {    size_t min = std::min(size, getSize());    cudaError_t result = cudaMemcpy(start_, src, min * sizeof(T), cudaMemcpyHostToDevice);    if (result != cudaSuccess)    {      throw std::runtime_error( failed to copy to device memory );    }  }  // Similar to the 'set' function above. In this case, we have the copy  // direction reversed - from device to host.   void get(T* dest, size_t size)  {    size_t min = std::min(size, getSize());    cudaError_t result = cudaMemcpy(dest, start_, min * sizeof(T), cudaMemcpyDeviceToHost);    if (result != cudaSuccess)    {      throw std::runtime_error( failed to copy to host memory );    }  }private:  // Allocate memory on device. The starting position in memory on device will  // be returned as a pointer.   void allocate(size_t size)  {    cudaError_t result = cudaMalloc((void**)&amp;start_, size * sizeof(T));    if (result != cudaSuccess)    {      start_ = end_ = 0;      throw std::runtime_error( failed to allocate device memory );    }    end_ = start_ + size;  }  // Free memory on device.   void free()  {    if (start_ != 0)    {      cudaFree(start_);      start_ = end_ = 0;    }  }  T* start_;  T* end_;};#endif kernel. h  Copy snippet to clipboard!  123456#ifndef KERNEL_CUH_#define KERNEL_CUH_void matrixMultiplication(float *A, float *B, float *C, int N);#endif kernel. cu  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 91011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#include &lt;math. h&gt;#include &lt;iostream&gt;#include  cuda_runtime. h #include  kernel. h #include &lt;stdlib. h&gt;using namespace std;// This is where the real magic is happening - the matrix multiplication on GPU// in a parallel manner. __global__ void matrixMultiplicationKernel(float* A, float* B, float* C, int N){  // Here, 'workers' are assigned task, according to their unique ID.   // N. B. the way used here to assign rows and columns for 'workers'  // guarantee that no two 'workers' will be assigned the same row and column  // at the same time.   int ROW = blockIdx. y*blockDim. y+threadIdx. y;  int COL = blockIdx. x*blockDim. x+threadIdx. x;  float tmpSum = 0;  // Now each 'worker' knows exactly what he/she is responsible, it's time  // for them to do their jobs, individually.   if (ROW &lt; N &amp;&amp; COL &lt; N) {    for (int i = 0; i &lt; N; i++) {      tmpSum += A[ROW * N + i] * B[i * N + COL];    }  }  C[ROW * N + COL] = tmpSum;}void matrixMultiplication(float *A, float *B, float *C, int N){  // Here, we use 'dim3' type variables for declaring the number of blocks   // per grid and the number of threads per block.   // Refer to the following link about 'dim3' in CUDA:  // https://codeyarns. github. io/tech/2011-02-16-cuda-dim3. html  // or   // https://docs. nvidia. com/cuda/cuda-c-programming-guide/index. html  dim3 threadsPerBlock(N, N);  dim3 blocksPerGrid(1, 1);  // The IF statement guarantees that we have at most 512 threads per block.   if (N*N &gt; 512){    threadsPerBlock. x = 32;    threadsPerBlock. y = 16;    blocksPerGrid. x = ceil(double(N)/32);    blocksPerGrid. y = ceil(double(N)/16);  }  matrixMultiplicationKernel&lt;&lt;&lt;blocksPerGrid,threadsPerBlock&gt;&gt;&gt;(A, B, C, N);} ========================I AM A SEPARATOR======================== To compile the codes given above, one may want to first save each individual snippet to a separate file (with file name as exactly given on top of each snippet) and also guarantee that all files stay in the same folder. Then one can use the makefile given below to compile the codes to get the executable, by simply executing ‘make’ on terminal.  Makefile  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 9101112NCC=nvccOBJ=kernel. o main_mat_mul. omat_mul: $(OBJ)&nbsp;&nbsp; &nbsp;$(NCC) -o $@ $^main_mat_mul. o: kernel. o&nbsp;&nbsp; &nbsp;$(NCC) -c main_mat_mul. cukernel. o:&nbsp;&nbsp; &nbsp;$(NCC) -c kernel. cu References [1] https://www. quantstart. com/articles/Matrix-Matrix-Multiplication-on-the-GPU-with-Nvidia-CUDA/ "
    }, {
    "id": 73,
    "url": "http://localhost:4000/2020-04-19-cuda_note_I/",
    "title": "Notes on CUDA programming I",
    "body": "2020/04/19 - To understand and implement CUDA codes in practice, the very first step is to understand the allocation of threads on GPU. Fundamentally, threads are basic units on GPU where computation can happen in a parallel way. To the first level, threads are grouped into blocks, either in a 1D, 2D or 3D manner, where each thread within a certain block has its own “coordinate” - a unique index for pinning down the location of a certain thread in the block. At the second level, blocks are further grouped into grid, in a similar way as how threads are grouped into block. Here we use three diagrams showing the basic idea of such a division manner for GPU computation units and how we really locate a thread in a block and a block in a grid.    Copy snippet to clipboard!  1 2 3 4 5 6 7 8 9101112131415161718192021222324252627282930313233343536373839404142#include &lt;stdio. h&gt;__global__void saxpy(int n, float a, float *x, float *y){ int i = blockIdx. x*blockDim. x + threadIdx. x; if (i &lt; n) y[i] = a*x[i] + y[i];}int main(void){ int N = 1&lt;&lt;20; float *x, *y, *d_x, *d_y; x = (float*)malloc(N*sizeof(float)); y = (float*)malloc(N*sizeof(float)); cudaMalloc(&amp;d_x, N*sizeof(float));  cudaMalloc(&amp;d_y, N*sizeof(float)); for (int i = 0; i &lt; N; i++) {  x[i] = 1. 0f;  y[i] = 2. 0f; } cudaMemcpy(d_x, x, N*sizeof(float), cudaMemcpyHostToDevice); cudaMemcpy(d_y, y, N*sizeof(float), cudaMemcpyHostToDevice); // Perform SAXPY on 1M elements saxpy&lt;&lt;&lt;(N+255)/256, 256&gt;&gt;&gt;(N, 2. 0f, d_x, d_y); cudaMemcpy(y, d_y, N*sizeof(float), cudaMemcpyDeviceToHost); float maxError = 0. 0f; for (int i = 0; i &lt; N; i++)  maxError = max(maxError, abs(y[i]-4. 0f)); printf( Max error: %f\n , maxError); cudaFree(d_x); cudaFree(d_y); free(x); free(y);}One can save the codes as a file with extension ‘. cu’ and compile the codes using ‘nvcc’ compiler provided by NVIDIA (Click Me!), just like usually what we do for compiling normal C codes, e. g. by executing ‘nvcc -o first_cuda_demo first_cuda_demo. cu’. Here, we won’t go into further details about the code (refer to Ref. [1] for more introduction), and instead we will give here an abstract skeleton of the codes to get a bird view.  Also, one can define all the CUDA relevant executions as a dedicated and callable routine. Then we can call the CUDA routine from normal C, C++, Fortran or whatever relevant codes. For example, we can write the codes above in a manner as shown below. First, the caller C codes,  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 91011121314151617181920212223242526272829#include &lt;stdio. h&gt;#include &lt;stdlib. h&gt;#include &lt;string. h&gt;#include &lt;cuda. h&gt;extern void cuda_kernel(float *x, float *y, int N);int main(int argc, char *argv[]){ int N = 1&lt;&lt;20; float *x, *y; x = (float*)malloc(N*sizeof(float)); y = (float*)malloc(N*sizeof(float)); for (int i = 0; i &lt; N; i++) { x[i] = 1. 0f; y[i] = 2. 0f; } cuda_kernel(&amp;x, &amp;y, N); float maxError = 0. 0f; for (int i = 0; i &lt; N; i++) {  maxError = max(maxError, abs(y[i]-4. 0f)); } printf( Max error: %f\n , maxError); return 0;}Saving the codes above as, e. g. ‘caller. c’. Then the callee CUDA codes,  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 9101112131415161718192021222324252627#include &lt;stdio. h&gt;__global__void saxpy(int n, float a, float *x, float *y){ int i = blockIdx. x*blockDim. x + threadIdx. x; if (i &lt; n) y[i] = a*x[i] + y[i];}int cuda_kernel(float *x, float *y, int N){ float *d_x, *d_y; cudaMalloc(&amp;d_x, N*sizeof(float));  cudaMalloc(&amp;d_y, N*sizeof(float)); cudaMemcpy(d_x, x, N*sizeof(float), cudaMemcpyHostToDevice); cudaMemcpy(d_y, y, N*sizeof(float), cudaMemcpyHostToDevice); // Perform SAXPY on 1M elements saxpy&lt;&lt;&lt;(N+255)/256, 256&gt;&gt;&gt;(N, 2. 0f, d_x, d_y); cudaMemcpy(y, d_y, N*sizeof(float), cudaMemcpyDeviceToHost); cudaFree(d_x); cudaFree(d_y);}Saving the callee CUDA codes above as, e. g. , ‘callee. cu’. Then use the Makefile provided below to compile the executable,  Copy snippet to clipboard!  1 2 3 4 5 6 7 8 91011121314CC=gccNCC=nvccOBJ=caller. oCUDA_OBJ=callee. ocall_cuda: $(OBJ) $(CUDA_OBJ) $(CC) -o $@ $^$(OBJ): %. o: %. c $(CC) -c $&lt;$(CUDA_OBJ): %. o: %. cu  $(NCC) -c $&lt;Basically, during compiling, we can treat the CUDA codes just as normal C codes. Also, as usual, when library is used in the CUDA codes, we need to link to the libraries as we do for normal C codes (or whatever relevant codes, e. g. , Fortran). In the following blog, I will note down a slightly more complicated case - matrix multiplication with CUDA.  References [1] https://devblogs. nvidia. com/easy-introduction-cuda-c-and-c/ "
    }, {
    "id": 74,
    "url": "http://localhost:4000/2020-03-29-notes_mag_II/",
    "title": "Notes on magnetism - II",
    "body": "2020/03/29 - Talking about the magnetism of ions in crystals naturally brings us out of the atomic physics picture which we previously based ourselves in when discussing the free atom and ions (see previous note by clicking me!). Also, for sure we should turn to the many-electron scheme instead of a single-electron one. However, to build up the final multi-electron picture, we can potentially take the single-electron pathway. This is quite similar to the situation of independent atoms, where we have been mentioning the coupling between angular momentum of multi-electrons. The pathway we take thereby is also a single-electron one. For example, based on Hund’s rule, we talk about filling electrons one-by-one to various energy levels to finally build up the ground state. Here, for discussing the magnetism of ions in crystals, Hund’s rule can still be used in some situations. However, attention should be paid and we will revisit this issue later by inspecting a specific example. To start, we first notice that usually the orbitals involved in magnetism are either (3d) (e. g. transition metals) or (4f) (e. g. rare earth metals), both of which are strongly localized (as compared to, e. g. (s) orbitals). Therefore, we can still treat those ions as being isolated. However, they are not completely isolated as being free ions and the states will be more or less influenced by the surroundings.  Although we say both (3d) and (4f) orbitals are strongly localized, electrons in either of those states can still move in the whole crystal [1]! In a broad sense, such effect upon states exerted by the surroundings in crystal can be called the crystal field effect, which has different pictures in two distinctive situations - (3d) orbital involved transition metal ions and (4f) orbital involved rare earth metal ions [1].  For rare earth metals, because overlapping between (4f) is weak and therefore the crystal field effect is also weak since it is purely coming from electrostatic potential. In comparison for transition metal, the (3d) orbital overlapping is much stronger and therefore the crystal field effect is also much stronger as the result of hybridization (see page 15 in [2]). In former case, the (LS) coupling is considered first to go into the coupled (J) representation and then the crystal field is considered to split the degenerate (J) levels. Hereby, it should be pointed out that in this case we directly go into multi-electron picture without going through the single-electron pathway as before! Detailed discussion can be found in page 15-18 in Ref. [2], where the magnetic anisotropy pops up naturally as the result of symmetry-adapted Hamiltonian (see page-18 in Ref. [2]). For the latter situation, the crystal field effect is strong and thus is considered as the main factor, which splits the degenerate (L) levels. The (LS) coupling and other effects such as Zeeman effect are then considered as perturbations (see page 27-33 in Ref. [1]). Again, magnetic anisotropy naturally pops up as the result of either (LS) coupling or Zeeman term in the Hamiltonian (see page 34-37 in Ref. [1]). Moreover, Jahn-Teller effect also plays an important role for splitting states if the ground state is non-degenerate (see Ref. [3] and page section-3. 4 in Ref. [1]).  Here we have two important things to mention. 1) When the ground state (see the example below for detailed explanations) is non-degenerate, it can be proved (see page 34-35 in Ref. [1]) that the contribution from orbital angular momentum (the coupled multi-electron one) to the Hamiltonian is 0. We say in such a situation, the orbital angular momentum is quenched. 2) When we have odd number of electrons, the doubly degeneracy of spin (z) component is not broken by the crystal field, which is called Kramers theorem and the still degenerate spin doublet is called Kramers doublet. For understanding the splitting of (L) levels (which is obviously a multi-electron problem), here we can take a single-electron pathway. Taking the cubic symmetry as an example, first we can obtain the split states as the result of crystal field effect - the splitting into (t_{2g}) and (e_g) levels. Then according to the strength of the crystal field effect as compared to the energy for pairing electrons (the first Hund coupling, see previous note, by clicking me), we either have low-spin or high-spin situations - see Ref. [3] and page 21-22 in Ref. [2]. Suppose we have the low-spin situation, and for example we have 6 (d) electrons, the electrons can be filled into available states following the first Hund’s rule, as follows, Any one of the three situations shown above can be our ground state and therefore in this case we have triplet degeneracy in our ground coupled state. Such a picture is exactly consistent with what we will get following the multi-electron approach, as shown in page 30-34 in Ref. [1].  Since we have hybridization of orbitals here, the single electron orbital angular momentum quantum number is no longer a good one. Therefore, the second Hund’s rule no longer works here and that’s why we have the triplet degeneracy in the example shown above. Similar discussion can be made for other situations - refer to the states splitting discussed in page 19 in Ref. [2] and page 32-33 in Ref. [1].  For high-spin situation, we can also follow the single-electron pathway to discuss the degeneracy problems of the ground state. A full picture of electron configurations for both low-spin and high-spin situations can be found in Ref. [3]. N. B. when the energy difference between low-spin and high-spin configuration is not so large, we can potentially have the spin crossover - see page 21-22 in Ref. [2] - as the result of thermal effect.  References [1] K. Yosida. Theory of magnetism. Springer. 1996. [2] Theory of magnetism, by C. Timm. [3] Jahn-Teller Distortions, from Chemistry LibreText. "
    }, {
    "id": 75,
    "url": "http://localhost:4000/2020-03-18-notes_mag_I/",
    "title": "Notes on magnetism - I",
    "body": "2020/03/18 - To understand the magnetism of free atoms and ions, we may go through several stages, as follows, Hartree approximation - electrons are treated in a non-interactive manner. Beyond Hartree - interaction between electrons is taken into account. Spin-orbital coupling. Hyperfine interaction - the interaction between electrons and nucleus. Stage-1At this stage, the single electron Schrodinger equation can be solved in the spherical potential field and one can get quantized energy levels indexed by quantum number (n), (l) and (m). Hydrogen atom is the simplest and the most special case - the Coulomb potential is rigorously inverse proportional to (r) and therefore energy levels with the same (n) but different (l) are degenerate. For general cases, e. g. hydrogen-like atoms, the effective Coulomb potential is not rigorously inverse proportional to (r), as the result of screening effect from the atom core charge (nucleus + electrons). This results in the splitting of (r) levels. However, no matter for which situation, the degeneracy over (m) is always there. Based on the recipes given here, one can then follow the Aufbau principle to fill electrons into various shells. Suppose we have already filled all levels between 1s and 4s and we are left with 5 more electrons to worry about, how many possibilities we have to finish filling the 5 electrons? The general formula is given as (C_{2(2l+1)}^{n_{nl}})where (l) refers to the angular momentum quantum number and (n_{nl}) refers to the number of left-over electrons. The logic here is that we have in total (2(2l+1)) degenerate states (considering spin up and down) and we can just pick up any (n_{nl}) ones from them to fill electrons, simply because they are all degenerate.  Stage-2Going beyond the Hartree approximation, we start to consider the interaction between electrons and here it comes that Hund’s rule plays an important role for determining the ground state (N. B. Hund’s rule is not working for determining excited state. Also, it is even not working perfectly, though for most of cases it is working fine, for determining the ground state). Behind the Hund’s rule, we have some fundamental physics, which we will mention later. But here we take exactly the same example mentioned above - to fill 5 electrons into the 3d levels. The 1st Hund’s rule says we should have the maximum coupled S. Here it immediately brings in a critical question: what coupled S really is. We already said that by going beyond the Hartree approximation, interaction between electrons is taken into account. Therefore, now electrons are not independent any more and we say they are coupled, including the coupling between orbital and spin momentum. In another word, previously we have been using (l), (s), (m_l) and (m_s) to label quantum states, but now we have to change our label for quantum states to the coupled representation, using (L), (S), (m_L) and (m_S) instead. How to get to coupled representation from independent representation is a typical/fundamental quantum mechanics problem, for which we can refer to Shankar’s book Principles of quantum mechanics (2nd edition, chapter-15). Back to the 1st Hund’s rule mentioned above (focusing on the coupling between electron spins for the moment), it can give us a non-degenerate (unique) ground state, with spins of all the five electrons aligned in a parallel manner, occupying each of the (m_l = -2, -1, 0, 1, 2) level. Why? Because Hund’s rules says we should have the coupled (S) as large as possible, and we know that the largest (S) should be equal to the largest possible value of (S_z). Furthermore, we know for sure that the largest possible value of (S_z) should be (5/2) with all spins lined up in the same direction. Here it may be a bit confusing that we said we go from independent representation to coupled representation, but it seems that the ground coupled state is just one of the original state in the independent representation. Actually, they are just seemingly identical and actually they are different stuff - in the coupled representation, the ground state we arrived at above is labeled with quantum number (S = 5/2) and (m_S = 5/2). However, for the independent representation, we have 5 independent labels for this single state (it’s just that all the five labels takes (m_s = 1/2))! Furthermore, if going beyond the ground state, we will immediately see the difference between these two representations - in most of the cases, the coupled state is a superposition of those states in the independent representation, where we have the so-called Clebsch-Gordan (CG) coefficients as the linear combination coefficients. For those excited states in the coupled representation, again we can refer to Shankar’s book mentioned above for details (chapter-15).  Here, though not directly relevant to current discussion, it’s still worth mentioning the other two general important issues in fundamental quantum mechanics (which most people just take for granted yet without knowing why): 1) given the principal quantum number (n), we all know the orbital angular momentum can take (0, 1, \dots, n-1). But why? We can find the answer to this question in Shankar’s book mentioned above (page 422-423, 2nd edition), where the quantum version of Runge-Lenz vector is introduced to act as a ladder operator with respect to orbital angular momentum. The values of orbital angular momentum is then obtained by observing that all (l&gt;n) terms will vanish. 2) Given the orbital angular momentum quantum number (l), we all know (m_l = -l, -(l-1), \dots, (l-1), l). But why? The answer to this question can be found in page 321-324 in Shankar’s book and again the ladder operator is acting an important role here. When the coupled spin (S) does not recognize a unique ground state, here comes the 2nd Hund’s rule, concerning coupling of orbital angular momentum. It says the ground state should be the one with largest coupled (L). Following the same recipe above, we should immediately know that we are actually looking for a state with largest possible (L_z). For the five electrons situation mentioned above, coupled (S) has already specified a unique ground state. To demonstrate the 2nd Hund’s rule, we go for six electrons situation. Following the 1st Hund’s rule, the first five electrons should line up in a parallel manner into the five available levels and the 6th electron can choose whichever of the first five electrons to pair with, and obviously after pairing we should have the 6th electron aligned in the opposite direction with the spins of the first five electrons. To determine the true ground state, we need the 2nd Hund’s rule here - we are trying to look for the largest possible (L_z), which obviously point to that the 6th electron should be put on the level indexed by (m_L = \pm 2) (here the sign does not really make any difference since it is just a matter of choosing the positive direction of (z)-axis).  The golden rule to keep in mind concerning the angular momentum coupling is that the value of the coupled angular momentum is equal to the largest possible sum of the corresponding magnetic quantum number of all the independent angular moment. Considering the interaction between electrons, the total number of non-degenerate states become ((2L+1)(2S+1)).  Understanding the physics behind the first two Hund’s rules. 1) Considering the first Hund’s rule, according to Pauli exclusion principle, electrons are not allowed to stay at exactly the same state. Therefore, by aligning in a parallel manner, electrons have to ‘stay away from each other’ (e. g. by taking up states indexed by different magnetic quantum number), which then help reducing the system energy (we can understand this as an effective Coulomb repulsion). 2) As for the second Hund’s rule, electrons tend to have the same orbital angular momentum, which means they rotate in the same direction and therefore they become further apart effectively because of the Coulomb repulsion - this also helps lowering the system energy.  Stage-3 Now we need to bring in the spin-orbital coupling, which is crucial for understanding both the magnetic property of free atoms or ions discussed here and that of solid materials where atoms are bonded together to form crystal field. Attached picture shows two key figures in shaping quantum mechanics - Paul Dirac and Wolfgang Pauli. Specially, the relativistic version of ({\rm{Shr}}\ddot o{\rm{dinger}}) equation given initially by Dirac not only embed spins in a natural way, but also it brings in the spin-orbital coupling term explicitly. Here we will just briefly mention the spin-orbital coupling in terms of (LS) mode coupling (another alternative coupling mode is the (jj) mode, for which the coupling between (l) and (s) of a single electron is considered first and the coupling between electrons are considered as perturbation. In contrast, for the (LS) mode coupling, since the coupling between electrons is stronger, all (l)’s and (s)’s are coupled first and (LS) coupling is considered afterwards). Within the (LS) coupling mode, (L) and (S) are coupled following the basic addition principle of angular momentum (see chapter-15 in Shankar’s book mentioned above), which gives (J = |L-S|, \dots, |L+S|). In this case, the degenerate states in stage-2 discussed above will be further split, with respect to the coupled quantum number (J) and here we have the 3rd Hund’s rule comes into play - the ground state takes minimum (J) if we have less than half filled levels (e. g. suppose the situation where we have 4 electrons filling the (3d) level); or the ground state takes maximum (J) if we have more than half filled levels (e. g. suppose the situation where we have 6 electrons filling the (3d) level); when we have half filled level, the 3rd Hund’s rule becomes trivial since we have (L = 0) (e. g. suppose the situation where we have 5 electrons filling the (3d) level) and thus we have (|L-S| = |L+S|).  Stage-4The hyperfine interaction which further splits energy levels is due to the interaction between nucleus spins and electron spins. Detailed formulation is a bit complicated and we won’t proceed with it here. We can refer to section-2. 6 in the lecture note Theory of Magnetism by Dr. C. Timm. "
    }, {
    "id": 76,
    "url": "http://localhost:4000/2020-03-08-coriolis_force/",
    "title": "About Coriolis force",
    "body": "2020/03/08 - First, a comprehensive GIF animation demonstrating the basic ideas of Coriolis force is presented.   Detailed explanation and derivation is presented in the following embedded document.  "
    }, {
    "id": 77,
    "url": "http://localhost:4000/2019-12-10-special_relativity/",
    "title": "Notes on special relativity",
    "body": "2019/12/10 -  The speed of light always is ‘c’, no matter where we are (either on the moving body or on any rest ‘ground’). This is one of the two fundamental assumptions based on which Einstein’s special theory of relativity stands. This is, as a matter of fact, the result of experiment, not imagination or assumption of Einstein, Feynman, or anybody else. The famous experiment is called Michelson-Morley experiment, the details of which can be found in Wikipedia. The basic idea of this experiment is: assuming the speed of light ‘c’ is specifically relative to something (historically, the ‘something’ here was called aether, from what I remember), then we know our earth is rotating around the self-axis, thus the speed of light, of course, is NOT ‘c’, if our previous assumption (‘c’ is specifically relative to aether) stands. Then using the facility designed by Michelson and Morley, we should observe some corresponding effect, which is the result of the changing of speed of light relative to our earth. I won’t bother with what the effect will be like (detailed information can be found in the link at the bottom), but I can tell the result: no expected effect was observed if our previous assumption stands! That’s it, it seems that we have to accept the experimental FACT that speed of light is always ‘c’ – relative to the observer on spacecraft, or relative to our earth, or relative to anything moving on the earth, or, or, relative to ANYTHING in the universe. Actually, it was just the result of the famous Michelson-Morley experiment (and some other following experiments – see the link below) that directly leads to the invention of the special theory of relativity. Moreover, the invariance of speed of light is one of the two basic principles of special theory of relativity. Furthermore, when we are talking about TIME, we actually mean the interval (along time axis) between two EVENTS. So imagine the process of a ball rising up from the ground and falling back to the ground. So the two events, in this case, are ‘ball leaves the surface – starting to rise up’ and ‘ball comes back to the surface – finishing falling down’. Then two observers – one moves together with the ball and the other one stands on the rest ‘ground’ – observe exactly the same two events, are the time (interval) measured by these two guys going to be different? The answer is: Yes. Why? Why? Why? Well, again, this is what we have to accept as the FACT. However, it’s worth a bit explanation, and now we need to go back to the experimental FACT – the speed of light does not change from frame to frame (ignoring the influence of medium, e. g. from air to water, and all the other effects). It is based on this FACT that people (Lorentz should be one of them, I think) obtained the invariant quantity called space-time interval for ANY frames. The definition is, [{s^2} = - {c^2}{(\Delta t)^2} + {(\Delta x)^2} + {(\Delta y)^2} + {(\Delta z)^2}] To better express the idea, here I give an example as following, Time and length by different observer. In the figure, there are two observers in one-dimension frames – one is standing on the ground, and the other is moving relative to the ground with the speed of v. Let’s call the axis x-axis, and the frame for observer-1 and observer-2 is named frame-1 (for which we use the notion x’ and t’) and frame-2 (for which we use the notion of x’’ and t’’), respectively. Moreover, both observer-1 and observer-2 stays at their own origins. Now, let’s imagine two bulb emitting light (as shown in the figure) one after another. Right at the beginning, bulb-1 emits light at the origin of frame-1, and just at that moment, observer-2 is also at the origin of frame-1 (which means the origins of frame-1 and frame-2 coincides with each other). Then we record the position and time for the event of bulb-1 emitting light, in two frames. For frame-1, it is: ({x_0} = 0), ({t_0} = 0), and for frame-2, it is: x’ = 0, t’ = 0. Then after some moments, observer-2 (remember? observer-2 is moving with speed of v, in frame-1, or as seen from observer-1) arrives at the position where bulb-2 is placed in frame-1, and JUST AT THAT EXACT MOMENT, bulb-2 emits light. Then we write down the position and time for the event of bulb-2 emitting light. For frame-1, it is: ({x_1} = x), ({t_1} = t), and for frame-2, it is: ({x’_1} = 0), ({t’_1} = t). You guess what? The two events happens at the same place as seen by observer-2 (or we say, in frame-2)!So now, we have two events - emission of the two bulbs. What we suspect is: is t (the time interval for these two events observed in frame-1, or by observer-1) and t’ (the time interval for these two events observed in frame-2, or by observer-2), the same? Or different? Let’s have a look. As is already given above, we have the invariant quantity s from frame to frame, thus we have, [- {c^2}{t^2} + {x^2} = - {c^2}t{‘^2} + 0] What else do we have? Remember observer-2 arrives at bulb-2 at the exact moment when bulb-2 emits light? So definitely we should have, [vt = x] By replacing (x) into the previous equation, we have, [- {c^2}{t^2} + {v^2}{t^2} = - {c^2}t{‘^2}] Rearranging the above equation, it is easy to get, [t = \frac{1}{\sqrt{1 - \frac{v^2}{c^2}}}t’ = \gamma t’] So, so, so, finally, without assuming anything except accepting the FACT that speed of light doesn’t change from frame to frame (based on which we then have the invariant quantity space-time interval), we obtain the result that for the two events that we cannot visually ‘feel’ any difference when changing the observing frame, the time interval observed in two different frames (one is moving relative to another), is indeed different! – They are linked up by the so called γ factor, as you can see from the above formula. What else can we say? Well, I should say, the difference of time interval observed in different frames (moving relative to each other) between two events, is some kind of PROPERTY of our space, and time. I am afraid, we have to accept it, maybe, no other choice.  N. B. The original post is from my answer to people’s question concerning the special theory of relativity on Stack Exchange. Click me to go to Stack Exchange Q &amp; A.  References [1] https://www. livescience. com/making-stable-wormholes. html "
    }, {
    "id": 78,
    "url": "http://localhost:4000/2019-12-08-einstein_fridge/",
    "title": "A silent refrigerator",
    "body": "2019/12/08 - All refrigerators running with gas relies on the principle that the evaporation of liquid to its corresponding gas form will take heat from surroundings. After evaporation, the gas should be liquefied back to liquid form to finish the cycle, and of course, the process of liquefaction will emit heat. That’s why need a fan (that’s just where the noise come from, which is also we want to diminish or even remove) for the commonly used gas-compression-based refrigerator to bring that part of emitted heat to the surrounding environment to keep it cool inside the refrigerator. The so-called absorption refrigerator, as one kind of gas-based refrigerator, also work on the evaporation and liquefaction of gas as mentioned above. But the difference here is that it does not bring the evaporated gas to its liquid form through compression. Instead, the evaporated gas will be solved (i. e. absorbed, thus comes the name ‘absorption refrigerator’) in some solvent, which then finish the cooling-and-heating cycle. [1, 2]General introduction to all kinds of refrigerators including the absorption refrigerator can be found everywhere on Internet, and a simple Googling will produce a lot of results [1-5]. Here in this post, I will focus on introducing a typical absorption refrigerator designed by Albert Einstein and his former student Leó Szilárd in 1926 and patented in US in November 11, 1930 [4]. This summary is created based on the following references: Ref [6, 7]. First of all, the picture demonstrating the basic design of Einstein’s frig from Wikipedia is presented here as following, Figure. 1. The annotated patent drawing for Einstein’s fridge. Image reproduced from Ref. [4]. The working gas in Einstein’s frig is ammonia and butane ,and the absorption media is water which both ammonia and butane can be resolved in. As shown in Fig. 1, first of all, the ammonia gas is generated in the Generator (Fig. 1, No. 29), which is actually just a heater that heats the ammonia up to accelerate the evaporation of ammonia. Through Conduit D (Fig. 1, No. 30), ammonia gas will reach the Evaporator (Fig. 1, No. 1), which is the heart of Einstein’s frig and also where the cooling actually happens. Before going on, there are several key aspects to keep in mind, the first one is that unlike the electric frig, Einstein’s frig has the same pressure in all parts of the cycle. The second aspect is that the boiling point of certain matter (in this case specifically we mean butane contained in the Evaporator) decreases as the reduction of the corresponding partial pressure of that matter. In the first step of the cycle described above, we mentioned that the evaporated ammonia gas reaches the Evaporator, which naturally leads to the increasing of the partial pressure of ammonia. Also we already know that the pressure in all parts of the cycle keeps nearly as constant, and the total pressure is roughly the sum of the partial pressure of all component gas, [{P_{total}} = {P_1} + {P_2} + \cdots + {P_i} + \cdots] where ({P_1}), ({P_2}), etc. refers to the partial pressure corresponding to each single component in the system. As a result, with the introduction of ammonia into the Evaporator, the increasing of the ammonia partial pressure will lead to the reduction of the butane partial pressure. Then the boiling point of butane will decrease accordingly, which will lead to the evaporation of butane to cool itself and the environment. Here the ‘environment’ basically means part No. 5 in Fig. 1, where the food is kept. The mixture of ammonia and butane will then flow to the Condenser/Absorber (Fig. 1, No. 6), where water is sprinkled (since the water Container – Fig. 1, No. 33 – is located higher in position than the sprinkle head – Fig. 1, No. 35, water can sprinkle automatically without problem) to absorb/resolve ammonia. Now the partial pressure of butane should increase accordingly when then lead to the condensation of butane (that’s why part No. 6 is also called the Condenser). The released heat accompanying the condensation then can be removed by the environment, e. g. by the flowing cooling water surrounding the Condenser, Fig. 1 – the blue-colored part surrounding the Condenser. In the Condenser, the ammonia-water solution and ammonia-butane liquid forms two layers because of the difference in density. Here the ammonia-water solution in the Condenser is higher in position as compared to that in the Generator, which therefore promises the back-flowing of ammonia-water solution to the Generator automatically. In the way of flowing back to the Generator, the ammonia-water solution goes through the Heat Exchanger Jacket (Fig. 1, No. 28), where part of the heat carried by the ammonia-water solution is passed to the water in Conduit No. 37. Also, the water is heated in No. 36 Conduit, and I believe (although I am not sure and don’t have any supporting documents by hand) such heating may be beneficial for the circulating (this sprinkling) of water. Although the environment contaminating gas feron used in the conventional compression-based frig has already been replaced by the environment friendly tetrafluoroethane (CH2FCF3) [5], the potability and miniaturisation are still big issues. For example, in some poor regions around the world where there is not much or even no electricity, portable frig is indeed necessary especially to keep vaccine cool before being used to save lives. In September 8, 2016, it was reported [8] the revamping of Einstein’s frig won researcher William Broadway the 2016 UK James Dyson Award. Also considering the noise-free property of Einstein’s frig, there are indeed reasons that we should believe the old invention still shines nearly a century later since its first coming-out.  References [1] http://www. lafn. org/~dave/gas-frig. txt [2] https://en. wikipedia. org/wiki/Refrigerator [3] https://en. wikipedia. org/wiki/Absorption_refrigerator [4] https://en. wikipedia. org/wiki/Einstein_refrigerator [5] https://www. quora. com/Which-gas-is-used-in-refrigerators-nowadays [6] http://blog. lib. uiowa. edu/eng/how-cool-is-this/ [7] https://grouptms2. wordpress. com/2012/03/16/working-principle-of-a-einsteins-refrigerator/ [8] http://physicsworld. com/cws/article/news/2016/sep/08/flash-physics-dyson-award-for-einstein-s-fridge-australian-centres-of-excellence-mapping-our-galaxy-s-age "
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "<p>Search results for '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>No results found...</li>";
        }
    }
    return false;
}
</script>
<style>
    #lunrsearchresults {padding-top: 0.2rem;}
    .lunrsearchresult {padding-bottom: 1rem;}
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <p><input type="text" class="form-control" id="lunrsearch" name="q" maxlength="255" value="" placeholder="🔍" /></p>
</form>
<div id="lunrsearchresults">
    <ul></ul>
</div>



  
</div>


  <footer>
  <div class="container-md beautiful-jekyll-footer">
    <div class="row column_top">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
        <h3>External Links</h3>
        </div>
    </div>
    <div class="row" style="margin-bottom:10px">
        <div class="col-xl-10 offset-xl-1 col-lg-10 offset-lg-1">
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Monte Carlo</h4>
				<a target="_blank" href="https://tproffen.github.io/DiffuseCode/">DISCUS</a>
				</br>
				<a target="_blank" href="https://www.szfki.hu/~nphys/rmc++/opening.html">RMC++</a>
				</br>
				<a target="_blank" href="https://research.csiro.au/mmm/hrmc/">HRMC</a>
				</br>
				<a target="_blank" href="https://bachiraoun.github.io/fullrmc/">fullrmc</a>
				</br>
        <a target="_blank" href="http://www.dragon.lv/exafs/rmc.htm">RMC for EXAFS</a>
        </br>
        <a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/Empirical-Potential-Structure-Refinement.aspx">EPSR</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/rmc/">RMC at ISIS facility</a>
				</br>
				<a target="_blank" href="https://rmcprofile.pages.ornl.gov/">RMCProfile website</a>
				</br>
				<a target="_blank" href="http://www.rmcprofile.org/Main_Page">RMCProfile website - legacy</a>
				</br>
				<a target="_blank" href="https://en.wikipedia.org/wiki/Reverse_Monte_Carlo">Wikipedia for RMC</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Rietveld-like</h4>
        <a target="_blank" href="https://www.diffpy.org/products/pdfgui.html">PDFgui</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/diffpycmi/index.html">DIFFPy-CMI</a>
        </br>
        <a target="_blank" href="https://www.diffpy.org/products/mPDF.html">magnetic PDF</a>
        </br>
        <a target="_blank" href="https://community.dur.ac.uk/john.evans/topas_workshop/tutorial_pdf_sno2.htm">Topas for PDF</a>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Tools</h4>
        <a target="_blank" href="http://addie.ornl.gov/">ADDIE (ORNL internal)</a>
        </br>
				<a target="_blank"
						href="http://li.mit.edu/Archive/Graphics/A/">Atomeye</a>
				</br>
				<a target="_blank"
						href="https://sourceforge.net/projects/xming/">Xming</a>
				</br>
				<a target="_blank"
						href="https://www.mantidproject.org/Main_Page">Mantid</a>
				</br>
				<a target="_blank" href="https://www.facebook.com/disord.matt">GUDRUN</a>
				</br>
				<a target="_blank"
						href="https://www.diffpy.org/products/pdfgetx.html">PDFGet..
						</a>
				</br>
				<a target="_blank" href="https://www.ncnr.nist.gov/resources/n-lengths/">Neutron scattering length</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/reference/Xray_scatfac.htm">X-ray form factor</a>
				</br>
				<a target="_blank" href="https://www.webelements.com/">Web elements</a>
				</br>
				<a target="_blank" href="https://ptable.com/#Properties">Dynamic
						periodic table</a>
				</br>
				<a target="_blank" href="http://wwwisis2.isis.rl.ac.uk/disordered/Manuals/ATLAS/atlas_values.htm">ISIS values</a>
				</br>
      </div>
      <div class="column" style="background-color:#EAEAEA;">
        <h4>Facilities</h4>
				<a target="_blank" href="https://neutrons.ornl.gov/nomad">US - ORNL - NOMAD</a>
        </br>
				<a target="_blank" href="https://neutrons.ornl.gov/powgen">US - ORNL -
						POWGEN</a>
				</br>
				<a target="_blank" href="https://www.aps.anl.gov/Beamlines/Directory/Details?beamline_id=16">US - APS - 11-ID-B</a>
				</br>
				<a target="_blank" href="https://www.bnl.gov/ps/beamlines/beamline.php?r=28-ID-1">US - BNL - 28-ID-1</a>
				</br>
				<a target="_blank"
						href="https://www.isis.stfc.ac.uk/Pages/Gem.aspx">UK - ISIS - GEM</a>
				</br>
				<a target="_blank" href="https://www.isis.stfc.ac.uk/Pages/polaris.aspx">UK - ISIS - Polaris</a>
				</br>
				<a target="_blank" href="https://www.diamond.ac.uk/Instruments/Crystallography/I15-1.html">UK - Diamond - I15-1</a>
				</br>
				<a target="_blank" href=""https://mlfinfo.jp/en/bl21/>Japan - J-PARC - NOVA</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL14B1/instrument/lang-en/INS-0000000309/instrument_summary_view">Japan - SPRING8 - BL14B1</a>
				</br>
				<a target="_blank" href="http://www.spring8.or.jp/wkg/BL22XU/instrument/lang-en/INS-0000000327/instrument_summary_view">Japan - SPRING8 - BL22XU</a>
				</br>
				<a target="_blank" href="https://europeanspallationsource.se/instruments/heimdal">Europe - ESS - HEIMDAL</a>
				</br>
				<a target="_blank" href="http://e-ssrf.sinap.cas.cn/beamlines/bl13w1/201401/t20140112_152430.html">China - SSRF - BL13W1</a>
      </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 footer_bottom">
      <ul class="list-inline text-center footer-links"><li class="list-inline-item">
    <a target="_blank" href="/feed.xml" title="RSS">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">RSS</span>
    </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="mailto:zhangy3@ornl.gov" title="Email me">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">Email me</span>
   </a>
  </li><li class="list-inline-item">
    <a target="_blank" href="https://github.com/kvieta1990" title="GitHub">
      <span class="fa-stack fa-lg" aria-hidden="true">
        <i class="fas fa-circle fa-stack-2x"></i>
        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
      </span>
      <span class="sr-only">GitHub</span>
   </a>
  </li></ul>

      
      <p class="copyright text-muted">

      
      </p>
      <p class="theme-by text-muted">
        Copyright 2020 ©
        <a>Yuanpeng Zhang</a>
      </p>
      </div>
    </div>
	<div class="row" id="vistor_map" style="position:absolute; left:-10px; bottom:20px;">
	  <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=000000&w=300&t=tt&d=mXrA2cjTFPms32CLvpbXJeN7mGr8Pp6J7WRX3Im-ZOw&co=eaeaea&ct=000000'></script>
	</div>
  </div>
</footer>


  
  
    
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>


  
    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


  
    
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


  



  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script src="/assets/js/beautifuljekyll.js"></script>
    
  









</body>
</html>
